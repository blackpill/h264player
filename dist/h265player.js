/*! h265player built @2020/10/19 ‰∏ãÂçà7:45:29 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.h265player=e():t.h265player=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=177)}([function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(e)}t.exports=r},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},function(t,e,r){var n=r(50);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(t,e,r){var n=r(11),i=r(1);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?i(t):e}},,function(t,e){t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}},function(t,e,r){"use strict";r.d(e,"c",(function(){return n})),r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return a})),r.d(e,"d",(function(){return o}));var n={projectName:"GOLDPLAY",projectAbbreviation:"GP",mode:"production",basePath:"./",get distPath(){var t="";return("development"==this.mode||"test"==this.mode)&&(t="/dist/"),t},get libPath(){return this.distPath+"lib/"},hideBarBoxTime:300,speedList:[{name:"0.5X",value:.5},{name:"1.0X",value:1},{name:"1.5X",value:1.5},{name:"2.0X",value:2},{name:"3.0X",value:3}]},i={maxDuration:30,maxSize:1024e6,maxRetryCount:3},a=1/9e4,o={READYBUFFERLENGTH:1e3,MAXBUFFERLENGTH:5e3}},function(t,e,r){"use strict";var n=r(3),i=r.n(n),a=r(4),o=r.n(a),s=r(0),u=r.n(s),l=r(9),c=console||{};function h(t,e){if(c[t]){if(this.disabled||this.level<0)return;if("production"===l.c.mode&&("error"!==t||"warn"!==t))return;if(1===this.level&&["info"].includes(t))return;if(2===this.level&&["log","info"].includes(t))return;if(this.level>2&&"error"!==t)return;for(var r=(new Date).toLocaleString(),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];var o=["[32m".concat(e,"[39m")].concat(i,[r]);"error"!==t&&"warn"!==t||(o=[e].concat(i,[r])),"function"==typeof c[t]&&c[t].apply(c,o)}}var f=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,t),u()(this,"prefix",l.c.projectName),u()(this,"joiner",">"),u()(this,"left","["),u()(this,"right","]"),u()(this,"disabled",!1),u()(this,"level",0),Object.assign(this,r),"string"==typeof e?this.file=e:e&&e.constructor&&(this.file=e.constructor.name)}return o()(t,[{key:"setDisabled",value:function(t){this.disabled=t}},{key:"setLevel",value:function(t){this.level=t}}],[{key:"get",value:function(e,r){return new t(e,r)}}]),t}();["info","log","debug","warn","error"].forEach((function(t){f.prototype[t]=function(e,r){r=void 0===r?"":this.joiner+r;for(var n=this.left+e+r+this.right,i=this.left+this.prefix+" "+this.file+this.right+n,a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];h.apply(this,[t,i].concat(o))}})),e.a=f},function(t,e){function r(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=r=function(t){return typeof t}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(e)}t.exports=r},,,,,,,function(t,e,r){t.exports=r(78)},,,,,function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(3),i=r.n(n),a=r(4),o=r.n(a),s=r(0),u=r.n(s),l=r(9),c={eval:EvalError,range:RangeError,reference:ReferenceError,syntax:SyntaxError,type:TypeError,uri:URIError,default:Error},h=null,f=(h||(h=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1001;return i()(this,t),u()(this,"type",""),u()(this,"errorName","DefaultError"),u()(this,"code",null),u()(this,"message",""),u()(this,"stack",""),this.type=e,this.code=r,this.throws.bind(this)}return o()(t,[{key:"throws",value:function(t){for(var e="",r=Error,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(t instanceof Error){for(var o in c)if(t instanceof c[o]){this.errorName=c[o].name,r=t.constructor;break}this.stack=t.stack,i&&i.splice&&(e=i[0],i.splice(0,1))}else e=t.toString();this.message="[".concat(l.c.projectName," ERROR:")+this.type+"-"+this.code+"]"+e;try{throw new r(this.message,"[args]:",i)}catch(t){this.stack=this.stack||t.stack,console.error(t,"[message]:",e,"[args]:",i)}}}]),t}())),h)},function(t,e){t.exports=function(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}},,,function(t,e,r){var n=r(50),i=r(92);function a(e,r,o){return i()?t.exports=a=Reflect.construct:t.exports=a=function(t,e,r){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return r&&n(a,r.prototype),a},a.apply(null,arguments)}t.exports=a},function(t,e){function r(t,e,r,n,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,i)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,u,"next",t)}function u(t){r(o,i,a,s,u,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}},,,,,function(t,e,r){var n=r(2),i=r(50),a=r(93),o=r(27);function s(e){var r="function"==typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return o(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},s(e)}t.exports=s},,,,,,,,,,function(t,e,r){function n(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var n=r(r.s=ENTRY_MODULE);return n.default||n}function i(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(t,e,n){var a={};a[n]=[];var o=e.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var u,l=s[1],c=new RegExp("(\\\\n|\\W)"+i(l)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=c.exec(o);)"dll-reference"!==u[3]&&a[n].push(u[3]);for(c=new RegExp("\\("+i(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=c.exec(o);)t[u[2]]||(a[n].push(u[1]),t[u[2]]=r(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);for(var h,f=Object.keys(a),d=0;d<f.length;d++)for(var p=0;p<a[f[d]].length;p++)h=a[f[d]][p],isNaN(1*h)||(a[f[d]][p]=1*a[f[d]][p]);return a}function o(t){return Object.keys(t).reduce((function(e,r){return e||t[r].length>0}),!1)}t.exports=function(t,e){e=e||{};var i={main:r.m},s=e.all?{main:Object.keys(i.main)}:function(t,e){for(var r={main:[e]},n={main:[]},i={main:{}};o(r);)for(var s=Object.keys(r),u=0;u<s.length;u++){var l=s[u],c=r[l].pop();if(i[l]=i[l]||{},!i[l][c]&&t[l][c]){i[l][c]=!0,n[l]=n[l]||[],n[l].push(c);for(var h=a(t,t[l][c],l),f=Object.keys(h),d=0;d<f.length;d++)r[f[d]]=r[f[d]]||[],r[f[d]]=r[f[d]].concat(h[f[d]])}}return n}(i,t),u="";Object.keys(s).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;s[t][e];)e++;s[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s[t].map((function(e){return JSON.stringify(e)+": "+i[t][e].toString()})).join(",")+"});\n"})),u=u+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s.main.map((function(t){return JSON.stringify(t)+": "+i.main[t].toString()})).join(",")+"}))(self);";var l=new window.Blob([u],{type:"text/javascript"});if(e.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),h=new window.Worker(c);return h.objectURL=c,h}},function(t,e,r){var n,i,a;i=[],void 0===(a="function"==typeof(n=function(){var t=function(){},e={},r={},n={};function i(t,e){if(t){var i=n[t];if(r[t]=e,i)for(;i.length;)i[0](t,e),i.splice(0,1)}}function a(e,r){e.call&&(e={success:e}),r.length?(e.error||t)(r):(e.success||t)(e)}function o(e,r,n,i){var a,s,u=document,l=n.async,c=(n.numRetries||0)+1,h=n.before||t,f=e.replace(/[\?|#].*$/,""),d=e.replace(/^(css|img)!/,"");i=i||0,/(^css!|\.css$)/.test(f)?((s=u.createElement("link")).rel="stylesheet",s.href=d,(a="hideFocus"in s)&&s.relList&&(a=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(f)?(s=u.createElement("img")).src=d:((s=u.createElement("script")).src=e,s.async=void 0===l||l),s.onload=s.onerror=s.onbeforeload=function(t){var u=t.type[0];if(a)try{s.sheet.cssText.length||(u="e")}catch(t){18!=t.code&&(u="e")}if("e"==u){if((i+=1)<c)return o(e,r,n,i)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";r(e,u,t.defaultPrevented)},!1!==h(e,s)&&u.head.appendChild(s)}function s(t,r,n){var s,u;if(r&&r.trim&&(s=r),u=(s?n:r)||{},s){if(s in e)throw"LoadJS";e[s]=!0}function l(e,r){!function(t,e,r){var n,i,a=(t=t.push?t:[t]).length,s=a,u=[];for(n=function(t,r,n){if("e"==r&&u.push(t),"b"==r){if(!n)return;u.push(t)}--a||e(u)},i=0;i<s;i++)o(t[i],n,r)}(t,(function(t){a(u,t),e&&a({success:e,error:r},t),i(s,t)}),u)}if(u.returnPromise)return new Promise(l);l()}return s.ready=function(t,e){return function(t,e){t=t.push?t:[t];var i,a,o,s=[],u=t.length,l=u;for(i=function(t,r){r.length&&s.push(t),--l||e(s)};u--;)a=t[u],(o=r[a])?i(a,o):(n[a]=n[a]||[]).push(i)}(t,(function(t){a(e,t)})),s},s.done=function(t){i(t,[])},s.reset=function(){e={},r={},n={}},s.isDefined=function(t){return t in e},s})?n.apply(e,i):n)||(t.exports=a)},function(t,e){t.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}},function(t,e,r){"use strict";
/*! @name @videojs/vhs-utils @version 1.3.0 @license MIT */var n=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(e);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(r,1),r>-1},e.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var r=e.length,n=0;n<r;++n)e[n].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=e.length,o=0;o<a;++o)e[o].apply(this,i)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",(function(e){t.push(e)}))},t}();t.exports=n},,,function(t,e){function r(e,n){return t.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(e,n)}t.exports=r},function(t,e){!function(){"use strict";function e(t,e){throw new Error("abstract")}e.prototype.drawFrame=function(t){throw new Error("abstract")},e.prototype.clear=function(){throw new Error("abstract")},t.exports=e}()},,,,,,,,,,,function(t,e){var r={validateDimension:function(t){if(t<=0||t!==(0|t))throw"YUV plane dimensions must be a positive integer"},validateOffset:function(t){if(t<0||t!==(0|t))throw"YUV plane offsets must be a non-negative integer"},format:function(t){var e=t.width,r=t.height,n=t.chromaWidth||e,i=t.chromaHeight||r,a=t.cropLeft||0,o=t.cropTop||0,s=t.cropWidth||e-a,u=t.cropHeight||r-o,l=t.displayWidth||s,c=t.displayHeight||u;return this.validateDimension(e),this.validateDimension(r),this.validateDimension(n),this.validateDimension(i),this.validateOffset(a),this.validateOffset(o),this.validateDimension(s),this.validateDimension(u),this.validateDimension(l),this.validateDimension(c),{width:e,height:r,chromaWidth:n,chromaHeight:i,cropLeft:a,cropTop:o,cropWidth:s,cropHeight:u,displayWidth:l,displayHeight:c}},allocPlane:function(t,e){return r.validateDimension(t),r.validateDimension(e),{bytes:new Uint8Array(t*e),stride:t}},suitableStride:function(t){r.validateDimension(t);var e=t%4;return 0==e?t:t+(4-e)},allocPlane:function(t,e,r,n,i){var a,o;if(this.validateDimension(t),this.validateDimension(e),i=i||0,n=n||this.suitableStride(t),this.validateDimension(n),n<t)throw"Invalid input stride for YUV plane; must be larger than width";if(a=n*e,r){if(r.length-i<a)throw"Invalid input buffer for YUV plane; must be large enough for stride times height";o=r.slice(i,i+a)}else o=new Uint8Array(a),n=n||this.suitableStride(t);return{bytes:o,stride:n}},lumaPlane:function(t,e,r,n){return this.allocPlane(t.width,t.height,e,r,n)},chromaPlane:function(t,e,r,n){return this.allocPlane(t.chromaWidth,t.chromaHeight,e,r,n)},frame:function(t,e,r,n){return{format:t,y:e=e||this.lumaPlane(t),u:r=r||this.chromaPlane(t),v:n=n||this.chromaPlane(t)}},copyPlane:function(t){return{bytes:t.bytes.slice(),stride:t.stride}},copyFrame:function(t){return{format:t.format,y:this.copyPlane(t.y),u:this.copyPlane(t.u),v:this.copyPlane(t.v)}},transferables:function(t){return[t.y.bytes.buffer,t.u.bytes.buffer,t.v.bytes.buffer]}};t.exports=r},function(t,e,r){var n=r(105),i=r(106),a=r(107),o=r(109);t.exports=function(t,e){return n(t)||i(t,e)||a(t,e)||o()}},,,,,,,function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},,,,,function(t,e){function r(){return t.exports=r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},r.apply(this,arguments)}t.exports=r},function(t,e,r){"use strict";(function(e){var n,i=(n=r(98))&&"object"==typeof n&&"default"in n?n.default:n;t.exports=function(t){for(var r,n=(r=t,i.atob?i.atob(r):e.from(r,"base64").toString("binary")),a=new Uint8Array(n.length),o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return a}}).call(this,r(94).Buffer)},function(t,e,r){!function(){"use strict";var e=r(51),n=r(99),i=r(102),a={FrameSink:e,SoftwareFrameSink:n,WebGLFrameSink:i,attach:function(t,e){return("webGL"in(e=e||{})?e.webGL:i.isAvailable())?new i(t,e):new n(t,e)}};t.exports=a}()},function(t,e,r){var n=function(t){"use strict";var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),o=new x(n||[]);return a._invoke=function(t,e,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return E()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=k(o,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,o),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c={};function h(){}function f(){}function d(){}var p={};p[i]=function(){return this};var y=Object.getPrototypeOf,g=y&&y(y(P([])));g&&g!==e&&r.call(g,i)&&(p=g);var v=d.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var n;this._invoke=function(i,a){function o(){return new e((function(n,o){!function n(i,a,o,s){var u=l(t[i],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(u.arg)}(i,a,n,o)}))}return n=n?n.then(o,o):o()}}function k(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,c;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=v.constructor=d,d.constructor=f,f.displayName=s(d,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,o,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},m(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(e,r,n,i,a){void 0===a&&(a=Promise);var o=new b(u(e,r,n,i),a);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},m(v),s(v,o,"Generator"),v[i]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;w(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},,,,,,,,,,,,,function(t,e,r){"use strict";r.r(e);var n=r(3),i=r.n(n),a=r(4),o=r.n(a),s=r(1),u=r.n(s),l=r(5),c=r.n(l),h=r(6),f=r.n(h),d=r(2),p=r.n(d),y=r(0),g=r.n(y),v=r(24),m=r.n(v),b=r(29),k=r.n(b),_=r(10);function w(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var P=_.a.get("Events.js"),E=function(){function t(e){i()(this,t),g()(this,"eventsQueue",{}),g()(this,"target",{}),g()(this,"disallowRepeat",!1),this.target=e}return o()(t,[{key:"add",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=w(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.on(a,r,n)}}catch(t){i.e(t)}finally{i.f()}}},{key:"on",value:function(t,e,r){if(void 0===this.eventsQueue[t]&&(this.eventsQueue[t]={methods:[],once:!1}),"function"==typeof e){if(!this.disallowRepeat||!this.eventsQueue[t].methods.includes(e))return this.eventsQueue[t].methods.push(e),void 0!==r&&(this.eventsQueue[t].once=r),this.target}else P.error("on","the argument is not function.",e)}},{key:"once",value:function(t,e){this.on(t,e,!0)}},{key:"off",value:function(t,e){var r=this.eventsQueue[t];if(r){var n=r.methods;if(e)for(var i=n.length;i--;)n[i]===e&&n.splice(i,1);else delete this.eventsQueue[t];return this.target}}},{key:"emit",value:function(t){for(var e=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=this.eventsQueue[t];if(a){var o=a.methods;return o.forEach((function(t){t.apply(e.target,n)})),a.once&&this.off(t),this.target}}},{key:"clear",value:function(t){delete this.eventsQueue[t]}},{key:"clearAll",value:function(){this.eventsQueue={}}}]),t}(),T=function(t){var e=new E(t);return function(t){return e.target=t,e}},B=r(11),S=r.n(B),R=_.a.get("Element.js"),L=function(){function t(){i()(this,t)}return o()(t,null,[{key:"createEl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1?arguments[1]:void 0;if("string"!=typeof t)return R.error("please input element name"),null;var r=document.createElement(t,e);return r}},{key:"registerElement",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HTMLElement,r=arguments.length>2?arguments[2]:void 0,n=document.registerElement(t,{prototype:Object.create(e.prototype),extends:r});return n}},{key:"addEl",value:function(t,e){if(t&&e)try{e.appendChild(t)}catch(t){R.error(t)}}},{key:"removeEl",value:function(t){try{var e=t.parentNode;e&&e.removeChild(t)}catch(t){R.error(t)}}},{key:"addClass",value:function(t){try{for(var e,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(e=t.classList).add.apply(e,n)}catch(t){R.error(t)}}},{key:"removeClass",value:function(){}},{key:"hasClass",value:function(){}},{key:"isElement",value:function(t){try{return t instanceof HTMLElement}catch(e){return"object"===S()(t)&&1===t.nodeType&&"object"===S()(t.style)&&"object"===S()(t.ownerDocument)}}},{key:"setAttributes",value:function(e,r){if(t.isElement(e))for(var n=0,i=r.length;n<i;n++){var a=r[n],o=a.name;o=a.name.replace(/["|']/g,""),e.setAttribute(o,a.value)}}},{key:"syncAttributes",value:function(e,r){var n=r.attributes;t.setAttributes(e,n);var i=e.attributes;t.setAttributes(r,i)}},{key:"getClientWidth",value:function(){return document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth}},{key:"getClientHeight",value:function(){return document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight}},{key:"adaptSizeElement",value:function(t,e,r,n){var i=r,a=n;a.width=t||a.width||i.offsetWidth,a.height=e||a.height||i.offsetHeight;var o=a.width,s=a.height,u=0;a.style.position="absolute",i.offsetWidth<=0&&(i.style.width=o+"px"),i.offsetHeight<=0&&(i.style.height=s+"px");var l=i.offsetWidth/o,c=i.offsetHeight/s;u=c>l?l:c,a.style.top=i.offsetTop+(i.offsetHeight-s*u)/2+"px",a.style.left=i.offsetLeft+(i.offsetWidth-o*u)/2+"px",a.style.transform="scale(".concat(u,", ").concat(u,")"),a.style["transform-origin"]="top left",a.style.display="inline-block"}}]),t}(),D=r(27),C=r.n(D),A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),g()(this,"logger",null),g()(this,"__instance__",null),g()(this,"__singleton__",null),this.options=e,this.setLogger(this.constructor.name+".js")}return o()(t,[{key:"setLogger",value:function(t){this.logger=new _.a(t)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):T(this)}}],[{key:"getInstance",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.__instance__=C()(this,e),this.__instance__}},{key:"getSingleton",value:function(){if(!this.__singleton__){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.__singleton__=C()(this,e)}return this.__singleton__}}]),t}();function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var O=function(t){c()(r,t);var e=I(r);function r(t){var n;return i()(this,r),n=e.call(this),g()(u()(n),"component",null),n.component=t.component,n}return o()(r,[{key:"confirm",value:function(){}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.component.data.content=t,"default"!==this.component.data.display&&""!==this.component.data.display||this.component.showBox(),"show"!==this.component.data.display&&this.component.show()}},{key:"hide",value:function(){this.component.hide()}}]),r}(A),U=r(23),M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),g()(this,"logger",null),this.options=e,this.debug=e.debug||!1,this.setLogger(this.constructor.name+".js")}return o()(t,[{key:"setLogger",value:function(t){this.logger=new _.a(t)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):T(this)}},{key:"alert",get:function(){var t="";return this.options&&this.options.alertError&&(t=this.options.alertError),t}}]),t}(),N=r(9);function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var F=function(t){c()(r,t);var e=H(r);function r(){var t;return i()(this,r),t=e.call(this),g()(u()(t),"loadData",null),g()(u()(t),"sourceURL",""),t}return o()(r,[{key:"init",value:function(){}},{key:"setLoadData",value:function(t){this.loadData=t}},{key:"setSourceURL",value:function(t){this.sourceURL=t}},{key:"getLoadData",value:function(){return this.getLoadData}},{key:"getSourceURL",value:function(){return this.getSourceURL}}]),r}(M),j={LOAD_PLAYLIST:10,get 10(){return"loading playlist"},LOADED_PLAYLIST:11,get 11(){return"playlist is loaded"},IDLE:0,get 0(){return"is free"},LOADING:1,get 1(){return"loading segment"},DONE:2,get 2(){return"segment is loaded"},ERROR:3,get 3(){return"load get error"}},$=_.a.get("M3U8Parser.js",{level:2}),W={lineDelimiter:/\r?\n/,extensionHeader:"#EXTM3U",tagPrefix:"#EXT",segmentPrefix:"#EXTINF",segmentParse:/^#EXTINF: *([0-9.]+)(, *(.+?)?)?$/,tagParse:/^#EXT-X-([A-Z-]+)(:(.+))?$/,version:"VERSION",allowCache:"ALLOW-CACHE",combined:"COMBINED",endList:"ENDLIST",targetDuration:"TARGETDURATION",mediaSequence:"MEDIA-SEQUENCE",discontinuity:"DISCONTINUITY",streamInf:"STREAM-INF",isComment:function(t){return t&&"#"===t[0]&&!t.startsWith(W.tagPrefix)},isBlank:function(t){return""===t},canStrip:function(t){return W.isBlank(t)||W.isComment(t)}},V=0,z=1,Y={file:void 0,name:void 0,start:0,end:0,discontinuity:void 0,duration:void 0},X=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,t),g()(this,"source",""),g()(this,"segments",[]),g()(this,"_currentSegment",null),g()(this,"discontinuous",null),g()(this,"tags",{VERSION:void 0,TARGETDURATION:void 0}),g()(this,"_state",null),this.source=e,this.options=r,this.parse(this.source)}return o()(t,[{key:"readSegment",value:function(t){var e=W.segmentParse.exec(t);if(null!==e){var r=parseFloat(e[1],10),n=e[3];r%1!=0&&this.tags.VERSION>=3&&$.info("readsegment","Version must be 3 or higher to support floating.","duration:",r),r<this.tags.TARGETDURATION&&$.info("readsegment","Segment duration must be less than the TARGETDURATION","duration:",r),r*=1e3,this._currentSegment=Object.assign({},Y,{duration:r,name:n,discontinuity:this.discontinuous});var i=this.segments[this.segments.length-1]||{start:0,end:0};this._currentSegment.start=i.end,this._currentSegment.end=i.end+r,this.discontinuous=!1,this._state=z}else $.warn("readsegment","read segment failed","line:",t)}},{key:"readTag",value:function(t){var e=W.tagParse.exec(t);if(null!==e)return{name:e[1],value:e[3]}}},{key:"readLine",value:function(t){if(t.startsWith(W.segmentPrefix))return this.readSegment(t);var e=this.readTag(t);if(e)switch(e.name){case W.version:this.tags.VERSION=parseFloat(e.value,10);break;case W.mediaSequence:this.tags.MEDIA_SEQUENCE=parseFloat(e.value,10);break;case W.allowCache:this.tags.ALLOW_CACHE=!!/\s*(YES|yes)\s*/.test(e.value);break;case W.discontinuity:this.tags.DISCONTINUITY=!0,this.discontinuous=!0;break;case W.targetDuration:this.tags.TARGETDURATION=parseFloat(e.value,10);break;case W.combined:this.tags.COMBINED=e.value;break;case W.streamInf:this.tags.STREAM_INF=e.value;break;case W.endList:this.tags.ENDLIST="EOF";break;default:$.warn("readLine","unknow line","line:",t)}}},{key:"addFile",value:function(t){if("#"!==t[0]){this._currentSegment.file=t;var e=this.parseSDParam(t);if(e>=0){this._currentSegment.start=e,this._currentSegment.end=e+this._currentSegment.duration;var r=this.segments[this.segments.length-1]||{sd:0,start:0,end:0};r.duration=e-r.start,r.end=e}this._currentSegment.name||(this._currentSegment.name=t.substr(Math.max(0,t.lastIndexOf("/")),t.lastIndexOf("."))),this.segments.push(this._currentSegment),this._state=V}else{var n=this.readTag(t);switch(n.name){case"PROGRAM-DATE-TIME":var i=new Date(n.value);this._currentSegment.time=i;break;default:$.warn("addFile","Invalid tag.","tag.name:",n.name)}}}},{key:"parseSDParam",value:function(t){var e=-1;try{var r=new URL(t).searchParams.get("sd");r&&(e=parseInt(r,10))}catch(t){}return e}},{key:"parse",value:function(t){var e=this;if("string"==typeof(t=t||this.source)){this._state=V,this.discontinuous=!1;var r=t.split(W.lineDelimiter);if(r[0]==W.extensionHeader)return r.forEach((function(t){if(!W.canStrip(t))switch(e._state){case V:e.readLine(t);break;case z:e.addFile(t);break;default:Object(U.a)("parsing m3u8 get an error, it is unknow state.")}})),this;$.error("parse","it is not a valid  m3u8 header","header:",r[0])}else Object(U.a)("m3u8 file is not text.",t)}},{key:"version",get:function(){return this.tags.VERSION}},{key:"duration",get:function(){return this.segments.length?this.segments.reduce((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,r="number"==typeof t?t:t.duration;return r+e.duration})):0}},{key:"targetDuration",get:function(){return this.tags.TARGETDURATION}},{key:"mediaSequence",get:function(){return this.tags.MEDIA_SEQUENCE}},{key:"allowCache",get:function(){return this.tags.ALLOW_CACHE}},{key:"length",get:function(){return this.segments.length}}]),t}(),G=r(45),q=r.n(G);function Q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Object";return function(e){var r="[object "+t+"]";return Object.prototype.toString.call(e)==r}}var K=function(){function t(){i()(this,t)}return o()(t,null,[{key:"importScripts",value:function(t,e,r){var n="ready"+Date.now();t instanceof Array?q()(t,n):q()([t],n),q.a.ready(n,{success:e,error:r})}},{key:"blobData",value:function(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}},{key:"escapeHTML",value:function(e){if(t.isString(e))return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"getInnerWidthHeight",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"Fullscreen",value:function(){var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&(t.webkitRequestFullScreen(),setTimeout((function(){console.error("fullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))}),0))}},{key:"exitFullscreen",value:function(){var t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&(t.webkitExitFullscreen(),setTimeout((function(){console.error("exitfullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))}),0))}},{key:"buildFilePath",value:function(t,e){return t.map((function(t){return e+t}))}},{key:"insertSort",value:function(t,e,r){var n,i,a=t.length;if(0!==a)if(r){var o=r(e);n=o.key,i=o.value;for(var s=0;s<a;s++)if(i<t[s][n]){for(var u=a;u>s;)t[u]=t[u-1],u--;return void(t[s]=e)}t.push(e)}else{i=e;for(var l=0;l<a;l++)if(i<t[l]){for(var c=a;c>l;)t[c]=t[c-1],c--;return void(t[l]=i)}t.push(i)}else t.push(e)}},{key:"isSafari",value:function(){var t=navigator.userAgent;return/Safari/.test(t)&&!/Chrome/.test(t)}},{key:"msec2sec",value:function(t){var e=(t/1e3).toFixed(3);return parseFloat(e,10)}}]),t}();g()(K,"isObject",(function(){return Q("Object")})),g()(K,"isString",(function(){return Q("String")})),g()(K,"isFunction",(function(){return Q("Function")}));var J=r(34),Z=r.n(J);function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var et=function(t){c()(r,t);var e=tt(r);function r(){return i()(this,r),e.call(this)}return o()(r,[{key:"add",value:function(t){this.push(Object.freeze(t))}},{key:"addAll",value:function(t){var e=this;t.forEach((function(t){e.add(t)}))}},{key:"get",value:function(t){return this[t]}},{key:"getLast",value:function(){return this[this.length-1]}},{key:"getBy",value:function(t){var e=this;if("function"==typeof t){var r=new this.constructor;return this.every((function(n,i){return!0===t.call(e,n,i,e)&&r.add(n),!0})),r}}},{key:"indexOfByTime",value:function(t,e){e||(e=function(e){return t>=e.start&&t<e.end});for(var r=this.length-1,n=0;n<=r;){var i=Math.floor((r+n)/2),a=this[i];if(e(a))return i;a.start>t?r=i-1:n=i+1}return-1}},{key:"getByTime",value:function(t){var e=this.indexOfByTime(t);if(e>=0)return this[e]}},{key:"getByKey",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])&&(e=e[0]),this.getBy((function(t){var r=!1;return e.every((function(e){return!Object.prototype.hasOwnProperty.call(t,e)||(r=!0,!1)})),r}))}},{key:"getByValue",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])&&(e=e[0]),this.getBy((function(t){var r=!1;return t.each((function(t,n){if(e.includes(n))return r=!0,!1})),r}))}},{key:"getByKeyValue",value:function(t,e){return this.getBy((function(r){return r[t]===e}))}},{key:"getValues",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])&&(e=e[0]),this.map((function(t){return e.length?t.get(t,e):t.getValues(t)}))}},{key:"indexOfBy",value:function(t){var e=0,r=this.length;for(t=t||function(){return!1};e<r;){if(!0===t.call(this,this[e],e,this))return e;e++}return-1}},{key:"indexOfByKey",value:function(t,e){return this.indexOfBy((function(r){return r[t]===e}))}},{key:"indexOfByKeyValue",value:function(t,e){return this.indexOfByKey(t,e)}},{key:"each",value:function(t){if("function"==typeof t)return this.forEach(t),this}},{key:"remove",value:function(t,e){return this.length<=0||(t=t<0?0:t,e=e||t+1,this.splice(t,e-t)),this}},{key:"removeItem",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])&&(e=e[0]),this.removeBy((function(t){return e.includes(t)}))}},{key:"removeBy",value:function(t){for(var e=0,r=this.length;e<r;e++)!0===t.call(this,this[e],e,this)&&(this.splice(e,1),r--,e--);return this}},{key:"removeByKeyValue",value:function(t,e){return this.removeBy((function(r){return r[t]===e}))}},{key:"toJSON",value:function(){var t=Array.from(this);return t.forEach((function(e,r){t[r]=e&&"function"==typeof e.toJSON?e.toJSON():e})),t}},{key:"toArray",value:function(){return Array.from(this)}},{key:"size",get:function(){return this.length}}]),r}(Z()(Array)),rt=function(){function t(){i()(this,t)}return o()(t,[{key:"pair",value:function(){return Object.entries(this)}},{key:"keys",value:function(){return Object.keys(this)}},{key:"set",value:function(t,e){return this[t]=e,this}},{key:"get",value:function(t){return this[t]}},{key:"add",value:function(t,e){return Object.prototype.hasOwnProperty.call(this,t)||this.set(t,e),this}},{key:"addAll",value:function(t){for(var e in t)this.add(e,t[e]);return this}},{key:"toJSON",value:function(){var t={};for(var e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t[e]=this[e]);return t}}]),t}();function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var it=function(t){c()(r,t);var e=nt(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"no",0),g()(u()(n),"name",null),g()(u()(n),"duration",0),g()(u()(n),"file",null),g()(u()(n),"start",0),g()(u()(n),"end",0),Object.assign(u()(n),t),n}return r}(rt);function at(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var ot=function(t){c()(r,t);var e=at(r);function r(t){return i()(this,r),e.call(this,t)}return o()(r,[{key:"add",value:function(t){t instanceof it||(t=new it(t)),t.no=this.length+1,K.isObject(t)&&this.push(t)}}]),r}(et),st={ProcessorResetEnd:"DataProcessorController.processorResetEnd",DataProcessorReady:"DataProcessorController.dataProcessorReady",DecodeStartDecode:"DecodeController.startDecode",DecodeFlush:"DecodeController.flush",DecodeDecoded:"DecodeController.decoded",DecodeApppendEnd:"DecodeController.appendEnd",DecodeFlushEnd:"DecodeController.flushEnd",DecodeReady:"DecodeController.ready",DemuxResetEnd:"DemuxController.resetEnd",DemuxStartDemux:"DemuxController.startDemux",DemuxLast:"DemuxController.last",DemuxVideo:"DemuxController.video",DemuxAAC:"DemuxController.AAC",DemuxReady:"DemuxController.ready",ImagePlayerRenderEnd:"ImagePlayer.renderEnd",ImagePlayerWait:"ImagePlayer.wait",ImagePlayerReady:"ImagePlayer.ready",ImagePlayerEnd:"ImagePlayer.end",ImagePlayerBuffeUpdate:"ImagePlayer.bufferUpdate",ControlBarPlay:"ControlBar.onPlay",ControlBarPause:"ControlBar.onPause",ControlBarPauseLoading:"ControlBar.onPauseLoading",LoadDataReadBufferByNo:"LoadData.readBufferByNo",LoadDataReadBuffer:"LoadData.readBuffer",LoadDataRead:"LoadData.onRead",LoadDataSeek:"LoadData.onSeek",LoadDataFirstLoaded:"LoadData.onFirstLoaded",LoaderPlayListStart:"Loader.playlistStart",LoaderLoading:"Loader.onLoading",LoaderError:"Loader.onError",LoaderLoaded:"Loader.onLoaded",LoaderUpdateSpeed:"Loader.updateSpeed",LoaderLoadFile:"Loader.loadFile",LoaderPlayListLoaded:"Loader.playlistLoaded",AudioPlayerReady:"AudioPlayer.MSEReady",AudioPlayerDataReady:"AudioPlayer.dataReady",AudioPlayerWait:"AudioPlayer.wait",AudioPlayerEnd:"AudioPlayer.end",AudioPlayerPlaySuccess:"AudioPlayer.playSuccess",AudioPlayerPlayFail:"AudioPlayer.playFail",PlayerMaxPTS:"DemuxController.maxpts",PlayerSeekEnd:"Player.seekend",PlayerSpeedTo:"Player.speedTo",PlayerChangeRate:"Player.changeRate",PlayerChangeSrc:"Player.changeSrc",PlayerPlaying:"Player.playing",PlayerTimeUpdate:"Player.timeUpdate",PlayerbufferUpdate:"Player.bufferupdate",PlayerResetReady:"Player.resetReady",PlayerWait:"Player.wait",PlayerLoadNext:"Player.loadNext",PlayerOnPlay:"Player.onPlay",PlayerOnPause:"Player.onPause",PlayerOnSeek:"Player.onSeek",PlayerOnVolume:"Player.onVolume",PlayerReady:"Player.ready",PlayerPlay:"Player.play",PlayerReset:"Player.reset",PlayerLoadedMetaData:"Player.loadedMetaData",PlayerEnd:"Player.end",PlayerPause:"Player.pause",PlayerSeeking:"Player.seeking",PlayerAlert:"Player.alert",PlayerThrowError:"Player.throwError",StreamDataReady:"StreamController.dataReady"},ut=r(46),lt=r.n(ut),ct=r(47),ht=r.n(ct),ft=r(75),dt=r.n(ft),pt=r(76),yt=r.n(pt),gt=function(t){function e(){var e;return(e=t.call(this)||this).buffer="",e}return lt()(e,t),e.prototype.push=function(t){var e;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},e}(ht.a),vt=function(t){for(var e,r=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},i=r.length;i--;)""!==r[i]&&((e=/([^=]*)=(.*)/.exec(r[i]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),n[e[0]]=e[1]);return n},mt=function(t){function e(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}lt()(e,t);var r=e.prototype;return r.push=function(t){var e,r,n=this;0!==(t=t.trim()).length&&("#"===t[0]?this.tagMappers.reduce((function(e,r){var n=r(t);return n===t?e:e.concat([n])}),[t]).forEach((function(t){for(var i=0;i<n.customParsers.length;i++)if(n.customParsers[i].call(n,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))n.trigger("data",{type:"tag",tagType:"m3u"});else{if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return r={type:"tag",tagType:"inf"},e[1]&&(r.duration=parseFloat(e[1])),e[2]&&(r.title=e[2]),void n.trigger("data",r);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"targetduration"},e[1]&&(r.duration=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"totalduration"},e[1]&&(r.duration=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"version"},e[1]&&(r.version=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"media-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return r={type:"tag",tagType:"playlist-type"},e[1]&&(r.playlistType=e[1]),void n.trigger("data",r);if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"byterange"},e[1]&&(r.length=parseInt(e[1],10)),e[2]&&(r.offset=parseInt(e[2],10)),void n.trigger("data",r);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return r={type:"tag",tagType:"allow-cache"},e[1]&&(r.allowed=!/NO/.test(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-MAP:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"map"},e[1]){var a=vt(e[1]);if(a.URI&&(r.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],u=o[1];r.byterange={},s&&(r.byterange.length=parseInt(s,10)),u&&(r.byterange.offset=parseInt(u,10))}}n.trigger("data",r)}else if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"stream-inf"},e[1]){if(r.attributes=vt(e[1]),r.attributes.RESOLUTION){var l=r.attributes.RESOLUTION.split("x"),c={};l[0]&&(c.width=parseInt(l[0],10)),l[1]&&(c.height=parseInt(l[1],10)),r.attributes.RESOLUTION=c}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}n.trigger("data",r)}else{if(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t))return r={type:"tag",tagType:"media"},e[1]&&(r.attributes=vt(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-ENDLIST/.exec(t))n.trigger("data",{type:"tag",tagType:"endlist"});else if(e=/^#EXT-X-DISCONTINUITY/.exec(t))n.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t))return r={type:"tag",tagType:"program-date-time"},e[1]&&(r.dateTimeString=e[1],r.dateTimeObject=new Date(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-KEY:?(.*)$/.exec(t))return r={type:"tag",tagType:"key"},e[1]&&(r.attributes=vt(e[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void n.trigger("data",r);if(e=/^#EXT-X-START:?(.*)$/.exec(t))return r={type:"tag",tagType:"start"},e[1]&&(r.attributes=vt(e[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out-cont"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-in"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);n.trigger("data",{type:"tag",data:t.slice(4)})}}}else n.trigger("data",{type:"comment",text:t.slice(1)})})):this.trigger("data",{type:"uri",uri:t}))},r.addParser=function(t){var e=this,r=t.expression,n=t.customType,i=t.dataParser,a=t.segment;"function"!=typeof i&&(i=function(t){return t}),this.customParsers.push((function(t){if(r.exec(t))return e.trigger("data",{type:"custom",data:i(t),customType:n,segment:a}),!0}))},r.addTagMapper=function(t){var e=t.expression,r=t.map;this.tagMappers.push((function(t){return e.test(t)?r(t):t}))},e}(ht.a),bt=function(t){function e(){var e;(e=t.call(this)||this).lineStream=new gt,e.parseStream=new mt,e.lineStream.pipe(e.parseStream);var r,n,i=u()(e),a=[],o={},s=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var h=0;return e.parseStream.on("data",(function(t){var e,u;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&(o.byterange=e,e.length=t.length,"offset"in t||(t.offset=h)),"offset"in t&&(o.byterange=e,e.offset=t.offset),h=e.offset+e.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.duration>0&&(o.duration=t.duration),0===t.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:yt()(t.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(n.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else n=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,c=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){r={},t.uri&&(r.uri=t.uri),t.byterange&&(r.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes?(o.attributes||(o.attributes={}),dt()(o.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var r=this.manifest.mediaGroups[t.attributes.TYPE];r[t.attributes["GROUP-ID"]]=r[t.attributes["GROUP-ID"]]||{},e=r[t.attributes["GROUP-ID"]],(u={default:/yes/i.test(t.attributes.DEFAULT)}).default?u.autoselect=!0:u.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(u.language=t.attributes.LANGUAGE),t.attributes.URI&&(u.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(u.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(u.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(u.forced=/yes/i.test(t.attributes.FORCED)),e[t.attributes.NAME]=u}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),o.dateTimeString=t.dateTimeString,o.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=t.data},"cue-out-cont":function(){o.cueOutCont=t.data},"cue-in":function(){o.cueIn=t.data}}[t.tagType]||s).call(i)},uri:function(){o.uri=t.uri,a.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),n&&(o.key=n),o.timeline=c,r&&(o.map=r),o={}},comment:function(){},custom:function(){t.segment?(o.custom=o.custom||{},o.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(i)})),e}lt()(e,t);var r=e.prototype;return r.push=function(t){this.lineStream.push(t)},r.end=function(){this.lineStream.push("\n")},r.addParser=function(t){this.parseStream.addParser(t)},r.addTagMapper=function(t){this.parseStream.addTagMapper(t)},e}(ht.a);function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var _t={};function wt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function xt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(r),!0).forEach((function(e){g()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Et={HLS:function(t){c()(r,t);var e=kt(r);function r(t){var n;return i()(this,r),n=e.call(this),g()(u()(n),"state",j.IDLE),g()(u()(n),"maxBufferDuration",N.b.maxDuration),g()(u()(n),"maxBufferSize",N.b.maxSize),g()(u()(n),"baseUrl",""),g()(u()(n),"options",null),g()(u()(n),"httpWorker",null),g()(u()(n),"sourceData",null),g()(u()(n),"segmentPool",[]),g()(u()(n),"currentNo",null),g()(u()(n),"maxRetryCount",N.b.maxRetryCount),n.options=t,n.loaderController=n.options.loaderController,n.dataController=n.loaderController.dataController,n.httpWorker=t.httpWorker,n.setSegmentPool(new ot),n}return o()(r,[{key:"loadPlaylist",value:function(t){var e=this;this.options.player.options.beforeLoad?this.options.player.options.beforeLoad(this.sourceURL,this.options.sourceURL).then((function(t){e.options.sourceURL=t,e.httpWorker.postMessage({type:"invoke",fileType:"m3u8",method:"get",name:"playlist",url:t})})):this.httpWorker.postMessage({type:"invoke",fileType:"m3u8",method:"get",name:"playlist",url:this.sourceURL}),this.httpWorker.onmessage=function(r){var n=r.data,i=r.data.data;if(i)"playlist"==n.name&&e.parsePlaylist(i,t);else{var a="Get the ".concat(n.fileType," file error. URL: ").concat(n.url);e.events.emit(st.PlayerAlert,a),e.events.emit(st.LoaderError,a,n);var o=[e.state,"request playlist error.","data:",n,a];e.events.emit(st.PlayerThrowError,o)}}}},{key:"parsePlaylist",value:function(t,e){var r,n=new bt;n.push(t),n.end();var i=n.manifest,a=null===(r=i.playlists)||void 0===r?void 0:r.length;if(a){var o=i.playlists[a-1];return this.sourceURL=o.uri,void this.loadPlaylist(e)}var s=new X(t);if(s.segments&&s.segments.length){s.segments.forEach((function(t){t.start=K.msec2sec(t.start),t.end=K.msec2sec(t.end),t.duration=K.msec2sec(t.duration)})),this.setSourceData(Object.freeze(s)),this.segmentPool.addAll(s.segments),e.call(this,s)}else{this.events.emit(st.LoaderError,s),this.events.emit(st.PlayerAlert,"Parse playlist file error.");var u=[this.state,"Parse playlist error.","data:",s];this.events.emit(st.PlayerThrowError,u)}}},{key:"setSourceData",value:function(t){this.sourceData=t}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setSegmentPool",value:function(t){this.segmentPool=t}},{key:"getSegmentPool",value:function(){return this.segmentPool}},{key:"isNotFree",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t="["+t+"]loader is not free. please wait.",this.state!==j.IDLE&&this.state!==j.DONE&&(this.logger.warn("isNotFree","check status for loader","notice:",t),!0)}},{key:"getBaseUrl",value:function(t){var e=this.options.sourceURL;if(!(t.indexOf("//")>-1)){var r=e.lastIndexOf("/");return e.substr(0,r+1)}return""}},{key:"checkLoadCondition",value:function(t){return!(t.no>this.segmentPool.length)&&(!(this.dataController.getLoadDataBufferPool().bufferDuration>this.maxBufferDuration)||(this.logger.info("checkLoadCondition","stop load next segment.","bufferDuration:",this.dataController.getLoadDataBufferPool().bufferDuration,"maxBufferDuration:",this.maxBufferDuration),!1))}},{key:"loadFile",value:function(t,e,r){var n=this;if(t instanceof it)if(this.isNotFree()&&"seek"!==e&&"start"!==e)this.logger.warn("loadFile","is loading","segment:",t,"type:",e);else{if(_t[t.file]){var i=_t[t.file];return this.state=j.IDLE,void this.events.emit(st.LoaderLoaded,i,t,e,r)}if(!this.checkLoadCondition(t))return this.state=j.IDLE,void this.logger.warn("loadFile","checkLoadCondition failed","segment:",t,"type:",e);this.currentNo=t.no;var a=this.getBaseUrl(t.file)+t.file,o=1,s=function(){if(n.options.player.options.beforeLoad)n.options.player.options.beforeLoad(t.file,n.options.sourceURL).then((function(e){n.httpWorker.postMessage({type:"invoke",fileType:"ts",method:"get",name:t.no,url:e})}));else{var e=function(t,e){return"function"==typeof n.options.processURL?n.options.processURL(t,e):t}(a,t);n.httpWorker.postMessage({type:"invoke",fileType:"ts",method:"get",name:t.no,url:e})}};this.state=j.LOADING,this.events.emit(st.LoaderLoading,t,e,r),this.httpWorker.onmessage=function(i){n.state=j.DONE;var a=i.data;if(n.logger.info("loadfile","httpWorker","onmessage get data"),a&&"error"!==a.type)"notice"===a.type?"speed"===a.noticeType&&n.events.emit(st.LoaderUpdateSpeed,a.data):"ts"===a.fileType&&a.name===t.no?(n.logger.info("loadFile","read success","data no:",a.name),n.state=j.IDLE,n.events.emit(st.LoaderLoaded,a,t,e,r),_t[t.file]=a):n.logger.warn("loadFile","is not ts file or the segment'no is not equal.","fileType:",a.fileType,"data:",a);else if(n.state=j.ERROR,o<=n.maxRetryCount)n.logger.warn("loadFile","retry to load","count:",o,"segment:",t),s(),o+=1;else{n.events.emit(st.LoaderError,t,e,r);n.events.emit(st.PlayerAlert,"Load file error, please concat administrator.");var u=[n.state,"Load File error.","load count:",o,"segment:",t];n.events.emit(st.PlayerThrowError,u)}},s()}}},{key:"destroy",value:function(){this.httpWorker&&this.httpWorker.terminate()}}]),r}(F)},Tt=function(t){c()(r,t);var e=Pt(r);function r(t,n){var a;return i()(this,r),a=e.call(this),g()(u()(a),"state",null),g()(u()(a),"exeLoader",null),g()(u()(a),"loadData",null),g()(u()(a),"type","HLS"),g()(u()(a),"options",null),g()(u()(a),"dataController",null),a.type=t||a.type,a.player=n.player,a.options=n.player.options,a.dataController=a.player.dataController,a.init(a.type,a.options),a}return o()(r,[{key:"init",value:function(t,e){this.bindEvent(),this.setExeLoader(new Et[t](xt(xt({},e),{},{player:this.player,loaderController:this}))),this.setSourceURL(e.sourceURL),this.player.loadData?this.setLoadData(this.player.loadData):this.setLoadData(this.dataController.getDataInstance("load",e)),this.exeLoader.setLoadData(this.loadData)}},{key:"run",value:function(){this.state=j.LOAD_PLAYLIST,this.events.emit(st.LoaderPlayListStart,this),this.logger.info("run",j[this.state],"url:",this.options.sourceURL),this.loadPlaylist()}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderLoadFile,(function(e,r,n){t.exeLoader.loadFile(e,r,n)}))}},{key:"loadPlaylist",value:function(t){var e=this;this.exeLoader.loadPlaylist((function(r){r?(e.dataController.setLoadDataSourceData(e.exeLoader.getSourceData()),e.dataController.setLoadDataSegmentPool(e.exeLoader.getSegmentPool()),e.state=j.LOADED_PLAYLIST,e.events.emit(st.LoaderPlayListLoaded,e),"function"==typeof t&&t.call(e,r)):e.logger.error("run","start load m3u8","data:",r)}))}},{key:"switchPlaylist",value:function(t,e){this.setSourceURL(t),this.dataController.clearLoadData(),this.state=j.LOAD_PLAYLIST,this.events.emit(st.LoaderPlayListStart,this),this.logger.info("switchPlaylist",j[this.state],"url:",t),this.loadPlaylist(e)}},{key:"setExeLoader",value:function(t){this.exeLoader=t}},{key:"getExeLoader",value:function(){return this.exeLoader}},{key:"setSourceURL",value:function(t){this.exeLoader.setSourceURL(t)}},{key:"getSourceURL",value:function(){return this.exeLoader.getSourceURL()}},{key:"setLoadData",value:function(t){this.loadData=t}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getSourceData",value:function(){return this.exeLoader.getSourceData()}},{key:"destroy",value:function(){this.exeLoader.destroy()}}]),r}(A);function Bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var St=function(t){c()(r,t);var e=Bt(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"no",0),g()(u()(n),"start",0),g()(u()(n),"end",0),g()(u()(n),"blob",null),g()(u()(n),"arrayBuffer",null),g()(u()(n),"duration",0),Object.assign(u()(n),t),n}return o()(r,[{key:"size",get:function(){return this.blob.size}}]),r}(rt);function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Lt=function(t){c()(r,t);var e=Rt(r);function r(t){return i()(this,r),e.call(this,t)}return o()(r,[{key:"add",value:function(t){t instanceof St||(t=new St(t));var e=this.length;if(0!==e){for(;e--;)if(t.no<=this[e].no)return void this.splice(e,1,t);return this.push(t),this}this.push(t)}},{key:"getBufferSize",value:function(){return this.length<=0?0:this.reduce((function(t,e){return isNaN(t)&&(t=t.blob.size),t+e.blob.size}))}},{key:"getBufferDuration",value:function(){return this.length<=0?0:this.reduce((function(t,e){return isNaN(t)&&(t=t.end-t.start),t+(e.end-e.start)}))}},{key:"bufferSize",get:function(){return this.getBufferSize()}},{key:"bufferDuration",get:function(){return this.getBufferDuration()}}]),r}(et);function Dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ct=function(t){c()(r,t);var e=Dt(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this),g()(u()(t),"bufferPool",[]),g()(u()(t),"sourceData",{}),g()(u()(t),"options",{}),g()(u()(t),"segmentPool",[]),g()(u()(t),"readBufferNo",null),g()(u()(t),"startLoadTime",null),g()(u()(t),"currentSeekTime",null),t.options=n,t.init(),t}return o()(r,[{key:"init",value:function(){var t=this;this.setBufferPool(new Lt),this.events.on(st.LoadDataReadBufferByNo,(function(e,r){t.readBufferByNo(e,r)})),this.events.on(st.LoadDataReadBuffer,(function(e,r){t.readBuffer(e,r)})),this.events.on(st.LoaderLoaded,(function(e,r,n,i){var a=t.createBuffer({arrayBuffer:Uint8Array.from(e.arrayBuffer)},r);if(t.segmentLoaded(r,a),"seek"===n&&i===t.currentSeekTime)return t.events.emit(st.LoadDataSeek,a,i),void t.removeBufferByNo(a.no);i===t.startLoadTime&&t.events.emit(st.LoadDataFirstLoaded,a,i)}))}},{key:"setOptions",value:function(t){Object.assign(this.options,t)}},{key:"startLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.logger.info("startLoad","begin to load ts data","time:",t),isNaN(t)?this.logger.error("seekTime","seek","time:",t):(this.startLoadTime=t,this.loadSegmentByTime(t,"start"))}},{key:"readBuffer",value:function(t,e){var r=this.getSegmentByTime(t);r&&this.readBufferByNo(r.no,e)}},{key:"segmentLoaded",value:function(t,e){e&&this.addBufferPool(e),t.no===this.options.player.currentIndex&&this.readBufferByNo(t.no),t.no<this.segmentPool.getLast().no&&this.loadSegmentByNo(t.no+1)}},{key:"seekTime",value:function(t){if(isNaN(t))this.logger.error("seekTime","seek","time:",t);else{var e;this.currentSeekTime=t;var r=this.bufferPool.indexOfByTime(t);r>-1?(e=this.bufferPool[r],this.events.emit(st.LoadDataSeek,e,t)):(this.removeBufferPool(this.bufferPool.length),this.loadSegmentByTime(t,"seek"))}}},{key:"loadSegmentByTime",value:function(t,e){if(!isNaN(t)){var r=this.segmentPool.indexOfByTime(t);if(r>=0){var n=this.segmentPool[r];this.events.emit(st.LoaderLoadFile,n,e,t)}else this.logger.error("loadSegmentByTime","time over","time:",t,"type:",e)}}},{key:"createBuffer",value:function(t,e){if(t){var r={start:e.start,end:e.end,no:e.no,duration:e.end-e.start,arrayBuffer:t.arrayBuffer};return new St(r)}}},{key:"isValidSegmentNo",value:function(t){return!isNaN(t)&&t>0&&t<=this.segmentPool.length}},{key:"loadSegmentByNo",value:function(t){var e=t-1,r=this.segmentPool.get(e);r&&this.events.emit(st.LoaderLoadFile,r,"play")}},{key:"readBufferByNo",value:function(t,e){this.isValidSegmentNo(t)?(this.readBufferNo=t,e=e||function(t){this.events.emit(st.LoadDataRead,t)},this.getBlobByNo(t,e)):this.logger.error("readBufferByNo","check buffer no","is not valid no",t)}},{key:"getSegmentByTime",value:function(t){var e=this.segmentPool.indexOfByTime(t);return this.segmentPool[e]}},{key:"getBlobByNo",value:function(t,e){if(isNaN(t))this.logger.error("getBlobByNo","isNaN","no:",t);else{var r;if(!this.isBufferReading)return this.isBufferReading=!0,r=this.bufferPool.getByKeyValue("no",t)[0],"function"==typeof e&&(e.call(this,r),r&&this.removeBufferByNo(r.no)),this.isBufferReading=!1,r;this.logger.warn("getBlobByNo","isBufferReading","no:",t)}}},{key:"addBufferPool",value:function(t){if(this.bufferPool.length){if(this.bufferPool[0].no===t.no+1)return this.bufferPool.unshift(t),!0;var e=this.bufferPool.getLast();if(t.no-e.no==1)return this.bufferPool.push(t),!0;if(this.bufferPool.indexOfByKey("no",t.no))return!0;this.bufferPool.splice(0,this.bufferPool.length)}this.bufferPool.push(t)}},{key:"removeBufferPool",value:function(t){this.bufferPool.splice(0,t+1)}},{key:"removeBufferByNo",value:function(t){var e=this.bufferPool.indexOfByKey("no",t);if(!(e<=-1))return this.removeBufferPool(e),this.bufferPool.length?this.bufferPool.getLast().no<this.segmentPool.getLast().no&&this.loadSegmentByNo(this.bufferPool.getLast().no+1):t<this.segmentPool.getLast().no&&this.loadSegmentByNo(t+1),!0}},{key:"clear",value:function(){this.sourceData={},this.readBufferNo=null,this.currentSeekTime=null,this.bufferPool.length=0,this.segmentPool.length=0}},{key:"getSegmentByNo",value:function(t){return this.segmentPool.get(t-1)}},{key:"getSegment",value:function(t){return this.segmentPool.getByTime(t)}},{key:"setSourceData",value:function(t){this.sourceData=t}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setBufferPool",value:function(t){this.bufferPool=t}},{key:"getBufferPool",value:function(){return this.bufferPool}},{key:"setSegmentPool",value:function(t){this.segmentPool=t}},{key:"getSegmentPool",value:function(){return this.segmentPool}}]),r}(M);function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var It=function(t){c()(r,t);var e=At(r);function r(t){var n;return i()(this,r),n=e.call(this),g()(u()(n),"loadData",null),n.options=t,n}return o()(r,[{key:"setLoadData",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.loadData=C()(Ct,e)}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getLoadDataBufferPool",value:function(){return this.loadData.bufferPool}},{key:"setLoadDataSourceData",value:function(t){this.loadData.setSourceData(t)}},{key:"setLoadDataSegmentPool",value:function(t){this.loadData.setSegmentPool(t)}},{key:"startLoad",value:function(t){t=Math.max(t,0),this.startLoadData(t)}},{key:"startLoadData",value:function(t){this.loadData.startLoad(t)}},{key:"clearLoadData",value:function(){this.loadData.clear()}},{key:"getDataInstance",value:function(t){if(t)switch(t){case"load":if(!this.loadData){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.setLoadData.apply(this,r)}return this.loadData;default:return null}}}]),r}(A);function Ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ut,Mt,Nt=function(t){c()(r,t);var e=Ot(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"checkHanlder",null),g()(u()(n),"resetStatus",{processor:!1,audioPlayer:!1}),n.player=t.player,n.player?(n.audioPlayer=t.audioPlayer,n.imagePlayer=t.imagePlayer,n.loadData=t.loadData,n.bindEvent(),n):f()(n)}return o()(r,[{key:"bindEvent",value:function(){var t=this;this.events.on(st.ProcessorResetEnd,(function(){t.checkResetReady("processor")})),this.events.on(st.AudioPlayerReady,(function(){t.checkResetReady("audioPlayer")})),this.events.on(st.PlayerResetReady,(function(){t.onResetReady()})),this.events.on(st.LoadDataSeek,(function(e,r){t.onSeek(e,r)})),this.events.on(st.ImagePlayerRenderEnd,(function(e,r){t.onRenderEnd(e,r)})),this.events.on(st.ImagePlayerWait,(function(){t.audioPlayer.pause()}))}},{key:"play",value:function(t){this.logger.warn("play","play start"),this.sync(t)}},{key:"sync",value:function(t){var e=this.player,r=this.audioPlayer,n=this.imagePlayer,i=r.offset,a=n.offset,o=Math.min(i,a),s=Math.max(i,a);r.need||(o=a,s=a);var u=e.playbackRate;if(e.seeking&&(e.seeking=!1),!e.reseting&&"pause"!==e.status&&"waiting"!==r.status&&"wait"!==n.status)if("end"!==e.status){if(this.setCurrentTime(t),!(t<o))return r.need&&t>=i&&t<=a?(this.events.once(st.AudioPlayerPlaySuccess,(function(){n.render(a)})),r.playbackRate=u,void r.play()):void(t>=a&&(!r.need||t<=i)?n.render(t):t>s&&(this.audioPlayer.playbackRate=u,this.audioPlayer.play(),n.render(t)));this.sync(o)}else r.paused||r.pause()}},{key:"setCurrentTime",value:function(t){var e=t-this.player.startPts;this.player.currentTime=e,this.events.emit(st.PlayerTimeUpdate,e)}},{key:"pause",value:function(){this.audioPlayer.pause(),this.clearDrawHanlder()}},{key:"seek",value:function(t){var e=this,r=this.imagePlayer.isBuffered(t),n=this.audioPlayer.isBuffered(t);this.player.pause(),r&&n?(this.logger.warn("seek","seek in buffer, time: ".concat(t,", buffer: ").concat(this.player.buffer()[0],", ").concat(this.player.buffer()[1])),this.audioPlayer.need?(this.audioPlayer.onSeekedHandler=function(){e.imagePlayer.render(t,!1)},this.audioPlayer.currentTime=t):(this.imagePlayer.render(t,!1),this.events.emit(st.StreamDataReady))):this.reset()}},{key:"reset",value:function(t){this.logger.info("reset","reset start"),this.player.reseting=!0,this.events.emit(st.PlayerReset,t),this.resetStatus={processor:!1,audioPlayer:!1},this.player.processController.reset(),this.player.streamController.reset(),this.player.audioPlayer.reset(t),this.player.imagePlayer.reset(),this.player.currentIndex=null}},{key:"checkResetReady",value:function(t){var e=this.resetStatus;if(t&&"string"==typeof t){e[t]=!0;for(var r=Object.keys(e),n=0;n<r.length;n++)if(!e[r[n]])return!1;this.logger.warn("checkResetReady","reset ready"),this.events.emit(st.PlayerResetReady)}}},{key:"onResetReady",value:function(){this.player.reseting=!1,this.logger.info("onResetReady","reset Ready"),this.player.changing&&this.events.emit(st.DataProcessorReady),this.player.seeking&&this.player.loadData.seekTime(this.player.currentTime/1e3)}},{key:"onSeek",value:function(t,e){var r=this.player.currentTime;this.logger.info("onseek",r,t,t.no,e),t&&t.no&&Math.abs(r-Math.floor(1e3*e))<2?(this.player.currentIndex=t.no,this.logger.info("seektime:",t.no,e,this.player.currentTime),this.player.seekSegmentNo=t.no,this.player.streamController.startLoad(t.no)):this.logger.warn("seek failue, not found data",r,t,e)}},{key:"clearDrawHanlder",value:function(){clearTimeout(this.drawFrameHanlder),this.drawFrameHanlder=null}},{key:"onRenderEnd",value:function(t,e){this.player.seekTime&&(this.logger.info("onRenderEnd","seektoRenderTime:",Date.now()-this.player.seekTime),this.player.seekTime=null);var r=this.imagePlayer,n=this.audioPlayer,i=this.player.playbackRate,a=n.currentTime,o=r.currentTime,s=n.offset,u=r.fragDuration,l=a-o,c=0;n.need?o<s?this.drawNext(o+u*i,u):(l>0&&l>u?u=(c=o+Math.ceil(l/u+i)*u)-a:(c=o+u*i,u-=l),this.drawNext(c,u)):this.drawNext(t+e,Math.ceil(e/i))}},{key:"drawNext",value:function(t,e){var r=this;this.drawFrameHanlder&&this.clearDrawHanlder(),this.drawFrameHanlder=setTimeout((function(){r.sync(t)}),e)}}]),r}(M);function Ht(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Ft(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ft(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function $t(t){if(Ut){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];Ut.apply(void 0,[t].concat(r))}}function Wt(t){if(Mt){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];Mt.apply(void 0,[t].concat(r))}}var Vt=function(){function t(e){i()(this,t),this.payload=e,this.nri=(96&this.payload[0])>>5,this.ntype=31&this.payload[0]}return o()(t,null,[{key:"type",value:function(e){return e.ntype in t.TYPES?t.TYPES[e.ntype]:"UNKNOWN"}},{key:"NDR",get:function(){return 1}},{key:"IDR",get:function(){return 5}},{key:"SEI",get:function(){return 6}},{key:"SPS",get:function(){return 7}},{key:"PPS",get:function(){return 8}},{key:"AUD",get:function(){return 9}},{key:"TYPES",get:function(){var e;return e={},g()(e,t.IDR,"IDR"),g()(e,t.SEI,"SEI"),g()(e,t.SPS,"SPS"),g()(e,t.PPS,"PPS"),g()(e,t.NDR,"NDR"),g()(e,t.AUD,"AUD"),e}}]),o()(t,[{key:"toString",value:function(){return"".concat(t.type(this),": NRI: ").concat(this.getNri())}},{key:"getNri",value:function(){return this.nri>>6}},{key:"type",value:function(){return this.ntype}},{key:"isKeyframe",value:function(){return this.ntype==t.IDR}},{key:"getSize",value:function(){return 4+this.payload.byteLength}},{key:"getData",value:function(){var t=new Uint8Array(this.getSize());return new DataView(t.buffer).setUint32(0,this.getSize()-4),t.set(this.payload,4),t}}]),t}(),zt=function(){function t(e){i()(this,t),this.data=e,this.index=0,this.bitLength=8*e.byteLength}return o()(t,[{key:"skipBits",value:function(t){if(this.bitsAvailable<t)return!1;this.index+=t}},{key:"readBits",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.getBits(t,this.index,e);return r}},{key:"getBits",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.bitsAvailable<t)return 0;var n=e%8,i=this.data[e/8|0]&255>>>n,a=8-n;if(a>=t)return r&&(this.index+=t),i>>a-t;r&&(this.index+=a);var o=t-a;return i<<o|this.getBits(o,e+a,r)}},{key:"skipLZ",value:function(){var t;for(t=0;t<this.bitLength-this.index;++t)if(0!==this.getBits(1,this.index+t,!1))return this.index+=t,t;return t}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var t=this.skipLZ();return this.readBits(t+1)-1}},{key:"readEG",value:function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readBits(8*t)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"bitsAvailable",get:function(){return this.bitLength-this.index}}]),t}(),Yt=function(){function t(e){i()(this,t),this.remuxer=e,this.track=e.mp4track}return o()(t,null,[{key:"extractNALu",value:function(t){for(var e,r,n=0,i=t.byteLength,a=0,o=[];n<i;)switch(e=t[n++],a){case 0:0===e&&(a=1);break;case 1:a=0===e?2:0;break;case 2:case 3:0===e?a=3:1===e&&n<i?(r&&o.push(t.subarray(r,n-a-1)),r=n,a=0):a=0}return r&&o.push(t.subarray(r,i)),o}},{key:"skipScalingList",value:function(t,e){for(var r=8,n=8,i=0;i<e;i++)0!==n&&(n=(r+t.readEG()+256)%256),r=0===n?r:n}},{key:"readSPS",value:function(e){var r,n,i,a,o,s,u=new zt(e),l=0,c=0,h=0,f=0,d=1;if(u.readUByte(),r=u.readUByte(),u.readBits(5),u.skipBits(3),u.readUByte(),u.skipUEG(),100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r){var p=u.readUEG();if(3===p&&u.skipBits(1),u.skipUEG(),u.skipUEG(),u.skipBits(1),u.readBoolean()){s=3!==p?8:12;for(var y=0;y<s;++y)u.readBoolean()&&(y<6?t.skipScalingList(u,16):t.skipScalingList(u,64))}}u.skipUEG();var g=u.readUEG();if(0===g)u.readUEG();else if(1===g){u.skipBits(1),u.skipEG(),u.skipEG(),n=u.readUEG();for(var v=0;v<n;++v)u.skipEG()}if(u.skipUEG(),u.skipBits(1),i=u.readUEG(),a=u.readUEG(),0===(o=u.readBits(1))&&u.skipBits(1),u.skipBits(1),u.readBoolean()&&(l=u.readUEG(),c=u.readUEG(),h=u.readUEG(),f=u.readUEG()),u.readBoolean()){if(u.readBoolean()){var m;switch(u.readUByte()){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[u.readUByte()<<8|u.readUByte(),u.readUByte()<<8|u.readUByte()]}m&&(d=m[0]/m[1])}if(u.readBoolean()&&u.skipBits(1),u.readBoolean()&&(u.skipBits(4),u.readBoolean()&&u.skipBits(24)),u.readBoolean()&&(u.skipUEG(),u.skipUEG()),u.readBoolean())u.readUInt(),u.readUInt(),u.readBoolean()}return{width:Math.ceil((16*(i+1)-2*l-2*c)*d),height:(2-o)*(a+1)*16-(o?2:4)*(h+f)}}}]),o()(t,[{key:"parseSPS",value:function(e){var r=t.readSPS(new Uint8Array(e));this.track.width=r.width,this.track.height=r.height,this.track.sps=[new Uint8Array(e)],this.track.codec="avc1.";for(var n=new DataView(e.buffer,e.byteOffset+1,4),i=0;i<3;++i){var a=n.getUint8(i).toString(16);a.length<2&&(a="0"+a),this.track.codec+=a}}},{key:"parsePPS",value:function(t){this.track.pps=[new Uint8Array(t)]}},{key:"parseNAL",value:function(t){if(!t)return!1;var e=!1;switch(t.type()){case Vt.NDR:case Vt.IDR:e=!0;break;case Vt.PPS:this.track.pps||(this.parsePPS(t.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),e=!0;break;case Vt.SPS:this.track.sps||(this.parseSPS(t.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),e=!0;break;case Vt.AUD:$t("AUD - ignoing and disable HD mode for live channel"),this.remuxer.isHDAvail&&(this.remuxer.isHDAvail=!1);break;case Vt.SEI:$t("SEI - ignoing")}return e}}]),t}(),Xt=function(){function t(e){i()(this,t),this.listener={},this.type=""|e}return o()(t,[{key:"on",value:function(t,e){return this.listener[t]||(this.listener[t]=[]),this.listener[t].push(e),!0}},{key:"off",value:function(t,e){if(this.listener[t]){var r=this.listener[t].indexOf(e);return r>-1&&this.listener[t].splice(r,1),!0}return!1}},{key:"offAll",value:function(){this.listener={}}},{key:"dispatch",value:function(t,e){return!!this.listener[t]&&(this.listener[t].map((function(t){t.apply(null,[e])})),!0)}}]),t}(),Gt=Math.pow(2,32)-1,qt=function(){function t(){i()(this,t)}return o()(t,null,[{key:"init",value:function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,u,o,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))}},{key:"box",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];for(var i,a=8,o=r.length,s=o;o--;)a+=r[o].byteLength;for((i=new Uint8Array(a))[0]=a>>24&255,i[1]=a>>16&255,i[2]=a>>8&255,i[3]=255&a,i.set(t,4),o=0,a=8;o<s;++o)i.set(r[o],a),a+=r[o].byteLength;return i}},{key:"hdlr",value:function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])}},{key:"mdat",value:function(e){return t.box(t.types.mdat,e)}},{key:"mdhd",value:function(e,r){r*=e;var n=Math.floor(r/(Gt+1)),i=Math.floor(r%(Gt+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))}},{key:"mfhd",value:function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}},{key:"minf",value:function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))}},{key:"moof",value:function(e,r,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,r))}},{key:"moov",value:function(e,r,n){for(var i=e.length,a=[];i--;)a[i]=t.trak(e[i]);return t.box.apply(null,[t.types.moov,t.mvhd(n,r)].concat(a).concat(t.mvex(e)))}},{key:"mvex",value:function(e){for(var r=e.length,n=[];r--;)n[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(n))}},{key:"mvhd",value:function(e,r){r*=e;var n=Math.floor(r/(Gt+1)),i=Math.floor(r%(Gt+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,a)}},{key:"sdtp",value:function(e){var r,n,i=e.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,a)}},{key:"stbl",value:function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))}},{key:"avc1",value:function(e){var r,n,i,a=[],o=[];for(r=0;r<e.sps.length;r++)i=(n=e.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<e.pps.length;r++)i=(n=e.pps[r]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),u=e.width,l=e.height;return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(t){var e=t.config.byteLength,r=new Uint8Array(26+e+3);return r.set([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5,e]),r.set(t.config,26),r.set([6,1,2],26+e),r}},{key:"mp4a",value:function(e){var r=e.audiosamplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))}},{key:"stsd",value:function(e){return"audio"===e.type?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))}},{key:"tkhd",value:function(e){var r=e.id,n=e.duration*e.timescale,i=e.width,a=e.height,o=Math.floor(n/(Gt+1)),s=Math.floor(n%(Gt+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(e,r){var n=t.sdtp(e),i=e.id,a=Math.floor(r/(Gt+1)),o=Math.floor(r%(Gt+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(e,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))}},{key:"trex",value:function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(e,r){var n,i,a,o,s,u,l=e.samples||[],c=l.length,h=12+16*c,f=new Uint8Array(h);for(r+=8+h,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)a=(i=l[n]).duration,o=i.size,s=i.flags,u=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return t.box(t.types.trun,f)}},{key:"initSegment",value:function(e,r,n){t.types||t.init();var i,a=t.moov(e,r,n);return(i=new Uint8Array(t.FTYP.byteLength+a.byteLength)).set(t.FTYP),i.set(a,t.FTYP.byteLength),i}}]),t}(),Qt=function(){function t(e){i()(this,t),this.remuxer=e,this.track=e.mp4track,this.aacHeader=null}return o()(t,[{key:"getHeaderLength",value:function(t){return 1&t[1]?7:9}},{key:"getFrameLength",value:function(t){return(3&t[3])<<11|t[4]<<3|(224&t[5])>>>5}},{key:"isAACPattern",value:function(t){return 255===t[0]&&240==(240&t[1])&&0==(6&t[1])}},{key:"extractAAC",value:function(t){var e,r,n=0,i=t.byteLength,a=[];if(!this.isAACPattern(t))return Wt("Invalid ADTS audio format"),a;for(e=this.getHeaderLength(t),this.aacHeader||(this.aacHeader=t.subarray(0,e));n<i;)r=this.getFrameLength(t),a.push(t.subarray(e,r)),t=t.slice(r),n+=r;return a}},{key:"samplingRateMap",get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]}},{key:"getAACHeaderData",get:function(){return this.aacHeader}},{key:"setAACHeaderData",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.aacHeader=t}}]),o()(t,[{key:"setAACConfig",value:function(){var t,e,r,n=new Uint8Array(2),i=this.getAACHeaderData;i&&(t=1+((192&i[2])>>>6),e=(60&i[2])>>>2,r=(1&i[2])<<2,r|=(192&i[3])>>>6,n[0]=t<<3,n[0]|=(14&e)>>1,n[1]|=(1&e)<<7,n[1]|=r<<3,this.track.codec="mp4a.40."+t,this.track.channelCount=r,this.track.config=n,this.remuxer.readyToDecode=!0)}}]),t}(),Kt=1,Jt=function(){function t(){i()(this,t),this.seq=1}return o()(t,null,[{key:"getTrackID",value:function(){return Kt++}}]),o()(t,[{key:"flush",value:function(){this.seq++,this.mp4track.len=0,this.mp4track.samples=[]}},{key:"isReady",value:function(){return!(!this.readyToDecode||!this.samples.length)||null}}]),t}(),Zt=function(t){c()(r,t);var e=jt(r);function r(){var t;return i()(this,r),(t=e.call(this)).readyToDecode=!1,t.nextDts=0,t.dts=0,t.timescale=1e3,t.mp4track={id:Jt.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:t.timescale,duration:t.timescale,samples:[],config:"",codec:""},t.samples=[],t.aac=new Qt(u()(t)),t}return o()(r,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.codec="",this.mp4track.channelCount="",this.mp4track.config="",this.mp4track.timescale=this.timescale}},{key:"remux",value:function(t){var e,r,n,i=Ht(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e=(r=a.units).byteLength,this.samples.push({units:r,size:e,duration:a.duration}),this.mp4track.len+=e,this.readyToDecode||this.aac.setAACConfig()}}catch(t){i.e(t)}finally{i.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var t,e,r=new Uint8Array(this.mp4track.len),n=0,i=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var a=this.samples.shift();(e=a.duration)<=0?($t("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(e)),this.mp4track.len-=a.size):(this.nextDts+=e,t={size:a.size,duration:e,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},r.set(a.units,n),n+=a.size,i.push(t))}return i.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}}]),r}(Jt),te=function(t){c()(r,t);var e=jt(r);function r(){var t;return i()(this,r),(t=e.call(this)).readyToDecode=!1,t.nextDts=0,t.dts=0,t.timescale=1e3,t.mp4track={id:Jt.getTrackID(),type:"video",len:0,fragmented:!0,sps:"",pps:"",width:0,height:0,timescale:t.timescale,duration:t.timescale,samples:[]},t.samples=[],t.h264=new Yt(u()(t)),t}return o()(r,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.sps="",this.mp4track.pps=""}},{key:"remux",value:function(t){var e,r,n,i,a,o,s=Ht(t);try{for(s.s();!(o=s.n()).done;){e=o.value,r=[],i=0,a=!1;var u,l=Ht(e.units);try{for(l.s();!(u=l.n()).done;)n=u.value,this.h264.parseNAL(n)&&(r.push(n),i+=n.getSize(),a||(a=n.isKeyframe()))}catch(t){l.e(t)}finally{l.f()}r.length>0&&this.readyToDecode&&(this.mp4track.len+=i,this.samples.push({units:r,size:i,keyFrame:a,duration:e.duration}))}}catch(t){s.e(t)}finally{s.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var t,e,r=new Uint8Array(this.mp4track.len),n=0,i=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var a=this.samples.shift(),o=a.units;if((e=a.duration)<=0)$t("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(e)),this.mp4track.len-=a.size;else{this.nextDts+=e,t={size:a.size,duration:e,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:a.keyFrame?0:1,dependsOn:a.keyFrame?2:1}};var s,u=Ht(o);try{for(u.s();!(s=u.n()).done;){var l=s.value;r.set(l.getData(),n),n+=l.getSize()}}catch(t){u.e(t)}finally{u.f()}i.push(t)}}return i.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}}]),r}(Jt);function ee(t,e){var r=new Uint8Array((0|t.byteLength)+(0|e.byteLength));return r.set(t,0),r.set(e,0|t.byteLength),r}var re=function(t){c()(r,t);var e=jt(r);function r(t){var n;return i()(this,r),(n=e.call(this,"remuxer")).initialized=!1,n.trackTypes=[],n.tracks={},n.mediaDuration=t?1/0:1e3,n}return o()(r,[{key:"addTrack",value:function(t){"video"!==t&&"both"!==t||(this.tracks.video=new te,this.trackTypes.push("video")),"audio"!==t&&"both"!==t||(this.tracks.audio=new Zt,this.trackTypes.push("audio"))}},{key:"reset",value:function(){var t,e=Ht(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var r=t.value;this.tracks[r].resetTrack()}}catch(t){e.e(t)}finally{e.f()}this.initialized=!1}},{key:"destroy",value:function(){this.tracks={},this.offAll()}},{key:"flush",value:function(){if(this.initialized){var t,e=Ht(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var r=t.value,n=this.tracks[r],i=n.getPayload();if(i&&i.byteLength){var a={type:r,payload:ee(qt.moof(n.seq,n.dts,n.mp4track),qt.mdat(i)),dts:n.dts};this.dispatch("buffer",a);var o=(f=n.dts/1e3,d=void 0,p=void 0,y=void 0,g=void 0,g="",d=Math.floor(f),(p=parseInt(d/3600,10)%24)>0&&(g+=(p<10?"0"+p:p)+":"),g+=((y=parseInt(d/60,10)%60)<10?"0"+y:y)+":"+((d=d<0?0:d%60)<10?"0"+d:d));$t("put segment (".concat(r,"): ").concat(n.seq," dts: ").concat(n.dts," samples: ").concat(n.mp4track.samples.length," second: ").concat(o)),n.flush()}}}catch(t){e.e(t)}finally{e.f()}}else if(this.isReady()){this.dispatch("ready");var s,u=Ht(this.trackTypes);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this.tracks[l],h={type:l,payload:qt.initSegment([c.mp4track],this.mediaDuration,c.mp4track.timescale)};this.dispatch("buffer",h)}}catch(t){u.e(t)}finally{u.f()}$t("Initial segment generated."),this.initialized=!0}var f,d,p,y,g}},{key:"isReady",value:function(){var t,e=Ht(this.trackTypes);try{for(e.s();!(t=e.n()).done;){var r=t.value;if(!this.tracks[r].readyToDecode||!this.tracks[r].samples.length)return!1}}catch(t){e.e(t)}finally{e.f()}return!0}},{key:"remux",value:function(t){var e,r=Ht(this.trackTypes);try{for(r.s();!(e=r.n()).done;){var n=e.value,i=t[n];"audio"===n&&this.tracks.video&&!this.tracks.video.readyToDecode||i.length>0&&this.tracks[n].remux(i)}}catch(t){r.e(t)}finally{r.f()}this.flush()}}]),r}(Xt),ne=function(t){c()(r,t);var e=jt(r);function r(t,n){var a;return i()(this,r),(a=e.call(this,"buffer")).type=n,a.queue=new Uint8Array,a.cleaning=!1,a.pendingCleaning=0,a.cleanOffset=30,a.cleanRanges=[],a.sourceBuffer=t,a.sourceBuffer.addEventListener("updateend",(function(){a.dispatch("updateend",Date.now()),a.pendingCleaning>0&&(a.initCleanup(a.pendingCleaning),a.pendingCleaning=0),a.cleaning=!1,a.cleanRanges.length&&a.doCleanup()})),a.sourceBuffer.addEventListener("error",(function(t){a.dispatch("error",{type:a.type,name:"buffer",error:t})})),a}return o()(r,[{key:"destroy",value:function(){this.queue=null,this.sourceBuffer=null,this.offAll()}},{key:"doCleanup",value:function(){if(this.cleanRanges.length){var t=this.cleanRanges.shift();$t("".concat(this.type," remove range [").concat(t[0]," - ").concat(t[1],")")),this.cleaning=!0,this.sourceBuffer.remove(t[0],t[1]),this.dispatch("clearBuffer")}else this.cleaning=!1}},{key:"initCleanup",value:function(t){if(this.sourceBuffer.updating)this.pendingCleaning=t;else if(this.sourceBuffer.buffered&&this.sourceBuffer.buffered.length&&!this.cleaning){for(var e=0;e<this.sourceBuffer.buffered.length;++e){var r=this.sourceBuffer.buffered.start(e),n=this.sourceBuffer.buffered.end(e);t-r>this.cleanOffset&&r<(n=t-this.cleanOffset)&&this.cleanRanges.push([r,n])}this.doCleanup()}}},{key:"doAppend",value:function(){if(this.queue.length&&!this.sourceBuffer.updating)try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(t){if("QuotaExceededError"===t.name)return $t("".concat(this.type," buffer quota full")),void this.dispatch("error",{type:this.type,name:"QuotaExceeded",error:"buffer error"});Wt("Error occured while appending ".concat(this.type," buffer -  ").concat(t.name,": ").concat(t.message)),this.dispatch("error",{type:this.type,name:"unexpectedError",error:"buffer error"})}}},{key:"feed",value:function(t){this.queue=ee(this.queue,t)}}]),r}(Xt);window.MediaSource=window.MediaSource||window.WebKitMediaSource;var ie=function(t){c()(r,t);var e=jt(r);function r(t){var n;i()(this,r),n=e.call(this,"jmuxer"),window.MediaSource=window.MediaSource||window.WebKitMediaSource;if(n.options=Object.assign({},{node:"",mode:"both",flushingTime:1500,clearBuffer:!0,onReady:null,fps:30,debug:!1,onClearBuffer:null},t),n.options.debug&&(Ut=console.log,Mt=console.error),"string"==typeof n.options.node&&""==n.options.node&&Wt("no video element were found to render, provide a valid video element"),n.options.fps||(n.options.fps=30),n.frameDuration=1e3/n.options.fps|0,n.node="string"==typeof n.options.node?document.getElementById(n.options.node):n.options.node,n.sourceBuffers={},n.isMSESupported=!!window.MediaSource,!n.isMSESupported)throw"Oops! Browser does not support media source extension.";return n.setupMSE(),n.remuxController=new re(n.options.clearBuffer),n.remuxController.addTrack(n.options.mode),"audio"===n.options.mode&&(n.aacParser=n.remuxController.tracks.audio.aac),n.mseReady=!1,n.lastCleaningTime=Date.now(),n.keyframeCache=[],n.frameCounter=0,n.remuxController.on("buffer",n.onBuffer.bind(u()(n))),n.remuxController.on("ready",n.createBuffer.bind(u()(n))),n.startInterval(),n}return o()(r,null,[{key:"isSupported",value:function(t){return window.MediaSource&&window.MediaSource.isTypeSupported(t)}}]),o()(r,[{key:"setupMSE",value:function(){this.mediaSource=new MediaSource,this.node.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))}},{key:"feed",value:function(t){var e,r,n,i=!1,a={video:[],audio:[]};t&&this.remuxController&&(n=t.duration?parseInt(t.duration):0,t.video&&(e=Yt.extractNALu(t.video)).length>0&&(a.video=this.getVideoFrames(e,n),i=!0),t.audio&&(r=this.aacParser.extractAAC(t.audio)).length>0&&(a.audio=this.getAudioFrames(r,n),i=!0),i?this.remuxController.remux(a):Wt("Input object must have video and/or audio property. Make sure it is not empty and valid typed array"))}},{key:"getVideoFrames",value:function(t,e){var r,n,i,a,o=[],s=[],u=0,l=[],c=Ht(t);try{for(c.s();!(a=c.n()).done;)r=a.value,n=new Vt(r),o.push(n),n.type()!==Vt.IDR&&n.type()!==Vt.NDR||(s.push({units:o}),o=[],this.options.clearBuffer&&(n.type()===Vt.IDR&&l.push(this.frameCounter),this.frameCounter++))}catch(t){c.e(t)}finally{c.f()}return e?(i=e/s.length|0,u=e-i*s.length):i=this.frameDuration,s.map((function(t){t.duration=u>0?i+1:i,0!==u&&u--})),this.options.clearBuffer&&(l=l.map((function(t){return t*i/1e3})),this.keyframeCache=this.keyframeCache.concat(l)),s}},{key:"getAudioFrames",value:function(t,e){var r,n,i,a=[],o=0,s=Ht(t);try{for(s.s();!(i=s.n()).done;)r=i.value,a.push({units:r})}catch(t){s.e(t)}finally{s.f()}return e?(n=e/a.length|0,o=e-n*a.length):n=this.frameDuration,a.map((function(t){t.duration=o>0?n+1:n,0!==o&&o--})),a}},{key:"destroy",value:function(){if(this.aacParser=null,this.stopInterval(),this.mediaSource){try{this.bufferControllers&&(this.mediaSource.endOfStream(),this.removeSourceBuffer())}catch(t){Wt("mediasource is not available to end ".concat(t.message))}this.mediaSource=null}if(this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers){for(var t in this.bufferControllers)this.bufferControllers[t].destroy();this.bufferControllers=null}this.node=!1,this.mseReady=!1,this.videoStarted=!1}},{key:"createBuffer",value:function(){if(this.mseReady&&this.remuxController&&this.remuxController.isReady()&&!this.bufferControllers)for(var t in this.bufferControllers={},this.remuxController.tracks){var e=this.remuxController.tracks[t];if(!r.isSupported("".concat(t,'/mp4; codecs="').concat(e.mp4track.codec,'"')))return Wt("Browser does not support codec"),!1;var n=this.mediaSource.addSourceBuffer("".concat(t,'/mp4; codecs="').concat(e.mp4track.codec,'"'));this.bufferControllers[t]=new ne(n,t),this.sourceBuffers[t]=n,this.bufferControllers[t].on("error",this.onBufferError.bind(this)),this.bufferControllers[t].on("clearBuffer",this.onClearBuffer.bind(this)),this.bufferControllers[t].on("updateend",this.onUpdateEnd.bind(this))}}},{key:"onUpdateEnd",value:function(t){"function"==typeof this.options.onUpdateEnd&&this.options.onUpdateEnd(t)}},{key:"startInterval",value:function(){var t=this;this.interval=setInterval((function(){t.bufferControllers&&(t.releaseBuffer(),t.clearBuffer())}),this.options.flushingTime)}},{key:"stopInterval",value:function(){this.interval&&clearInterval(this.interval)}},{key:"releaseBuffer",value:function(){for(var t in this.bufferControllers)this.bufferControllers[t].doAppend()}},{key:"getSafeBufferClearLimit",value:function(t){for(var e,r="audio"===this.options.mode&&t||0,n=0;n<this.keyframeCache.length&&!(this.keyframeCache[n]>=t);n++)e=this.keyframeCache[n];return e&&(this.keyframeCache=this.keyframeCache.filter((function(t){return t<e&&(r=t),t>=e}))),r}},{key:"clearBuffer",value:function(){if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){for(var t in this.bufferControllers){var e=this.getSafeBufferClearLimit(this.node.currentTime);this.bufferControllers[t].initCleanup(e)}this.lastCleaningTime=Date.now()}}},{key:"onBuffer",value:function(t){this.bufferControllers&&this.bufferControllers[t.type]&&this.bufferControllers[t.type].feed(t.payload)}},{key:"onClearBuffer",value:function(){"function"==typeof this.options.onClearBuffer&&this.options.onClearBuffer()}},{key:"removeSourceBuffer",value:function(){if(this.mediaSource){var t=this.sourceBuffers;for(var e in t)this.mediaSource.removeSourceBuffer(t[e])}}},{key:"onMSEOpen",value:function(){this.mseReady=!0,this.createBuffer(),"function"==typeof this.options.onReady&&(this.options.onReady(),this.options.onReady=null)}},{key:"onMSEClose",value:function(){this.mseReady=!1,this.videoStarted=!1}},{key:"onBufferError",value:function(t){if("QuotaExceeded"!=t.name){if(this.mediaSource.sourceBuffers.length>0&&this.sourceBuffers[t.type]&&this.mediaSource.removeSourceBuffer(this.sourceBuffers[t.type]),0==this.mediaSource.sourceBuffers.length)try{this.mediaSource.endOfStream()}catch(t){Wt("mediasource is not available to end")}}else this.bufferControllers[t.type].initCleanup(this.node.currentTime)}}]),r}(Xt);function ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var oe=function(t){c()(r,t);var e=ae(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"source",[]),g()(u()(n),"onPlay",void 0),n.source=t.source,n.onPlay=t.onPlay,n.init(),n}return o()(r,[{key:"init",value:function(){}},{key:"extract",value:function(t,e){for(var r=this.provide(e),n=0;n<r.size;n++)t[2*n]=r.left[n],t[2*n+1]=r.right[n];return r.size}},{key:"provide",value:function(t){for(var e=t,r=new Float32Array(e),n=new Float32Array(e),i=0,a=0,o=0;this.source.length>0;){var s=this.source.shift(),u=s.loadedPosition||0;a=s.startTime+s.duration*u/s.length;var l=Math.min(s.length-u,e-i),c=s.getChannelData(0),h=s.numberOfChannels>1?s.getChannelData(1):s.getChannelData(0);if(r.set(c.slice(u,u+l),i),n.set(h.slice(u,u+l),i),o+=l,i+=l,(u+=l)<s.length){s.loadedPosition=u,this.source.unshift(s);break}}return this.onPlay&&this.onPlay(a),{left:r,right:n,size:o}}}]),r}(M);function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function le(t,e,r){return e&&ue(t.prototype,e),r&&ue(t,r),t}function ce(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fe(t,e)}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fe(t,e){return(fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function de(t,e){return!e||"object"!==S()(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pe(t,e,r){return(pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=he(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}var ye=function(){function t(){se(this,t),this._vector=new Float32Array,this._position=0,this._frameCount=0}return le(t,[{key:"clear",value:function(){this.receive(this._frameCount),this.rewind()}},{key:"put",value:function(t){this._frameCount+=t}},{key:"putSamples",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=2*(e=e||0);r>=0||(r=(t.length-n)/2);var i=2*r;this.ensureCapacity(r+this._frameCount);var a=this.endIndex;this.vector.set(t.subarray(n,n+i),a),this._frameCount+=r}},{key:"putBuffer",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=e||0,r>=0||(r=t.frameCount-e),this.putSamples(t.vector,t.position+e,r)}},{key:"receive",value:function(t){t>=0&&!(t>this._frameCount)||(t=this.frameCount),this._frameCount-=t,this._position+=t}},{key:"receiveSamples",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=2*e,n=this.startIndex;t.set(this._vector.subarray(n,n+r)),this.receive(e)}},{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.startIndex+2*e,i=2*r;t.set(this._vector.subarray(n,n+i))}},{key:"ensureCapacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt(2*t);if(this._vector.length<e){var r=new Float32Array(e);r.set(this._vector.subarray(this.startIndex,this.endIndex)),this._vector=r,this._position=0}else this.rewind()}},{key:"ensureAdditionalCapacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.ensureCapacity(this._frameCount+t)}},{key:"rewind",value:function(){this._position>0&&(this._vector.set(this._vector.subarray(this.startIndex,this.endIndex)),this._position=0)}},{key:"vector",get:function(){return this._vector}},{key:"position",get:function(){return this._position}},{key:"startIndex",get:function(){return 2*this._position}},{key:"frameCount",get:function(){return this._frameCount}},{key:"endIndex",get:function(){return 2*(this._position+this._frameCount)}}]),t}(),ge=function(){function t(e){se(this,t),e?(this._inputBuffer=new ye,this._outputBuffer=new ye):this._inputBuffer=this._outputBuffer=null}return le(t,[{key:"clear",value:function(){this._inputBuffer.clear(),this._outputBuffer.clear()}},{key:"inputBuffer",get:function(){return this._inputBuffer},set:function(t){this._inputBuffer=t}},{key:"outputBuffer",get:function(){return this._outputBuffer},set:function(t){this._outputBuffer=t}}]),t}(),ve=function(t){function e(t){var r;return se(this,e),(r=de(this,he(e).call(this,t))).reset(),r._rate=1,r}return ce(e,t),le(e,[{key:"reset",value:function(){this.slopeCount=0,this.prevSampleL=0,this.prevSampleR=0}},{key:"clone",value:function(){var t=new e;return t.rate=this._rate,t}},{key:"process",value:function(){var t=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(t/this._rate+1);var e=this.transpose(t);this._inputBuffer.receive(),this._outputBuffer.put(e)}},{key:"transpose",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===t)return 0;for(var e=this._inputBuffer.vector,r=this._inputBuffer.startIndex,n=this._outputBuffer.vector,i=this._outputBuffer.endIndex,a=0,o=0;this.slopeCount<1;)n[i+2*o]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*e[r],n[i+2*o+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*e[r+1],o+=1,this.slopeCount+=this._rate;if(this.slopeCount-=1,1!==t)t:for(;;){for(;this.slopeCount>1;)if(this.slopeCount-=1,(a+=1)>=t-1)break t;var s=r+2*a;n[i+2*o]=(1-this.slopeCount)*e[s]+this.slopeCount*e[s+2],n[i+2*o+1]=(1-this.slopeCount)*e[s+1]+this.slopeCount*e[s+3],o+=1,this.slopeCount+=this._rate}return this.prevSampleL=e[r+2*t-2],this.prevSampleR=e[r+2*t-1],o}},{key:"rate",set:function(t){this._rate=t}}]),e}(ge),me=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;se(this,t),this._pipe=e,this.inputSize=r}return le(t,[{key:"fillInputBuffer",value:function(){throw new Error("fillInputBuffer() not overridden")}},{key:"fillOutputBuffer",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.inputSize;this.outputBuffer.frameCount<t;){var r=e-this.inputBuffer.frameCount;if(this.fillInputBuffer(r),this.inputBuffer.frameCount<e)break;this._pipe.process()}}},{key:"clear",value:function(){this._pipe.clear()}},{key:"pipe",get:function(){return this._pipe}},{key:"inputBuffer",get:function(){return this._pipe.inputBuffer}},{key:"outputBuffer",get:function(){return this._pipe.outputBuffer}}]),t}(),be=function(){},ke=function(t){function e(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:be;return se(this,e),(n=de(this,he(e).call(this,r,i))).callback=a,n.sourceSound=t,n.historyBufferSize=22050,n._sourcePosition=0,n.outputBufferPosition=0,n._position=0,n}return ce(e,t),le(e,[{key:"onEnd",value:function(){this.callback()}},{key:"fillInputBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new Float32Array(2*t),r=this.sourceSound.extract(e,t,this._sourcePosition);this._sourcePosition+=r,this.inputBuffer.putSamples(e,0,r)}},{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fillOutputBuffer(this.outputBufferPosition+e);var r=Math.min(e,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(t,this.outputBufferPosition,r);var n=this.outputBufferPosition+r;return this.outputBufferPosition=Math.min(this.historyBufferSize,n),this.outputBuffer.receive(Math.max(n-this.historyBufferSize,0)),this._position+=r,r}},{key:"handleSampleData",value:function(t){this.extract(t.data,4096)}},{key:"clear",value:function(){pe(he(e.prototype),"clear",this).call(this),this.outputBufferPosition=0}},{key:"position",get:function(){return this._position},set:function(t){if(t>this._position)throw new RangeError("New position may not be greater than current position");var e=this.outputBufferPosition-(this._position-t);if(e<0)throw new RangeError("New position falls outside of history buffer");this.outputBufferPosition=e,this._position=t}},{key:"sourcePosition",get:function(){return this._sourcePosition},set:function(t){this.clear(),this._sourcePosition=t}}]),e}(me),_e=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],we=function(t){function e(t){var r;return se(this,e),(r=de(this,he(e).call(this,t)))._quickSeek=!0,r.midBufferDirty=!1,r.midBuffer=null,r.overlapLength=0,r.autoSeqSetting=!0,r.autoSeekSetting=!0,r._tempo=1,r.setParameters(44100,0,0,8),r}return ce(e,t),le(e,[{key:"clear",value:function(){pe(he(e.prototype),"clear",this).call(this),this.clearMidBuffer()}},{key:"clearMidBuffer",value:function(){this.midBufferDirty&&(this.midBufferDirty=!1,this.midBuffer=null)}},{key:"setParameters",value:function(t,e,r,n){t>0&&(this.sampleRate=t),n>0&&(this.overlapMs=n),e>0?(this.sequenceMs=e,this.autoSeqSetting=!1):this.autoSeqSetting=!0,r>0?(this.seekWindowMs=r,this.autoSeekSetting=!1):this.autoSeekSetting=!0,this.calculateSequenceParameters(),this.calculateOverlapLength(this.overlapMs),this.tempo=this._tempo}},{key:"calculateOverlapLength",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=(t=this.sampleRate*e/1e3)<16?16:t,t-=t%8,this.overlapLength=t,this.refMidBuffer=new Float32Array(2*this.overlapLength),this.midBuffer=new Float32Array(2*this.overlapLength)}},{key:"checkLimits",value:function(t,e,r){return t<e?e:t>r?r:t}},{key:"calculateSequenceParameters",value:function(){var t,e;this.autoSeqSetting&&(t=150+-50*this._tempo,t=this.checkLimits(t,50,125),this.sequenceMs=Math.floor(t+.5)),this.autoSeekSetting&&(e=25- -10/1.5*.5+-10/1.5*this._tempo,e=this.checkLimits(e,15,25),this.seekWindowMs=Math.floor(e+.5)),this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3),this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)}},{key:"clone",value:function(){var t=new e;return t.tempo=this._tempo,t.setParameters(this.sampleRate,this.sequenceMs,this.seekWindowMs,this.overlapMs),t}},{key:"seekBestOverlapPosition",value:function(){return this._quickSeek?this.seekBestOverlapPositionStereoQuick():this.seekBestOverlapPositionStereo()}},{key:"seekBestOverlapPositionStereo",value:function(){var t,e,r,n=0;for(this.preCalculateCorrelationReferenceStereo(),t=0,e=Number.MIN_VALUE;n<this.seekLength;n+=1)(r=this.calculateCrossCorrelationStereo(2*n,this.refMidBuffer))>e&&(e=r,t=n);return t}},{key:"seekBestOverlapPositionStereoQuick",value:function(){var t,e,r,n,i,a=0;for(this.preCalculateCorrelationReferenceStereo(),e=Number.MIN_VALUE,t=0,n=0,i=0;a<4;a+=1){for(var o=0;_e[a][o]&&!((i=n+_e[a][o])>=this.seekLength);)(r=this.calculateCrossCorrelationStereo(2*i,this.refMidBuffer))>e&&(e=r,t=i),o+=1;n=t}return t}},{key:"preCalculateCorrelationReferenceStereo",value:function(){for(var t,e,r=0;r<this.overlapLength;r+=1)e=r*(this.overlapLength-r),t=2*r,this.refMidBuffer[t]=this.midBuffer[t]*e,this.refMidBuffer[t+1]=this.midBuffer[t+1]*e}},{key:"calculateCrossCorrelationStereo",value:function(t,e){var r=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;for(var n,i=0,a=2,o=2*this.overlapLength;a<o;a+=2)i+=r[n=a+t]*e[a]+r[n+1]*e[a+1];return i}},{key:"overlap",value:function(t){this.overlapStereo(2*t)}},{key:"overlapStereo",value:function(t){var e=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;for(var r,n,i,a,o,s=this._outputBuffer.vector,u=this._outputBuffer.endIndex,l=0,c=1/this.overlapLength;l<this.overlapLength;l+=1)n=(this.overlapLength-l)*c,i=l*c,a=(r=2*l)+t,s[(o=r+u)+0]=e[a+0]*i+this.midBuffer[r+0]*n,s[o+1]=e[a+1]*i+this.midBuffer[r+1]*n}},{key:"process",value:function(){var t,e,r;if(null===this.midBuffer){if(this._inputBuffer.frameCount<this.overlapLength)return;this.midBuffer=new Float32Array(2*this.overlapLength),this._inputBuffer.receiveSamples(this.midBuffer,this.overlapLength)}for(;this._inputBuffer.frameCount>=this.sampleReq;){t=this.seekBestOverlapPosition(),this._outputBuffer.ensureAdditionalCapacity(this.overlapLength),this.overlap(Math.floor(t)),this._outputBuffer.put(this.overlapLength),(e=this.seekWindowLength-2*this.overlapLength)>0&&this._outputBuffer.putBuffer(this._inputBuffer,t+this.overlapLength,e);var n=this._inputBuffer.startIndex+2*(t+this.seekWindowLength-this.overlapLength);this.midBuffer.set(this._inputBuffer.vector.subarray(n,n+2*this.overlapLength)),this.skipFract+=this.nominalSkip,r=Math.floor(this.skipFract),this.skipFract-=r,this._inputBuffer.receive(r)}}},{key:"tempo",set:function(t){var e;this._tempo=t,this.calculateSequenceParameters(),this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength),this.skipFract=0,e=Math.floor(this.nominalSkip+.5),this.sampleReq=Math.max(e+this.overlapLength,this.seekWindowLength)+this.seekLength},get:function(){return this._tempo}},{key:"inputChunkSize",get:function(){return this.sampleReq}},{key:"outputChunkSize",get:function(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)}},{key:"quickSeek",set:function(t){this._quickSeek=t}}]),e}(ge),xe=function(t,e){return(t>e?t-e:e-t)>1e-10},Pe=function(){function t(){se(this,t),this.transposer=new ve(!1),this.stretch=new we(!1),this._inputBuffer=new ye,this._intermediateBuffer=new ye,this._outputBuffer=new ye,this._rate=0,this._tempo=0,this.virtualPitch=1,this.virtualRate=1,this.virtualTempo=1,this.calculateEffectiveRateAndTempo()}return le(t,[{key:"clear",value:function(){this.transposer.clear(),this.stretch.clear()}},{key:"clone",value:function(){var e=new t;return e.rate=this.rate,e.tempo=this.tempo,e}},{key:"calculateEffectiveRateAndTempo",value:function(){var t=this._tempo,e=this._rate;this._tempo=this.virtualTempo/this.virtualPitch,this._rate=this.virtualRate*this.virtualPitch,xe(this._tempo,t)&&(this.stretch.tempo=this._tempo),xe(this._rate,e)&&(this.transposer.rate=this._rate),this._rate>1?this._outputBuffer!=this.transposer.outputBuffer&&(this.stretch.inputBuffer=this._inputBuffer,this.stretch.outputBuffer=this._intermediateBuffer,this.transposer.inputBuffer=this._intermediateBuffer,this.transposer.outputBuffer=this._outputBuffer):this._outputBuffer!=this.stretch.outputBuffer&&(this.transposer.inputBuffer=this._inputBuffer,this.transposer.outputBuffer=this._intermediateBuffer,this.stretch.inputBuffer=this._intermediateBuffer,this.stretch.outputBuffer=this._outputBuffer)}},{key:"process",value:function(){this._rate>1?(this.stretch.process(),this.transposer.process()):(this.transposer.process(),this.stretch.process())}},{key:"rate",get:function(){return this._rate},set:function(t){this.virtualRate=t,this.calculateEffectiveRateAndTempo()}},{key:"rateChange",set:function(t){this._rate=1+.01*t}},{key:"tempo",get:function(){return this._tempo},set:function(t){this.virtualTempo=t,this.calculateEffectiveRateAndTempo()}},{key:"tempoChange",set:function(t){this.tempo=1+.01*t}},{key:"pitch",set:function(t){this.virtualPitch=t,this.calculateEffectiveRateAndTempo()}},{key:"pitchOctaves",set:function(t){this.pitch=Math.exp(.69314718056*t),this.calculateEffectiveRateAndTempo()}},{key:"pitchSemitones",set:function(t){this.pitchOctaves=t/12}},{key:"inputBuffer",get:function(){return this._inputBuffer}},{key:"outputBuffer",get:function(){return this._outputBuffer}}]),t}(),Ee=function(){function t(e){se(this,t),this.buffer=e,this._position=0}return le(t,[{key:"extract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.position=r;for(var n=this.buffer.getChannelData(0),i=this.dualChannel?this.buffer.getChannelData(1):this.buffer.getChannelData(0),a=0;a<e;a++)t[2*a]=n[a+r],t[2*a+1]=i[a+r];return Math.min(e,n.length-r)}},{key:"dualChannel",get:function(){return this.buffer.numberOfChannels>1}},{key:"position",get:function(){return this._position},set:function(t){this._position=t}}]),t}(),Te=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:be,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4096,i=t.createScriptProcessor(n,2,2),a=new Float32Array(2*n);return i.onaudioprocess=function(t){var i=t.outputBuffer.getChannelData(0),o=t.outputBuffer.getChannelData(1),s=e.extract(a,n);r(e.sourcePosition),0===s&&e.onEnd();for(var u=0;u<s;u++)i[u]=a[2*u],o[u]=a[2*u+1]},i},Be=function(t){var e,r,n,i=Math.floor(t/60),a=t-60*i;return"".concat(i,":").concat((e=parseInt(a),n=n||"0",(e+="").length>=(r=2)?e:new Array(r-e.length+1).join(n)+e))},Se=function(t){var e=this.timePlayed,r=this.sampleRate;if(this.sourcePosition=t,this.timePlayed=t/r,e!==this.timePlayed){var n=new CustomEvent("play",{detail:{timePlayed:this.timePlayed,formattedTimePlayed:this.formattedTimePlayed,percentagePlayed:this.percentagePlayed}});this._node.dispatchEvent(n)}};!function(){function t(e,r,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:be;se(this,t),this._soundtouch=new Pe;var o=new Ee(r);this.timePlayed=0,this.sourcePosition=0,this._filter=new ke(o,this._soundtouch,a),this._node=Te(e,this._filter,(function(t){return Se.call(i,t)})),this.tempo=1,this.rate=1,this.duration=r.duration,this.sampleRate=e.sampleRate,this.listeners=[]}le(t,[{key:"connect",value:function(t){this._node.connect(t)}},{key:"disconnect",value:function(){this._node.disconnect()}},{key:"on",value:function(t,e){this.listeners.push({name:t,cb:e}),this._node.addEventListener(t,(function(t){return e(t.detail)}))}},{key:"off",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this.listeners;e&&(r=r.filter((function(t){return t.name===e}))),r.forEach((function(e){t._node.removeEventListener(e.name,(function(t){return e.cb(t.detail)}))}))}},{key:"formattedDuration",get:function(){return Be(this.duration)}},{key:"formattedTimePlayed",get:function(){return Be(this.timePlayed)}},{key:"percentagePlayed",get:function(){return 100*this._filter.sourcePosition/(this.duration*this.sampleRate)},set:function(t){this._filter.sourcePosition=parseInt(t*this.duration*this.sampleRate)}},{key:"node",get:function(){return this._node}},{key:"pitch",set:function(t){this._soundtouch.pitch=t}},{key:"pitchSemitones",set:function(t){this._soundtouch.pitchSemitones=t}},{key:"rate",set:function(t){this._soundtouch.rate=t}},{key:"tempo",set:function(t){this._soundtouch.tempo=t}}])}();function Re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Le=function(t){c()(r,t);var e=Re(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"soundTouch",void 0),g()(u()(n),"filter",void 0),n.init(t.source),n}return o()(r,[{key:"init",value:function(t){this.soundTouch=new Pe,this.soundTouch.tempo=1,this.soundTouch.rate=1,this.filter=new ke(t,this.soundTouch,2048)}},{key:"provide",value:function(t){for(var e=new Float32Array(2*t),r=this.filter.extract(e,t),n=new Float32Array(r),i=new Float32Array(r),a=0;a<r;a++)n[a]=e[2*a],i[a]=e[2*a+1];return{size:r,left:n,right:i}}},{key:"rate",set:function(t){this.soundTouch.tempo=t}}]),r}(M);function De(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ce=function(t){c()(r,t);var e=De(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"currentRate",1),g()(u()(n),"source",[]),g()(u()(n),"commonProcessor",void 0),g()(u()(n),"rateProcessor",void 0),g()(u()(n),"audioTime",0),n.source=t.source,n.init(),n}return o()(r,[{key:"init",value:function(){var t=this;this.commonProcessor=new oe({source:this.source,onPlay:function(e){t.audioTime=e}}),this.rateProcessor=new Le({source:this.commonProcessor})}},{key:"provide",value:function(t){var e=(1===this.currentRate?this.commonProcessor:this.rateProcessor).provide(t);return e.audioTime=this.audioTime,e}},{key:"rate",set:function(t){this.currentRate=t,this.rateProcessor.rate=t}}]),r}(M);function Ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ie="canplaythrough",Oe="seeked",Ue="waiting",Me=function(t){c()(r,t);var e=Ae(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"audioContext",null),g()(u()(n),"scriptNode",null),g()(u()(n),"gainNode",null),g()(u()(n),"delay",0),g()(u()(n),"audioBuffer",new ArrayBuffer(0)),g()(u()(n),"decodedBuffer",[]),g()(u()(n),"isFirstPlay",!0),g()(u()(n),"defaultVolume",1),g()(u()(n),"currentRate",1),g()(u()(n),"eventListeners",{}),g()(u()(n),"canPlay",!1),g()(u()(n),"interval",void 0),g()(u()(n),"seekTimeDelta",0),g()(u()(n),"audioTime",0),g()(u()(n),"audioProvider",void 0),g()(u()(n),"isWaiting",!1),t=Object.assign({},t),n.flushTime=t.flushTime||1e3,n.onReady=t.onReady,n.init(),n}return o()(r,[{key:"init",value:function(){this.audioProvider=new Ce({source:this.decodedBuffer}),"function"==typeof this.onReady&&setTimeout(this.onReady,0)}},{key:"feed",value:function(t){var e=t.audio;this.audioBuffer=this.appendByteArray(this.audioBuffer,e),this.canPlay||(this.canPlay=!0,this.triggerEvent(Ie))}},{key:"appendByteArray",value:function(t,e){var r=new Uint8Array((0|t.byteLength)+(0|e.byteLength));return r.set(new Uint8Array(t),0),r.set(new Uint8Array(e),0|t.byteLength),r.buffer}},{key:"decodeAudioData",value:function(t){var e=this;this.audioBuffer&&this.audioBuffer.byteLength>0&&(this.audioContext.decodeAudioData(this.audioBuffer,(function(r){r.startTime=e.delay,e.delay+=r.duration,e.decodedBuffer.push(r),t&&t.call()}),(function(t){e.logger.error("decodeAudioData",t)})),this.audioBuffer=new ArrayBuffer(0))}},{key:"play",value:function(){var t=this;return new Promise((function(e,r){t.isFirstPlay?(t.isFirstPlay=!1,t.logger.info("startPlay"),t.audioContext=new(window.AudioContext||window.webkitAudioContext),t.gainNode=t.audioContext.createGain(),t.gainNode.gain.value=t.defaultVolume,t.scriptNode=t.audioContext.createScriptProcessor(2048,2,2),t.scriptNode.onaudioprocess=function(e){var r=e.outputBuffer,n=r.length,i=t.audioProvider.provide(n);if(0!==i.size){t.isWaiting&&(t.isWaiting=!1,t.triggerEvent(Ie));var a=r.getChannelData(0),o=r.getChannelData(1);if(0!=i.audioTime&&(t.audioTime=i.audioTime),a.set(i.left),o.set(i.right),i.size<n){var s=new Float32Array(n-i.size);a.set(s,i.size),o.set(s,i.size)}}else t.isWaiting||(t.isWaiting=!0,t.triggerEvent(Ue))},t.scriptNode.connect(t.gainNode),t.gainNode.connect(t.audioContext.destination),t.decodeAudioData.call(t,t.testAutoplay.bind(t,e,r)),t.interval=setInterval(t.decodeAudioData.bind(t),t.flushTime)):"suspended"===t.audioContext.state?t.audioContext.resume().then((function(){t.logger.info("play","Audio is resumed"),e()})):(t.logger.info("Audio resumed from waiting"),e())}))}},{key:"pause",value:function(){var t=this;this.audioContext&&this.audioContext.suspend().then((function(){t.logger.info("pause","Audio is paused")}))}},{key:"addEventListener",value:function(t,e){this.eventListeners[t]=e}},{key:"triggerEvent",value:function(t){var e=this.eventListeners[t];e&&e.call()}},{key:"buffer",value:function(){var t=0;this.decodedBuffer.length>0&&(t=this.decodedBuffer[0].startTime);return{start:1e3*t,end:parseInt(1e3*this.delay)}}},{key:"destroy",value:function(){this.delay=0,this.audioContext&&(clearInterval(this.interval),this.scriptNode.disconnect(),this.scriptNode=null,this.audioContext.close(),this.audioContext=null),this.gainNode=null,this.audioBuffer=new ArrayBuffer(0),this.canPlay=!1,this.isFirstPlay=!0,this.decodedBuffer.length=0,this.seekTimeDelta=0,this.audioTime=0}},{key:"testAutoplay",value:function(t,e){var r=L.createEl("audio"),n=r.play();r=null;var i=!1;void 0!==n?(n.catch((function(){i=!0})),setTimeout((function(){n=null,i?e("Autoplay is prevented"):t()}),100)):e("Promise is undefined")}},{key:"currentTime",get:function(){return this.audioTime},set:function(t){var e=this;for(this.audioTime=t;this.decodedBuffer.length>0;){var r=this.decodedBuffer.shift();if(r.startTime<=t&&r.startTime+r.duration>t){r.loadedPosition=parseInt(r.length*(t-r.startTime)/r.duration),this.decodedBuffer.unshift(r);break}}setTimeout((function(){e.triggerEvent(Oe)}),0)}},{key:"volume",get:function(){return this.gainNode.gain.value},set:function(t){this.gainNode?this.gainNode.gain.value=t:this.defaultVolume=t}},{key:"playbackRate",set:function(t){t!==this.currentRate&&(this.currentRate=t,this.audioProvider.rate=t)}}]),r}(M);function Ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var He=function(t){c()(r,t);var e=Ne(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"need",!0),g()(u()(t),"first",!1),g()(u()(t),"offset",0),g()(u()(t),"currentPTS",0),g()(u()(t),"ready",!1),g()(u()(t),"end",!1),g()(u()(t),"lastData",null),g()(u()(t),"nodeParent",null),g()(u()(t),"useJMuxer",!1),t.player=n.audioNode,t.createAudioMuxer(),t.bindEvent(),t.logger.info("audioDecoder",t.useJMuxer?"JMuxer":"AudioContext"),t}return o()(r,[{key:"bindEvent",value:function(){var t=this;this.bindNodeEvent(),this.events.on(st.PlayerMaxPTS,(function(e){t.currentPTS===e&&(t.end=!0)}))}},{key:"bindNodeEvent",value:function(){var t=this;this.addEventListener("seeked",(function(){t.onSeekedHandler&&t.onSeekedHandler(),t.events.emit("AudioPlayer.seeked")})),this.addEventListener("canplaythrough",(function(){t.logger.info("canplaythrough"),t.ready||(t.ready=!0,t.status="ready",t.logger.info("constructor","canplaythrough","ready"),t.events.emit(st.AudioPlayerDataReady))})),this.addEventListener("waiting",(function(){t.ready=!1,t.end?(t.useJMuxer||t.player.destroy(),t.status="end",t.events.emit(st.AudioPlayerEnd,"audio"),t.logger.info("audioPlayer end")):(t.logger.warn("audioPlayer waiting",t.player.currentTime,t.currentPTS),t.status="waiting",t.events.emit(st.AudioPlayerWait,"audio"))}))}},{key:"reset",value:function(){this.lastData=null,this.first=!1,this.offset=0,this.currentPTS=0,this.ready=!1,this.end=!1,this.clear(),this.createAudioMuxer(),this.bindNodeEvent(),this.stime=null}},{key:"createNode",value:function(){this.player=document.createElement("audio"),this.player.classList.add("goldplay__audio--player"),this.parentNode.appendChild(this.player)}},{key:"createAudioMuxer",value:function(){this.useJMuxer?this.audioDecoder=new ie({node:this.player,mode:"audio",debug:!1,clearBuffer:!0,flushingTime:10,onReady:this.onMSEReady.bind(this)}):(this.audioDecoder=new Me({flushTime:100,onReady:this.onMSEReady.bind(this)}),this.player=this.audioDecoder)}},{key:"onMSEReady",value:function(){this.logger.info("onMSEReady","AudioPlayerReady"),this.events.emit(st.AudioPlayerReady)}},{key:"clear",value:function(){this.audioDecoder.destroy(),this.audioDecoder=null}},{key:"play",value:function(){var t=this;"playing"!==this.status&&(this.status="playing",this.player.play().then((function(){t.events.emit(st.AudioPlayerPlaySuccess)})).catch((function(e){t.logger.error("play","errorInfo:",e),t.events.emit(st.AudioPlayerPlayFail)})))}},{key:"pause",value:function(){"pause"!==this.status&&(this.status="pause",this.player.pause())}},{key:"send",value:function(t){if(!t.PTS)return this.need=!1,void this.events.emit(st.AudioPlayerDataReady);if(this.need=!0,this.audioDecoder){if(this.stime||(this.stime=Date.now()),(t=this.format(t)).audioEnd)return this.logger.info("push","audioEnd"),this.feed(this.lastData),void(this.lastData=null);if(this.first||(this.first=!0,this.offset=t.start),t.PTS>this.currentPTS){if(!this.lastData)return void(this.lastData=t);this.lastData.duration=t.PTS-this.lastData.PTS,this.feed(this.lastData),t.duration=this.lastData.duration,this.lastData=t}}else this.logger.error("send","audioDecoder is:",this.audioDecoder)}},{key:"feed",value:function(t){this.audioDecoder.feed({audio:t.data_byte,duration:t.duration}),this.currentPTS=t.PTS}},{key:"format",value:function(t){return t&&t.data_byte&&(t.start=t.PTS),t}},{key:"addEventListener",value:function(t,e){this.player.addEventListener(t,e)}},{key:"isBuffered",value:function(t){return!this.need||-1!==[this.buffer()].findIndex((function(e){return t>=e.start&&t<e.end}))}},{key:"buffer",value:function(){if(this.useJMuxer){for(var t=this.player.buffered,e=t.length,r={};e>0;)r.start=1e3*t.start(e-1)+this.offset,r.end=1e3*t.end(e-1)+this.offset,e--;return r}var n=this.player.buffer();return{start:n.start+this.offset,end:n.end+this.offset}}},{key:"muted",set:function(t){this.player.muted=!!t}},{key:"playbackRate",set:function(t){this.player.playbackRate=t}},{key:"volume",get:function(){return this.player.volume},set:function(t){this.player.volume=t,this.muted=0===t}},{key:"currentTime",get:function(){return parseInt(1e3*this.player.currentTime+this.offset)},set:function(t){this.player.currentTime=(t-this.offset)/1e3}},{key:"paused",get:function(){return this.player.paused}},{key:"offset",set:function(t){this.offset=t}}]),r}(M),Fe={playerContainer:"goldplay__container",screenContainer:"goldplay__screen--container",screenCanvas:"goldplay__screen--canvas",audioContainer:"goldplay__audio--container",audioPlayer:"goldplay__audio--player",controlContainer:"goldplay__control--container",containerFullPage:"goldplay__container-fullpage",containerFullScreen:"goldplay__container-fullscreen",controlContainerFloat:"goldplay__control--container-float",bigPlayButton:"goldplay__screen--bigplay",poster:"goldplay__screen--poster",nearside:"goldplay__control--nearside",sidebar:"goldplay__control--sidebar",buttonBlock:"goldplay__control--button-block",playButton:"goldplay__control--play",pauseButton:"goldplay__control--pause",replayButton:"goldplay__control--replay",speedBar:"goldplay__speed-bar",speedBarBox:"goldplay__speed-bar--box",rateBar:"goldplay__rate-bar",rateBarBox:"goldplay__rate-bar--box",fullPage:"goldplay__control--fullpage",fullScreen:"goldplay__control--fullscreen",waitingBar:"goldplay__waiting-bar",progressBar:"goldplay__progress-bar",progressBarHover:"goldplay__progress-bar-hover",progressBarPlay:"goldplay__progressbar--play",progressBarPlayHover:"goldplay__progressbar--play-hover",progressBarLoad:"goldplay__progressbar--load",progressBarLoadHover:"goldplay__progressbar--load-hover",progressBarDot:"goldplay__progressbar--dot",progressBarDotHover:"goldplay__progressbar--dot-hover",volumeBar:"goldplay__volume-bar",volumeBarAudio:"goldplay__volume-bar--audio",volumeBarAudioOn:"goldplay__volume-bar--audio-on",volumeBarAudioOff:"goldplay__volume-bar--audio-off",volumeBarHandle:"goldplay__volume-bar--handle",volumeBarRod:"goldplay__volume-bar--rod",volumeBarRodHover:"goldplay__volume-bar--rod-hover",volumeBarSize:"goldplay__volume-bar--size",volumeBarColumn:"goldplay__volume-bar--column",alertBox:"goldplay__alter-box",alertClose:"goldplay__alter--close"};function je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var $e=Fe,We=function(){function t(){i()(this,t)}return o()(t,null,[{key:"createContainer",value:function(t){var e=function(t){c()(r,t);var e=je(r);function r(){return i()(this,r),e.apply(this,arguments)}return r}(Z()(HTMLDivElement));customElements.get("gp-container")||customElements.define("gp-container",e,{extends:"div"});var r=L.createEl("gp-container","div");return r.className=$e.playerContainer,r.style.width=(t.options.width?t.options.width:t.el.offsetWidth)+"px",r.style.height=(t.options.height?t.options.height:t.el.offsetHeight)+"px",r}},{key:"createScreenContainer",value:function(t){var e=t.$container,r=function(t){c()(r,t);var e=je(r);function r(){return i()(this,r),e.apply(this,arguments)}return r}(Z()(HTMLDivElement));customElements.get("gp-screen")||customElements.define("gp-screen",r,{extends:"div"});var n,a=L.createEl("gp-screen","div");return a.classList.add($e.screenContainer),n=t.controlBarAutoHide||!1===t.controlBar?e.offsetHeight:e.offsetHeight-t.controlBarHeight,a.style.height=n+"px",a}},{key:"createAudioContainer",value:function(){var t=L.createEl("gp-audio");return t.classList.add($e.audioContainer),t.style.display="none",t}},{key:"createAudio",value:function(){var t=L.createEl("audio");return t.classList.add($e.audioPlayer),t.controls=!0,t}},{key:"clearCavans",value:function(t){var e=t.getContext("webgl");e.clear(e.COLOR_BUFFER_BIT)}}]),t}();g()(We,"createCanvas",(function(t){var e=L.createEl("canvas");return e.style.display="none",e.classList.add($e.screenCanvas),e.width=t.options.screenWidth||t.screenWidth,e.height=t.options.screenHeight||t.screenHeight,e}));var Ve=_.a.get("Template.js"),ze=function(){function t(){i()(this,t)}return o()(t,null,[{key:"mergeVar",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t||""===t)return t;try{var r=new RegExp("\\${'?\"?\\s*([.:a-z0-9_s]+?)\\s*'?\"?}","ig");return t.replace(r,(function(t,r){r=r.trim();var n=e[r];return n=(n=void 0===(n=null===n?"":n)?"":n)||""}))}catch(e){return Ve.error("mergeVar","replace variable","error:",e),t}}},{key:"makeValue",value:function(e,r,n){if("string"!=typeof r&&"function"!=typeof r)return r;if("function"==typeof r&&(r=r.call(this,this.data)),!n)return t.escapeHTML.call(this,r);var i,a=function(e){var r="";return e&&(r=" ".concat(t.slotReplaceName,'="true"')),'<gp-slot style="display:none"'.concat(r,"></gp-slot>")};if(t.isSoltType(n)){if("function"!=typeof this.getComponent)return Ve.error("makeValue","the object is not support slot mode.",this.getComponent,r),r;switch(n){case t.slotTypeMap.component:i=r;var o=this.getComponent(i);"object"===S()(o)&&o.element?(o.element.setAttribute(t.slotReplaceName,"true"),r=o.element.outerHTML):r=a(i);break;case t.slotTypeMap.html:r=t.mergeVar.call(this,r,this.data)}var s="";void 0!==i&&(s=" ".concat(t.slotComName,'="').concat(i,'" '));var u="$1 "+t.slotTypeName+'="'+n+'" '+t.slotKeyName+'="'+e+'"'+s+"$2";return"string"==typeof r&&(r=(r=""===r?a():r).replace(/^\s*(<\s?[\w-]*)(.*[\r|\n|>])/,u)),r}if("string"==typeof n){var l=Ye[n];return"function"==typeof l&&(r=l.call(this,r)),r}return t.escapeHTML.call(this,r)}},{key:"escapeHTML",value:function(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"generate",value:function(e,r,n){var i=this,a=n[n.length-1]||{},o=[e[0]];return r.forEach((function(r,s){if(r){var u,l,c=r.split(t.pipSeparator);c.length>1&&(r=c[0],l=c[1]),u=Number.isInteger(r)?n[r]:a[r],void 0!==(u=t.makeValue.bind(i)(r,u,l))&&o.push(u),void 0!==e[s+1]&&o.push(e[s+1])}})),o.join("")}},{key:"create",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a;a=Array.isArray(e)?"array":"function"==typeof e?"function":"string";var o=this;if("object"===S()(o)||"function"==typeof o)if(void 0!==e&&""!==e)switch(void 0!==o.data&&null!==o.data||(Ve.info("create","this object.data is undefined or null",o),o.data={}),a){case"array":return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=i[i.length-1]||{};"object"===S()(o)&&(o.__template__={tplObj:e,keys:n,dict:s});var u=t.generate.bind(o);return u(e,n,i)};case"function":var s=t.create.bind(o);return e.call(o,o.data,s,o);default:return function(r){return r=void 0!==r?r:o.data,t.mergeVar(e,r)}}else Ve.error("create","have not give tplObj parameter.",e);else Ve.error("create","this is not an object.",o)}},{key:"isSoltType",value:function(e){return e=String(e).toLowerCase(),t.slotTypeMap[e]}}]),t}();ze.pipSeparator="|",ze.slotTypeName="gp-slot-type",ze.slotKeyName="gp-slot-key",ze.slotComName="gp-slot-com",ze.slotReplaceName="gp-slot-replace",ze.slotTypeMap={html:"html",component:"component"};var Ye={trim:function(t){return t.trim()},upperCase:function(t){return t.toUpperCase()},lowerCase:function(t){return t.toLowerCase()}},Xe=ze,Ge=r(18),qe=r.n(Ge),Qe=r(28),Ke=r.n(Qe),Je=_.a.get("Observer.js"),Ze=function(){function t(e){i()(this,t),g()(this,"object",null),this.setObject(e)}var e;return o()(t,[{key:"setObject",value:function(t){this.object=t}},{key:"watch",value:(e=Ke()(qe.a.mark((function t(e,r,n){var i;return qe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"==typeof(i=this.object).watch){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,i.watch(e,r,n);case 5:!1!==t.sent&&"function"==typeof i.render&&i.render(e,r,n),"function"==typeof i.afterWatch&&i.afterWatch(e,r,n);case 8:case"end":return t.stop()}}),t,this)}))),function(t,r,n){return e.apply(this,arguments)})},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,n=e.set,i=e.get;t=t||r.data;var a=r.object,o={set:function(t,e,i){return"function"==typeof n?n.call(r,t,e,i):(t[e]!==i&&(t[e]=i,a.__template__&&Object.prototype.hasOwnProperty.call(a.__template__.dict,e)&&r.watch(t,e,i)),!0)},get:function(t,e){return"function"==typeof i?i.call(r,t,e):"object"===S()(t[e])&&null!==t[e]?new Proxy(t[e],o):Reflect.get(t,e)}};return new Proxy(t,o)}}]),t}(),tr=function(t){return"object"!==S()(t)&&Je.error("observer","this is not an object."),new Ze(t)};function er(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return rr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rr(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function ir(t){if(t){var e=[],r=[];for(r.push(t);r.length;){var n=r.shift(),i=n.getAttribute(Xe.slotTypeName);if(!Xe.isSoltType(i)){e.push(n);for(var a=n.children,o=0,s=a.length;o<s;o++)r.push(a[o])}}return e}}var ar=function(t){return t.getAttribute&&t.getAttribute(Xe.slotTypeName)===Xe.slotTypeMap.html},or=function(t,e){return!(!(r=t).getAttribute||r.getAttribute(Xe.slotTypeName)!==Xe.slotTypeMap.component||t.getAttribute(Xe.slotComName)===e.getAttribute(Xe.slotComName));var r},sr=function(t,e,r){var n;(t||e)&&(!t&&e?r.appendChild(e):!e&&t?r.removeChild(t):t.tagName!==e.tagName||(n=e,ar(t)&&ar(n))||or(t,e)?t.replaceWith(e.cloneNode(!0)):t.nodeType===Node.TEXT_NODE&&t.nodeValue!==e.nodeValue?t.nodeValue=e.nodeValue:t.setAttribute&&L.setAttributes(t,e))},ur=function(t){c()(r,t);var e=nr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"createTemplate",null),g()(u()(t),"template",""),g()(u()(t),"element",null),g()(u()(t),"eventsList",{}),g()(u()(t),"data",{}),g()(u()(t),"id",""),t.id=n.id||t.constructor.name,t.options=n,t.createTemplate=Xe.create.bind(u()(t)),t}return o()(r,[{key:"getTemplate",value:function(){return this.template}},{key:"setTemplate",value:function(t){this.template=t}},{key:"init",value:function(){this.data=tr(this).create(this.data),this.render(),"function"==typeof this.afterInit&&this.afterInit()}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){}},{key:"watch",value:function(){}},{key:"render",value:function(){var t="";t="function"==typeof this.template?this.template(this.data):this.template;var e=L.createEl("div");if("string"==typeof t){e.innerHTML=t;var r,n=e.firstElementChild,i=er(n.querySelectorAll("["+Xe.slotReplaceName+"]"));try{for(i.s();!(r=i.n()).done;){var a=r.value;if("true"===a.getAttribute(Xe.slotReplaceName)){var o=a.getAttribute(Xe.slotComName),s=this.getComponent(o);if(!s)continue;var u=s.element;L.isElement(this.element)?a.replaceWith(u.cloneNode(!0)):a.replaceWith(u),s.element.removeAttribute(Xe.slotReplaceName)}}}catch(t){i.e(t)}finally{i.f()}L.isElement(this.element)?this.replaceNode(this.element,n):this.element=n}else this.logger.error("render:","this template is not html string","html:",t)}},{key:"replaceNode",value:function(t,e){if(t&&e){var r=ir(t),n=ir(e),i=r.length,a=n.length,o=Math.max(i,a);if(o<=0||t.tagName!==e.tagName)return t.replaceWith(e),void(this.element=e);for(;o--;){var s=r[o],u=n[o];if(s)if(u){if(s.tagName===u.tagName&&L.syncAttributes(s,u),!s.isEqualNode(u)){var l=Math.max(s.childNodes.length,u.childNodes.length);if(l<=0)sr(s,u,s.parentNode);else for(var c=0,h=l;c<h;c++){var f=s.childNodes[c],d=u.childNodes[c];(f||d)&&sr(f,d,s)}}}else s.parentNode.removeChild(s);else t.appendChild(u)}}}},{key:"show",value:function(){this.data.display="show",this.element&&(this.element.style.display="inline-block")}},{key:"hide",value:function(){this.data.display="hide",this.element&&(this.element.style.display="none")}},{key:"resetPosition",value:function(){var t=this.element.parentNode,e=t.offsetWidth,r=t.offsetHeight;this.element.style.marginTop=(r-this.element.offsetHeight)/2+"px",this.element.style.marginLeft=(e-this.element.offsetWidth)/2+"px"}},{key:"replace",value:function(t){this.element.replaceWith(t),this.element=t}},{key:"update",value:function(t){this.element.innerHTML=t}},{key:"addEventListener",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.addEventListener(e,r,n),{destroy:function(){t.removeEventListener(e,r)}}}},{key:"removeEventListenerAll",value:function(){var t=this;Object.keys(this.eventsList).forEach((function(e){t.eventsList[e].destroy()}))}},{key:"getComponent",value:function(t){if(void 0!==t)return this.options.componentsController?this.options.componentsController.getComponent(t):void 0}},{key:"getHTMLString",value:function(){return this.element.outerHTML}},{key:"destroy",value:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.events.emit("Component_"+this.id+".destroy",this),this.removeEventListenerAll()}}]),r}(M),lr=r(8),cr=r.n(lr),hr={formatHHMMSS:function(t){var e=parseInt(t,10),r=Math.floor(e/3600),n=Math.floor((e-3600*r)/60),i=e-3600*r-60*n;r<10&&(r="0"+r),n<10&&(n="0"+n),i<10&&(i="0"+i);var a="";return"00"!==r&&(a=r+":"),a+n+":"+i}},fr={formatBytes:function(t,e){if(0==t)return"0 Bytes";var r=e<=0?0:e||2,n=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,n)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}};function dr(){var t=cr()(['\n  <gp-poster class="goldplay__screen--poster">\n  <img src="','" width="','" data-display="','" heigth="','" class="goldplay__screen--poster-image">\n  <gp-speed class="goldplay__screen--poster-speed">',"</gp-speed>\n  </gp-poster>\n  "]);return dr=function(){return t},t}function pr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var yr=function(t){c()(r,t);var e=pr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(dr(),"poster","width","display","height","speed")),g()(u()(t),"data",{poster:"",status:"",display:"show",speed:"",width:"",height:""}),g()(u()(t),"options",{}),t.options=n,n.player.poster&&(t.data.poster=n.player.poster),Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"resetPosition",value:function(){if(this.element){var t=this.element.parentNode.offsetWidth,e=this.element.parentNode.offsetHeight;this.element.style.width=t+"px",this.element.style.marginTop=(e-this.element.offsetHeight-20)/2+"px"}}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderUpdateSpeed,(function(e){"show"===t.data.display&&(t.data.speed=fr.formatBytes(e.speed)+" /s")}))}},{key:"hide",value:function(){"hide"!==this.data.display&&(this.element.style.opacity=0,this.element.style.display="none",this.data.display="hide")}}]),r}(ur);function gr(){var t=cr()(['\n    <gp-control class="goldplay__control--container ','" style="width:',"px;height:","px;opacity:",'" data-status="','">\n      ',"\n      ","\n      ","\n    </gp-control>\n  "]);return gr=function(){return t},t}function vr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var mr=function(t){c()(r,t);var e=vr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(gr(),"containerFloatCss","width","height","opacity","status","progressBarName|component","sideControlBarName|component","nearControlBarName|component")),g()(u()(t),"hideDelayTime",void 0),g()(u()(t),"hideTimeCount",void 0),g()(u()(t),"data",{progressBarName:"progressBar",sideControlBarName:"sideControlBar",nearControlBarName:"nearControlBar",width:"",height:"",opacity:1,containerFloatCss:"",display:"show",status:""}),g()(u()(t),"options",{}),t.options=n,t.hideDelayTime=t.options.player.controlBarAutoHideTime||3,n.player.controlBarAutoHide&&(t.data.containerFloatCss=t.options.cssName.controlContainerFloat,t.resetPosition()),Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"initProps",value:function(){this.hideTimeCount=this.hideDelayTime}},{key:"bindEvent",value:function(){var t=this,e=this.options;e.player.controlBarAutoHide&&(e.$container.addEventListener("mousemove",(function(){t.hideTimeCount<=0&&(t.data.display="show",t.show()),t.hideTimeCount=t.hideDelayTime})),setInterval((function(){t.hideTimeCount>0?t.hideTimeCount-=1:"hide"!==t.data.display&&(t.data.display="hide",t.hide())}),100))}},{key:"setSize",value:function(t,e){void 0!==t&&(this.data.width=t),void 0!==e&&(this.data.height=e)}},{key:"show",value:function(){var t,e=this;this.options.player.controlBarAutoHide?(clearTimeout(t),t=setTimeout((function(){e.data.opacity=1}),1)):this.data.opacity=1}},{key:"hide",value:function(){this.data.opacity=0}},{key:"resetPosition",value:function(){this.setSize(this.options.$container.offsetWidth,this.options.player.controlBarHeight)}}]),r}(ur),br=_.a.get("Delegator.js");function kr(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:"object"===S()(t)&&(1===t.nodeType&&"string"==typeof t.nodeName)}function _r(t){t.preventDefault(),t.stopPropagation()}function wr(t,e,r,n,i){var a=function(t,e){if(t&&t.matches){if(!Array.isArray(e))return t.matches(e);for(var r=0,n=e.length;r<n;r++)if(t.matches(e[r]))return!0}return!1};function o(t){for(var e=(t=t||window.event).target||t.srcElement,i=t.currentTarget,o=!0;o&&e!==i&&e;){if(a(e,r)&&(o=!1!==n.call(e,t)),!o)return void _r(t);e=e.parentNode}}n.__delegateWrapper=o,function(t,e,r,n){void 0===n&&(n="blur"===e||"focus"===e),kr(t)&&t.addEventListener(e,r,n)}(t,e,o,i)}var xr=function(){function t(e){return i()(this,t),g()(this,"element",null),kr(e)?this.element=e:br.error("constructor","new instance","element:",this.element),this}return o()(t,[{key:"off",value:function(t,e,r){return e.__delegateWrapper&&delete(e=e.__delegateWrapper).__delegateWrapper,this.element.removeEventListener(t,e,r),this}},{key:"on",value:function(t,e,r,n){var i=this;return Array.isArray(e)?e.forEach((function(e){wr(i.element,t,e,r,n)})):wr(this.element,t,e,r,n),this}},{key:"once",value:function(t,e,r,n){return this.on(t,e,r,{capture:n,once:!0}),this}}]),t}(),Pr=null,Er=function(t){return"string"==typeof t&&(t=document.querySelector(t)),Pr?Pr.element=t:Pr=new xr(t),Pr},Tr=function(){function t(e,r){var n=r.$container,a=r.type,o=r.scope,s=r.onStart,u=r.onDrag,l=r.onRelease;i()(this,t),g()(this,"$container",null),g()(this,"$ele",null),g()(this,"active",!1),g()(this,"offsetX",0),g()(this,"offsetY",0),g()(this,"offsetLeft",0),g()(this,"offsetTop",0),g()(this,"orginOffsetLeft",0),g()(this,"orginOffsetTop",0),g()(this,"orginOffsetWidth",0),g()(this,"orginOffsetHeight",0),g()(this,"initialX",0),g()(this,"initialY",0),g()(this,"type","default"),g()(this,"scope",{}),this.$container=n||document.body,this.$ele=e,this.type=a,this.scope=o,this.eventsList={},this.onStart=s,this.onDrag=u,this.onRelease=l,this.bindEvent()}return o()(t,[{key:"addEventListener",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.addEventListener(e,r,n),{destroy:function(){t.removeEventListener(e,r)}}}},{key:"removeEventListenerAll",value:function(){var t=this;Object.keys(this.eventsList).forEach((function(e){t.eventsList[e].destroy()}))}},{key:"bindEvent",value:function(){var t=this;this.eventsList.mousedown=this.addEventListener(this.$container,"mousedown",(function(e){t.start(e)}),!1),this.eventsList.mouseup=this.addEventListener(this.$container,"mouseup",(function(e){t.release(e)}),!1),this.eventsList.mousemove=this.addEventListener(this.$container,"mousemove",(function(e){t.drag(e)}),!1)}},{key:"start",value:function(t){t.target===this.$ele&&(void 0===this.scope&&void 0!==this.$container&&(this.scope={left:this.$container.offsetLeft,right:this.$container.offsetLeft+this.$container.offsetWidth,top:this.$container.offsetTop,bottom:this.$container.offsetTop+this.$container.offsetHeight}),this.offsetLeft=this.$ele.offsetLeft,this.offsetTop=this.$ele.offsetTop,this.active=!0,this.initialX=t.clientX,this.initialY=t.clientY,this.orginOffsetLeft=this.$ele.offsetLeft,this.orginOffsetTop=this.$ele.offsetTop,this.orginOffsetWidth=this.$ele.offsetWidth,this.orginOffsetHeight=this.$ele.offsetHeight,"function"==typeof this.onStart&&this.onStart.call(this,this.offsetX,this.offsetY,t,this))}},{key:"release",value:function(t){this.active=!1,"function"==typeof this.onRelease&&this.onRelease.call(this,this.offsetX,this.offsetY,t,this)}},{key:"drag",value:function(t){this.active&&(t.preventDefault(),t.stopPropagation(),this.offsetX=t.clientX-this.initialX+this.offsetLeft,this.offsetY=t.clientY-this.initialY+this.offsetTop,this.setPosition(t))}},{key:"setPosition",value:function(t){switch(this.type){case"vertical":this.offsetX=this.orginOffsetLeft,this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight);break;case"level":this.offsetY=this.orginOffsetTop,this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),this.offsetX<this.scope.left&&(this.offsetX=this.scope.left);break;default:isNaN(this.scope.right)||this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),isNaN(this.scope.left)||this.offsetX<this.scope.left&&(this.offsetX=this.scope.left),isNaN(this.scope.top)||this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),isNaN(this.scope.bottom)||this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight)}this.$ele.style.left=this.offsetX+"px",this.$ele.style.top=this.offsetY+"px","function"==typeof this.onDrag&&this.onDrag.call(this,this.offsetX,this.offsetY,t,this)}},{key:"destroy",value:function(){this.$ele.parentNode.removeChild(this.$ele),this.removeEventListenerAll()}}]),t}(),Br=function(t,e){return new Tr(t,e)};function Sr(){var t=cr()(['\n    <gp-control-progressbar class="goldplay__progress-bar ','" data-status="','">\n      <div class="goldplay__progressbar--load ','">\n      </div>\n      <div class="goldplay__progressbar--play ','">\n      </div>\n      <span class="goldplay__progressbar--dot ','" title="','"></span>\n    </gp-control-progressbar>\n  ']);return Sr=function(){return t},t}function Rr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Lr=function(t){c()(r,t);var e=Rr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Sr(),"progressBarHoverCss","status","progressBarLoadHoverCss","progressBarPlayHoverCss","progressBarDotHoverCss","time")),g()(u()(t),"options",{}),g()(u()(t),"data",{playWidth:"",dot:"",time:"",status:""}),g()(u()(t),"setProgressBarSize",(function(e){t.$progressBarPlay.style.width=e+"px"})),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){var t=this.options.cssName;"dragstart"===this.data.status?(this.data.progressBarHoverCss=t.progressBarHover,this.data.progressBarLoadHoverCss=t.progressBarLoadHover,this.data.progressBarPlayHoverCss=t.progressBarPlayHover,this.data.progressBarDotHoverCss=t.progressBarDotHover):"dragend"===this.data.status&&(this.data.progressBarHoverCss="",this.data.progressBarLoadHoverCss="",this.data.progressBarPlayHoverCss="",this.data.progressBarDotHoverCss="")}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){var t=this.element,e=this.options.cssName;this.$progressDragDot=t.querySelector("."+e.progressBarDot),this.$progressBarPlay=t.querySelector("."+e.progressBarPlay),this.$progressBarLoad=t.querySelector("."+e.progressBarLoad),this.timer=this.getComponent("timer"),this.pauseButton=this.getComponent("pauseButton")}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,r=!1;this.events.on(st.PlayerTimeUpdate,(function(e){var n=t.options.loadData.sourceData.duration;if(!r&&e&&n){var i=e/1e3/n*t.progressBarWidth;t.setProgressPosition(i),t.timer.data.time=hr.formatHHMMSS(e/1e3)}})),this.events.on(st.PlayerbufferUpdate,(function(e){!r&&e&&t.updateProgressLoad(e)})),Er(this.options.$controlBarContainer).on("click","."+e.progressBar,(function(r){if(r.target!==t.$progressDragDot){var n=(t.options.loadData.sourceData.duration||0)/t.progressBarWidth,i=0;r.target.classList.contains(e.progressBarLoad)&&(i=r.target.offsetLeft-r.target.parentNode.offsetLeft);var a=i+r.offsetX,o=a*n*1e3;return t.setProgressPosition(a),t.logger.info("bindEvent","click to seek","seekTime:",o,"offsetX:",a),r.target!==t.$progressBarLoad&&t.clearLoadBar(r.offsetX),t.timer.data.time=hr.formatHHMMSS(o/1e3),t.events.emit(st.PlayerOnSeek,o),!1}})),this.progressDragEvent=Br(this.$progressDragDot,{$container:document.body,type:"level",scope:{left:this.progressBarLeft,right:this.progressBarLeft+this.progressBarWidth,top:this.$progressDragDot.offsetTop,bottom:this.$progressDragDot.offsetTop+this.$progressDragDot.offsetHeight},onStart:function(){r=!0,t.data.status="dragstart"},onDrag:function(e){var r;r=t.options.player.controlBarAutoHide?e:e-t.options.$controlBarContainer.offsetLeft;var n=0,i=t.$progressDragDot.offsetWidth;t.progressBarWidth-r<=i&&(n=i),t.setProgressBarSize(r),t.data.status="draging";var a=t.getSeekTime(t.progressBarWidth-n);t.timer.data.time=hr.formatHHMMSS(a/1e3),t.data.time=t.timer.data.time},onRelease:function(e,n,i){if(r){var a=t.getSeekTime();i.target!==t.$progressBarLoad&&t.clearLoadBar(e),t.events.emit(st.PlayerOnSeek,a),t.logger.info("bindEvent","onDrag release seek","seekTime:",a),t.data.status="dragend",r=!1}}})}},{key:"setProgressPosition",value:function(t){var e=Math.min(t,this.progressBarWidth),r=this.$progressDragDot,n=this.progressBarWidth,i=0,a=r.offsetWidth/2;e>n||n-e<=a?i=a-(n-e):e<=a&&(i=-(a-e));var o=e-i-r.offsetWidth/2;this.setProgressPlayWidth(e),this.setProgressDragDotLeft(o+this.progressBarLeft)}},{key:"setProgressPlayWidth",value:function(t){this.$progressBarPlay.style.width=t+"px"}},{key:"setProgressDragDotLeft",value:function(t){this.$progressDragDot.style.left=t+"px"}},{key:"getProgressPlayLeftWidth",value:function(){return{offsetLeft:this.$progressBarPlay.offsetLeft,offsetWidth:this.$progressBarPlay.offsetWidth}}},{key:"getProgressLoadLeftWidth",value:function(){return{offsetLeft:this.$progressBarLoad.offsetLeft,offsetWidth:this.$progressBarLoad.offsetWidth}}},{key:"setProgressLoadLeftWidth",value:function(t,e){var r=this.progressBarLeft+this.progressBarWidth;(t=Math.min(t,r))+e>r&&(e=r-t),this.$progressBarLoad.style.left=t+"px",this.$progressBarLoad.style.width=e+"px"}},{key:"updateProgressLoad",value:function(t){var e=this.options.loadData.sourceData.duration;if(e){var r=this.progressBarWidth,n=this.progressBarLeft,i=t[0]/1e3/e*r,a=t[1]/1e3/e*r,o=Math.floor(n+i),s=Math.floor(a-i);this.setProgressLoadLeftWidth(o,s)}}},{key:"getSeekTime",value:function(t,e){var r=this.progressBarWidth,n=(e=e||this.options.loadData.sourceData.duration||0)/(t||r);return this.$progressBarPlay.offsetWidth*n*1e3}},{key:"clearLoadBar",value:function(t){t<this.$progressBarLoad.offsetLeft-this.progressBarLeft&&(this.$progressBarLoad.style.width="0px")}},{key:"getDragDotPosition",value:function(){return{offsetLeft:this.$progressDragDot.offsetLeft,offsetTop:this.$progressDragDot.offsetTop,left:this.$progressDragDot.style.left,top:this.$progressDragDot.style.top}}},{key:"clearDragDotTop",value:function(){this.$progressDragDot.style.top=""}},{key:"progressBarWidth",get:function(){return this.element.offsetWidth}},{key:"progressBarLeft",get:function(){return this.element.offsetLeft}}]),r}(ur);function Dr(){var t=cr()(['\n  <gp-button class="goldplay__control--play" data-status="','" title="','">\n  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n  viewBox="0 0 232.153 232.153" width="20" height="20" style="enable-background:new 0 0 232.153 232.153;" xml:space="preserve">\n  <g >\n  <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M203.791,99.628L49.307,2.294c-4.567-2.719-10.238-2.266-14.521-2.266\n    c-17.132,0-17.056,13.227-17.056,16.578v198.94c0,2.833-0.075,16.579,17.056,16.579c4.283,0,9.955,0.451,14.521-2.267\n    l154.483-97.333c12.68-7.545,10.489-16.449,10.489-16.449S216.471,107.172,203.791,99.628z" fill="#f1f1f1"/>\n  </g>\n  </svg>\n  </gp-button>\n  ']);return Dr=function(){return t},t}function Cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ar=function(t){c()(r,t);var e=Cr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Dr(),"status","title")),g()(u()(t),"data",{title:"play",play:">"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return r}(ur);function Ir(){var t=cr()(['\n  <gp-button class="goldplay__control--pause" title="','" status="','">\n  ',"\n  </gp-button>\n  "]);return Ir=function(){return t},t}function Or(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function Ur(){var t=cr()(['\n<svg style="display:','" class="goldplay__control--pausing" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 26 26" style="background:none" xml:space="preserve">\n<g>\n<path d="M2.667,0h6v26h-6V0z M15.333,0v26h6V0H15.333z" fill="#f1f1f1"/>\n</g>\n</svg>\n']);return Ur=function(){return t},t}var Mr=Xe.create(Ur(),"pauseHide"),Nr=function(t){c()(r,t);var e=Or(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate((function(t,e){return e(Ir(),"title","status","icon|html")}))),g()(u()(t),"data",{title:"pause",pauseHide:"",pauseLoadingHide:"none",icon:Mr,status:"",display:""}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){"pauseloading"===this.data.status?(this.data.pauseHide="none",this.data.pauseLoadingHide="inline-block",this.data.title="loading",this.data.icon='\n<svg version="1.1" class="goldplay__control--pause-loading" style="display:${\'pauseLoadingHide\'}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="25px" viewBox="0 0 612 792" style="background:none;margin: -4px 0 0 -5px;" xml:space="preserve">\n<linearGradient id="goldplay-pause-loading-gradient" gradientUnits="userSpaceOnUse" x1="1.98" y1="784.6123" x2="26.2101" y2="770.623" gradientTransform="matrix(21.8571 0 0 21.8571 -2.0895 -16600.5293)">\n    <stop offset="0.1682" style="stop-color:#f1f1f1;stop-opacity:0"></stop>\n    <stop offset="0.7502" style="stop-color:#f1f1f1"></stop>\n    <stop offset="1" style="stop-color:#f1f1f1"></stop>\n</linearGradient>\n<path style="transform-origin: center center;animation: goldplay-rotate-360 .8s linear infinite;" fill="url(#goldplay-pause-loading-gradient)" d="M306,133.714c144.257,0,262.286,118.028,262.286,262.286c0,144.257-118.029,262.286-262.286,262.286\n  C161.743,658.286,43.714,540.257,43.714,396C43.714,251.743,161.743,133.714,306,133.714 M306,90C137.7,90,0,227.7,0,396\n  s137.7,306,306,306s306-137.7,306-306S474.3,90,306,90L306,90z">\n    <animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0" to="360" dur=".8s" repeatCount="indefinite" />\n</path>\n<g>\n    <g>\n        <path fill="#f1f1f1" d="M229.5,514.028L229.5,514.028c-13.114,0-21.857-8.742-21.857-21.856V295.457\n        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.715\n        C251.357,503.1,242.614,514.028,229.5,514.028z"></path>\n        <path fill="#f1f1f1" d="M229.5,273.6c-13.114,0-21.857,8.743-21.857,21.857v196.715c0,10.928,8.743,21.856,21.857,21.856\n        s21.857-10.929,21.857-21.856V295.457C251.357,282.343,242.614,273.6,229.5,273.6L229.5,273.6z"></path>\n    </g>\n    <g>\n        <path fill="#f1f1f1" d="M382.5,518.4L382.5,518.4c-13.114,0-21.857-8.743-21.857-21.857V299.829\n        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.714\n        C404.357,509.657,395.614,518.4,382.5,518.4z"></path>\n        <path fill="#f1f1f1" d="M382.5,277.972c-10.929,0-21.857,8.743-21.857,21.857v196.714c0,10.929,10.929,21.857,21.857,21.857\n        s21.857-10.929,21.857-21.857V299.829C404.357,288.9,393.429,277.972,382.5,277.972L382.5,277.972z"></path>\n    </g>\n</g>\n</svg>\n'):"pause"===this.data.status&&(this.data.pauseHide="inline-block",this.data.pauseLoadingHide="none",this.data.title="pause",this.data.icon=Mr)}}]),r}(ur);function Hr(){var t=cr()(['\n  <gp-button class="goldplay__control--replay" title="','" data-display="','">\n  <svg version="1.0" xmlns="http://www.w3.org/2000/svg"\n  width="24px" height="24px" viewBox="0 0 245.000000 206.000000"\n  preserveAspectRatio="xMidYMid meet">\n <g transform="translate(0.000000,206.000000) scale(0.100000,-0.100000)"\n fill="#f1f1f1" stroke="1">\n <path d="M1250 2046 c-286 -55 -525 -211 -681 -445 -91 -136 -152 -302 -167\n -453 -12 -119 3 -108 -143 -109 -70 -1 -156 -4 -192 -8 l-65 -6 262 -265 262\n -265 266 265 265 265 -62 6 c-35 4 -123 7 -197 8 l-134 1 7 69 c26 284 232\n 543 504 635 201 69 404 53 596 -47 62 -32 103 -63 177 -137 83 -83 102 -108\n 142 -190 63 -130 77 -193 77 -340 0 -178 -37 -298 -134 -435 -91 -126 -220\n -224 -369 -278 -72 -26 -99 -31 -218 -35 -117 -4 -146 -1 -215 17 -104 29\n -205 79 -283 142 l-63 52 -89 -89 c-49 -49 -89 -96 -89 -106 0 -24 154 -136\n 253 -185 89 -44 177 -74 272 -95 84 -17 303 -15 391 5 403 91 691 371 795 772\n 19 76 23 114 22 240 0 129 -4 164 -27 249 -99 377 -406 673 -778 751 -104 22\n -297 28 -385 11z"/>\n <path d="M1227 1418 c-9 -68 -7 -695 2 -770 l6 -57 240 200 c132 110 251 210\n 264 223 l23 24 -257 213 c-141 118 -260 215 -264 217 -5 1 -11 -21 -14 -50z"/>\n </g>\n </svg>\n  </gp-button>\n  ']);return Hr=function(){return t},t}function Fr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var jr=function(t){c()(r,t);var e=Fr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Hr(),"title","display")),g()(u()(t),"data",{title:"replay",display:"",replay:"->"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return r}(ur);function $r(){var t=cr()(['\n  <gp-volume class="goldplay__volume-bar">\n    <gp-overbox class="goldplay-hoverbox goldplay__volume-bar--handle">\n      <span class="goldplay__volume-bar--precent">','</span>\n      <span class="goldplay__volume-bar--rod ','" title="adjust volume"></span>\n      <span class="goldplay__volume-bar--size">&nbsp;</span>\n      <span class="goldplay__volume-bar--column">&nbsp;</span>\n    </gp-overbox>\n    <gp-button class="goldplay__volume-bar--audio ','" title="','" data-mute="','" data-volume-size="','"  data-last-volume="','">\n    ',"\n    </gp-button>\n  </gp-volume>\n  "]);return $r=function(){return t},t}function Wr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function Vr(){var t=cr()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">\n<path d="M12.2 13.914v6.678a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2l.412-.353-2.558-2.558a.5.5 0 0 1 0-.707l.707-.707a.5.5 0 0 1 .707 0l16.849 16.849a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707 0l-2.386-2.386a10 10 0 0 1-2.33 1.422c-.526.229-.583.284-.987.377v-2.375l.007-.003a8.332 8.332 0 0 0 1.717-1.014l-1.67-1.669a5.251 5.251 0 0 1-.054.034v-.089l-2-2zM8.373 4.96l3.002-2.572a.5.5 0 0 1 .825.38v6.019L8.373 4.959zm9.867 9.867c.48-.99.76-2.115.76-3.347 0-3.418-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48a9.954 9.954 0 0 1-1.326 4.98l-1.634-1.633zm-1.766-1.766L14.2 10.786V7.057a5.247 5.247 0 0 1 2.274 6.003z" fill="#f1f1f1"></path>\n</svg>\n']);return Vr=function(){return t},t}function zr(){var t=cr()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">\n<path d="M5.2 7.68l6.175-5.293a.5.5 0 0 1 .825.38v17.825a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2zm9 13.35v-2.375l.007-.003C16.852 17.493 19 14.897 19 11.479s-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48c0 4.106-2.474 7.633-6.013 9.174-.526.229-.583.284-.987.377zm0-13.973c1.5.925 2.5 2.582 2.5 4.473 0 1.892-1 3.55-2.5 4.473V7.057z" fill="#f1f1f1"></path>\n</svg>\n']);return zr=function(){return t},t}var Yr=Xe.create(zr(),"audioOnHide"),Xr=Xe.create(Vr(),"audioOffHide"),Gr=function(t){c()(r,t);var e=Wr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate($r(),"dataPrecent","volumeBarRodHoverCss","audioOffClass","title","dataMute","dataVolumeSize","dataLastVolume","icon|html")),g()(u()(t),"options",{}),g()(u()(t),"data",{audioONHide:"",audioOffHide:"",audioOffClass:"",dataVolumeSize:"",dataPrecent:"",dataLastVolume:"",dataMute:"",volumeBarRodHoverCss:"",icon:Yr,title:"turn off"}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){this.data.dataPrecent=Math.floor(100*this.data.dataVolumeSize),""!==this.data.audioOffClass?(this.data.dataMute="true",this.data.audioOffHide="inline-block",this.data.audioOnHide="none",this.data.icon=Xr,this.data.title="turn on"):(this.data.dataMute="",this.data.audioOffHide="none",this.data.audioOnHide="inline-block",this.data.icon=Yr,this.data.title="turn off")}},{key:"initProps",value:function(){var t=this.element,e=this.options.cssName;this.INIT_VOLUME_SIZE=void 0===this.options.player.defaultVolumeSize?.5:this.options.player.defaultVolumeSize,this.$volumeBarHandle=t.querySelector("."+e.volumeBarHandle),this.$volumeBarRod=t.querySelector("."+e.volumeBarRod),this.$volumeBarAudio=t.querySelector("."+e.volumeBarAudio),this.$volumeBarSize=t.querySelector("."+e.volumeBarSize),this.$volumeBarColumn=t.querySelector("."+e.volumeBarColumn),this.volumeBarColumnHeight=this.$volumeBarColumn.offsetHeight,this.volumeBarColumnTop=this.$volumeBarColumn.offsetTop,this.volumeBarRodHeight=this.$volumeBarRod.offsetHeight,this.volumeBarRodHeightHalf=this.volumeBarRodHeight/2,this.volumeBarColumnRealTop=this.volumeBarColumnTop+this.volumeBarRodHeightHalf,this.volumeBarColumnMaxHeight=this.volumeBarColumnHeight-this.volumeBarRodHeight}},{key:"bindEvent",value:function(){var t,e=this,r=this.options.$controlBarContainer,n=this.options.cssName;Er(r).on("mouseover","."+n.volumeBar,(function(){clearTimeout(t),e.showVolumeBarHandle()})),Er(r).on("mousewheel","."+n.volumeBarHandle,(function(t){var r=t.wheelDelta/500;r=e.data.dataVolumeSize+r,e.setVolumeSize(r),t.preventDefault(),t.stopPropagation()})),Er(r).on("click",["."+n.volumeBarColumn,"."+n.volumeBarSize],(function(t){var r=0;return t.target===e.$volumeBarColumn?r=(e.$volumeBarColumn.offsetHeight-t.offsetY)/t.target.offsetHeight:t.target===e.$volumeBarSize&&(r=e.$volumeBarColumn.offsetHeight-t.target.offsetHeight+t.offsetY,r=e.$volumeBarColumn.offsetHeight-r,r/=e.$volumeBarColumn.offsetHeight),e.setVolumeSize(r),!1})),Er(r).on("click","."+n.volumeBarAudio,(function(t){return e.$volumeBarAudio.classList.contains(n.volumeBarAudioOff)?e.setAudioOn(t.offsetY):e.setAudioOff(t.offsetY),!1}));Er(r).on("mouseout","."+n.volumeBar,(function(r){t=setTimeout((function(){!function(t){var r=e.element,n={y:r.offsetTop+e.$volumeBarHandle.offsetTop,x:r.offsetLeft};return n.width=r.offsetWidth,n.height=e.$volumeBarHandle.offsetHeight,t.pageX>n.x&&t.pageX<n.x+n.width&&t.pageY>n.y&&t.pageY<n.y+n.height}(r)?e.hideVolumeBarHandle():clearTimeout(t)}),N.c.hideBarBoxTime)})),this.volumeDragEvent=Br(this.$volumeBarRod,{$container:this.element,type:"vertical",scope:{top:this.volumeBarColumnTop,right:0,bottom:this.volumeBarColumnTop+this.volumeBarColumnHeight,left:0},onStart:function(){e.data.volumeBarRodHoverCss=e.options.cssName.volumeBarRodHover},onDrag:function(t,r){r-=1,e.dragHandle(r)},onRelease:function(){e.data.volumeBarRodHoverCss=""}})}},{key:"hideVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="hidden"}},{key:"showVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="visible"}},{key:"getVolume",value:function(){var t=(this.$volumeBarSize.offsetHeight-this.volumeBarRodHeight)/this.volumeBarColumnMaxHeight;return t=Math.min(t,1),(t=Math.max(t,0)).toFixed(2)}},{key:"setVolume",value:function(t){this.data.dataVolumeSize=Number(t),this.events.emit(st.PlayerOnVolume,t)}},{key:"initVolumeSize",value:function(){this.data.dataLastVolume=this.INIT_VOLUME_SIZE,this.setAudioOn()}},{key:"setAudioOn",value:function(){var t=this.data.dataLastVolume||0;this.setVolume(t);var e=parseFloat(t,10),r=Math.floor(e*this.volumeBarColumnMaxHeight),n=this.volumeBarColumnTop+(this.volumeBarColumnMaxHeight-r);this.$volumeBarSize.style.marginTop=n+"px",this.$volumeBarSize.style.height=r+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=n+"px",this.data.audioOffClass=""}},{key:"setAudioOff",value:function(){this.setVolume(0),this.data.audioOffClass=this.options.cssName.volumeBarAudioOff;var t=this.getVolume();t>0&&(this.data.dataLastVolume=t),this.$volumeBarSize.style.height=this.volumeBarRodHeight+"px",this.$volumeBarSize.style.marginTop=this.volumeBarColumnRealTop-this.volumeBarRodHeightHalf+this.volumeBarColumnMaxHeight+"px",this.$volumeBarRod.style.top=this.volumeBarColumnRealTop+this.volumeBarColumnMaxHeight-this.volumeBarRodHeightHalf+"px"}},{key:"dragHandle",value:function(t){this.$volumeBarSize.style.marginTop=t+1+"px",this.$volumeBarSize.style.height=this.volumeBarColumnHeight-t+this.volumeBarRodHeight+"px";var e=this.getVolume();e<=0?this.setAudioOff(t):"true"==this.data.dataMute&&this.setAudioOn(t),this.setVolume(e)}},{key:"setVolumeSize",value:function(t){if((t=t.toFixed(2))>=1?t=1:t<.001&&(t=0),t!==this.data.dataVolumeSize){this.setVolume(t);var e=this.volumeBarColumnMaxHeight,r=e-t*e+this.volumeBarColumnTop;this.$volumeBarSize.style.marginTop=r+"px",this.$volumeBarSize.style.height=t*e+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=r+"px",t<=0?this.data.audioOffClass=this.options.cssName.volumeBarAudioOff:"true"==this.data.dataMute&&(this.data.audioOffClass="")}}}]),r}(ur);function qr(){var t=cr()(['\n  <gp-wait class="goldplay-tip goldplay__waiting-bar" title="','" data-status="','">\n    <span class="goldplay__waiting-bar--icon">\n    <svg width="60px" height="60px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background: none;opacity:0.8">\n    <circle cx="50" cy="50" fill="none" stroke-linecap="round" r="40" stroke-width="8" stroke="#f6f6f6" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(17.8841 50 50)">\n    <animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="0.7s" begin="0s" repeatCount="indefinite">\n    </animateTransform>\n    </circle>\n    </svg>\n  </span>\n  <gp-speed class="goldplay__waiting-bar--speed">',"</gp-speed>\n  </gp-wait>\n  "]);return qr=function(){return t},t}function Qr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Kr=function(t){c()(r,t);var e=Qr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(qr(),"title","status","speed")),g()(u()(t),"data",{title:"waiting",speed:"",status:"",display:"show"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderUpdateSpeed,(function(e){"show"===t.data.display&&(t.data.speed=fr.formatBytes(e.speed)+" /s")})),this.events.on(st.StreamDataReady,(function(){t.hideWaiting()}))}},{key:"showWaiting",value:function(){var t=this.options.cssName,e=this.options.$screenContainer;e.querySelector("."+t.waitingBar)||e.prepend(this.element),this.data.display="show",this.show(),this.resetPosition()}},{key:"hideWaiting",value:function(){var t=this.options.cssName;this.options.$screenContainer.querySelector("."+t.waitingBar)&&(this.data.display="hide",this.data.speed="Loading...",this.hide())}}]),r}(ur);function Jr(){var t=cr()(['\n  <gp-alert class="goldplay-tip goldplay__alter-box" title="','" data-display="','">\n  <em title="close" class="goldplay__alter--close">\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="background:none;opacity:0.6" xml:space="preserve" width="20px" height="20px" viewBox="0 0 496.158 496.158">\n    <path style="fill:#ff3300;" d="M496.158,248.085c0-137.021-111.07-248.082-248.076-248.082C111.07,0.003,0,111.063,0,248.085\n    c0,137.002,111.07,248.07,248.082,248.07C385.088,496.155,496.158,385.087,496.158,248.085z"/>\n    <path style="fill:#FFFFFF;" d="M277.042,248.082l72.528-84.196c7.91-9.182,6.876-23.041-2.31-30.951\n    c-9.172-7.904-23.032-6.876-30.947,2.306l-68.236,79.212l-68.229-79.212c-7.91-9.188-21.771-10.216-30.954-2.306\n    c-9.186,7.91-10.214,21.77-2.304,30.951l72.522,84.196l-72.522,84.192c-7.91,9.182-6.882,23.041,2.304,30.951\n    c4.143,3.569,9.241,5.318,14.316,5.318c6.161,0,12.294-2.586,16.638-7.624l68.229-79.212l68.236,79.212\n    c4.338,5.041,10.47,7.624,16.637,7.624c5.069,0,10.168-1.749,14.311-5.318c9.186-7.91,10.22-21.77,2.31-30.951L277.042,248.082z"/>\n    </svg>\n  </em>\n  <span class="goldplay__alter--warn">\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n    width="30" height="30" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\n    <path style="fill:#495A79;" d="M501.461,383.799L320.501,51.401C306.7,28.6,282.7,14.8,256,14.8s-50.7,13.8-64.501,36.601\n      L10.539,383.799C-3.259,407.501-3.56,435.701,9.941,459.4c13.499,23.699,37.798,37.8,65.099,37.8h361.92\n      c27.301,0,51.601-14.101,65.099-37.8C515.56,435.701,515.259,407.501,501.461,383.799z"/>\n    <path style="fill:#42516D;" d="M502.059,459.4c-13.499,23.699-37.798,37.8-65.099,37.8H256V14.8c26.7,0,50.7,13.801,64.501,36.601\n      L501.461,383.8C515.259,407.501,515.56,435.701,502.059,459.4z"/>\n    <path style="fill:#FFDE33;" d="M475.661,399.1L294.699,66.699C286.601,52.9,271.901,44.8,256,44.8s-30.601,8.101-38.699,21.899\n      L36.339,399.1c-8.399,14.101-8.399,31.199-0.298,45.3c8.099,14.399,22.798,22.8,39,22.8h361.92c16.201,0,30.901-8.401,39-22.8\n      C484.06,430.299,484.06,413.201,475.661,399.1z"/>\n    <path style="fill:#FFBC33;" d="M475.96,444.4c-8.099,14.399-22.798,22.8-39,22.8H256V44.8c15.901,0,30.601,8.101,38.699,21.899\n      L475.661,399.1C484.06,413.201,484.06,430.299,475.96,444.4z"/>\n    <g>\n      <path style="fill:#495A79;" d="M256,437.2c-16.538,0-30-13.462-30-30s13.462-30,30-30s30,13.462,30,30S272.538,437.2,256,437.2z"/>\n      <path style="fill:#495A79;" d="M286,317.2c0,16.538-13.462,30-30,30s-30-13.462-30-30v-150c0-16.538,13.462-30,30-30\n        s30,13.462,30,30V317.2z"/>\n    </g>\n    <g>\n      <path style="fill:#42516D;" d="M286,407.2c0-16.538-13.462-30-30-30v60C272.538,437.2,286,423.738,286,407.2z"/>\n      <path style="fill:#42516D;" d="M286,317.2v-150c0-16.538-13.462-30-30-30v210C272.538,347.2,286,333.738,286,317.2z"/>\n    </g>\n    </svg>\n  </span>\n  <gp-content class="goldplay__alter--content">',"</gp-content>\n  </gp-alert>\n  "]);return Jr=function(){return t},t}function Zr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var tn=function(t){c()(r,t);var e=Zr(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Jr(),"title","display","content|trim")),g()(u()(t),"data",{title:"alert",display:"default",content:""}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"bindEvent",value:function(){var t=this,e=this.options.$screenContainer,r=this.options.cssName;Er(e).on("click","."+r.alertClose,(function(){t.hide()}))}},{key:"afterWatch",value:function(){"show"===this.data.display&&this.resetPosition()}},{key:"showBox",value:function(){var t=this.options.cssName,e=this.options.$screenContainer;e.querySelector("."+t.alertBox)||e.prepend(this.element),this.data.display="show",this.show()}},{key:"hideBox",value:function(){var t=this.options.cssName;this.options.$screenContainer.querySelector("."+t.alertBox)&&(this.data.display="hide",this.hide())}},{key:"show",value:function(){this.element.style.opacity=1,this.element.style.display="inline-block",this.resetPosition()}},{key:"hide",value:function(){this.element.style.opacity=0,this.element.style.display="none"}}]),r}(ur);function en(){var t=cr()(['\n  <gp-time class="goldplay__control--timer">\n  <span gid="time" class="goldplay__control--timer-play">','</span>\n  <span gid="slash">','</span>\n  <span gid="total-time" class="goldplay__control--timer-total">',"</span>\n  </gp-time>\n  "]);return en=function(){return t},t}function rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var nn=function(t){c()(r,t);var e=rn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(en(),"time","slash","totalTime")),g()(u()(t),"data",{time:"00:00",totalTime:"",slash:"/"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"setTotalTime",value:function(t){var e=t.sourceData;this.data.totalTime=hr.formatHHMMSS(e.duration)}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoaderPlayListLoaded,(function(e){t.setTotalTime(e.loadData)}))}},{key:"updateTime",value:function(t){this.element.querySelector('[gid="time"]').innerHTML=t}},{key:"updateTotalTime",value:function(t){this.element.querySelector('[gid="total-time"]').innerHTML=t}}]),r}(ur);function an(){var t=cr()(['\n  <gp-speed class="goldplay__speed-bar" title="','">\n  <gp-overbox class="goldplay-hoverbox goldplay__speed-bar--box">\n  ','\n  </gp-overbox>\n  <gp-button class="goldplay__speed-bar--link">\n  ',"\n  </gp-button>\n  </gp-speed>\n  "]);return an=function(){return t},t}function on(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function sn(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return un(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return un(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var ln=function(t){c()(r,t);var e=on(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(an(),"title","speedListHTML|html","currentSpeedName")),g()(u()(t),"data",{title:"speed",currentSpeed:1,speedList:null,currentSpeedName:"ÂÄçÈÄü",speedListHTML:""}),g()(u()(t),"options",{}),t.options=n,t.speedList=t.options.player.options.speedList||N.c.speedList,t.updateSpeedListHTML(),Object.assign(t.data,n.data),t.init(),t.initProps(),t.showHideBar(),t}return o()(r,[{key:"initProps",value:function(){var t=this.options.cssName;this.$barBox=this.element.querySelector("."+t.speedBarBox)}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,r=this.options.$controlBarContainer;Er(r).on("mouseover","."+e.speedBar,(function(){clearTimeout(n),t.showBarBoxHandle()}));var n;Er(r).on("mouseout","."+e.speedBar,(function(e){n=setTimeout((function(){!function(e){var r=t.element,n={y:t.$barBox.offsetTop,x:r.offsetLeft};return n.width=r.offsetWidth,n.height=t.$barBox.offsetHeight,e.pageX>n.x&&e.pageX<n.x+n.width&&e.pageY>n.y&&e.pageY<n.y+n.height}(e)?t.hideBarBoxHandle():clearTimeout(n)}),N.c.hideBarBoxTime)})),Er(this.element).on("click","[gp-node-li]",(function(e){var r=e.target,n=parseFloat(r.getAttribute("value"),10);if(n!==t.data.currentSpeed){t.data.currentSpeed=n;var i=t.speedList.filter((function(t){return t.value===n}));t.events.emit(st.PlayerSpeedTo,i[0]),t.updateSpeedListHTML()}}))}},{key:"showHideBar",value:function(){this.speedList.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var t=33+28*this.speedList.length,e=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-t+"px",this.$barBox.style.marginLeft=-e+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateSpeedListHTML",value:function(t){var e=this.speedList;if(!(e.length<=0)){void 0===t&&(t=this.data.currentSpeed);var r,n=e.slice(0,e.length).reverse(),i=sn(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.value===t?a.selected=!0:delete a.selected}}catch(t){i.e(t)}finally{i.f()}return this.data.speedListHTML=function(t){if(t){var e,r=["<ul>"],n=sn(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a="",o="";i.selected&&(a="gp-selected",o=" selected=".concat(i.selected)),r.push('\n    <li class="'.concat(a,'" gp-node-li value="').concat(i.value,'" ').concat(o,">").concat(i.name,"</li>\n    "))}}catch(t){n.e(t)}finally{n.f()}return r.push("</ul>"),r.join("")}}(n)}}}]),r}(ur);function cn(){var t=cr()(['\n  <gp-subtitle class="goldplay__subtitle">\n  </gp-subtitle>\n  ']);return cn=function(){return t},t}function hn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var fn=function(t){c()(r,t);var e=hn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(cn())),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return r}(ur);function dn(){var t=cr()(['\n  <gp-rate class="goldplay__rate-bar" title="','">\n  <gp-overbox class="goldplay-hoverbox goldplay__rate-bar--box">\n  ','\n  </gp-overbox>\n  <gp-button class="goldplay__rate-bar--link">\n  ',"\n  </gp-button>\n  </gp-rate>\n  "]);return dn=function(){return t},t}function pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function yn(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return gn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gn(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function gn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var vn=function(t){c()(r,t);var e=pn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"rateList",[]),g()(u()(t),"defaultRate",{value:"600",name:"È´òÊ∏Ö"}),g()(u()(t),"template",t.createTemplate(dn(),"title","rateListHTML|html","currentRateName")),g()(u()(t),"data",{title:"stream rate",currentRate:"600",currentRateName:"È´òÊ∏Ö",rateListHTML:""}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.rateList=t.options.player.options.rateList||t.rateList,t.defaultRate=t.options.player.options.defaultRate||t.defaultRate,t.setDefaultRate(),t.updateRateListHTML(),t.init(),t.initProps(),t.showHideBar(),t}return o()(r,[{key:"initProps",value:function(){var t=this.options.cssName;this.$barBox=this.element.querySelector("."+t.rateBarBox)}},{key:"setDefaultRate",value:function(){var t=this;if(!(this.rateList.length<=0)){var e=this.rateList.find((function(e){return String(e.value)===String(t.defaultRate.value)}));e?(this.data.currentRateName=e.name,this.data.currentRate=e.value):(this.data.currentRateName=this.rateList[0].name,this.data.currentRate=this.rateList[0].value)}}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,r=this.options.$controlBarContainer;Er(r).on("mouseover","."+e.rateBar,(function(){clearTimeout(n),t.showBarBoxHandle()}));var n;Er(r).on("mouseout","."+e.rateBar,(function(e){n=setTimeout((function(){!function(e){var r=t.element,n={y:t.$barBox.offsetTop,x:r.offsetLeft};return n.width=r.offsetWidth,n.height=t.$barBox.offsetHeight,e.pageX>n.x&&e.pageX<n.x+n.width&&e.pageY>n.y&&e.pageY<n.y+n.height}(e)?t.hideBarBoxHandle():clearTimeout(n)}),N.c.hideBarBoxTime)})),Er(this.element).on("click","[gp-node-li]",(function(e){var r=e.target.getAttribute("value");if(r!==t.data.currentRate){t.data.currentRate=r;var n=t.rateList.filter((function(t){return t.value===r}));t.events.emit(st.PlayerChangeRate,n[0]),t.data.currentRateName=n[0].name,t.updateRateListHTML(),t.hideBarBoxHandle()}}))}},{key:"showHideBar",value:function(){var t=this.rateList;t&&t.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var t=33+28*this.rateList.length,e=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-t+"px",this.$barBox.style.marginLeft=-e+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateRateListHTML",value:function(t){var e=this.rateList;if(!(e.length<=0)){void 0===t&&(t=this.data.currentRate);var r,n=e.slice(0,e.length).reverse(),i=yn(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.value===t?a.selected=!0:delete a.selected}}catch(t){i.e(t)}finally{i.f()}return this.data.rateListHTML=function(t){if(t){var e,r=["<ul>"],n=yn(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a="",o="";i.selected&&(a="gp-selected",o=" selected=".concat(i.selected)),r.push('\n    <li class="'.concat(a,'" gp-node-li value="').concat(i.value,'" ').concat(o,">").concat(i.name,"</li>\n    "))}}catch(t){n.e(t)}finally{n.f()}return r.push("</ul>"),r.join("")}}(n)}}}]),r}(ur);function mn(){var t=cr()(['\n  <gp-setting class="goldplay__setting-bar">\n  </gp-setting>\n  ']);return mn=function(){return t},t}function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var kn=function(t){c()(r,t);var e=bn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(mn())),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return r}(ur);function _n(){var t=cr()(['\n  <gp-button class="goldplay__control--fullpage" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return _n=function(){return t},t}function wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function xn(){var t=cr()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20" height="20" viewBox="0 0 24 24">\n<path d="M3.5 6h17a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-17a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5zM6 9v6h12V9H6z" fill="#f1f1f1"></path>\n</svg>\n']);return xn=function(){return t},t}function Pn(){var t=cr()(['\n<svg xmlns="http://www.w3.org/2000/svg" style="display:','" width="20" height="20" viewBox="0 0 24 24">\n  <path d="M2.5 4h19a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-19a.5.5 0 0 1-.5-.5v-15a.5.5 0 0 1 .5-.5zM5 7v10h14V7H5z" fill="#f1f1f1"></path>\n</svg>\n']);return Pn=function(){return t},t}var En=Xe.create(Pn(),"fullpageHide"),Tn=Xe.create(xn(),"fullpageExitHide"),Bn=function(t){c()(r,t);var e=wn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"containerOriginStyle",""),g()(u()(t),"template",t.createTemplate(_n(),"title","status","icon|html")),g()(u()(t),"data",{fullpageHide:"",fullpageExitHide:"none",status:"",icon:En,title:"fullpage"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){"fullpage"===this.data.status?(this.data.fullpageHide="none",this.data.fullpageExitHide="inline-block",this.data.title="exit fullspage",this.data.icon=Tn):(this.data.fullpageHide="inline-block",this.data.fullpageExitHide="none",this.data.title="fullpage",this.data.icon=En)}},{key:"initProps",value:function(){var t=this.options;this.$container=this.options.$container,this.$screenContainer=t.$screenContainer,this.$controlBarContainer=this.getComponent("controlBarContainer").element,this.originWidth=t.$container.offsetWidth,this.originHeight=t.$container.offsetHeight,this.containerOriginStyle=t.$container.getAttribute("style"),this.screenContainerOrginStyle=this.$screenContainer.getAttribute("style"),this.controlContainerOrginWidth=this.$controlBarContainer.style.width}},{key:"bindEvent",value:function(){var t=this,e=this.options.cssName,r=document,n=window;Er(this.$controlBarContainer).on("click","."+e.fullPage,(function(){var e=t.data.status;"fullscreen"===t.getComponent("fullScreen").data.status&&K.exitFullscreen(),"fullpage"===e?t.exitFullPage():t.fullPage()})),this.eventsList.esckeyup=this.addEventListener(r,"keyup",(function(e){27===e.keyCode&&"fullpage"===t.data.status&&t.exitFullPage()})),this.eventsList.windowresize=this.addEventListener(n,"resize",(function(){if("fullpage"===t.data.status){var e=K.getInnerWidthHeight();t.resizeTo(e.width,e.height),t.resetPosition()}}))}},{key:"fullPage",value:function(){this.data.status="fullpage";var t=this.options,e=this.options.cssName,r=K.getInnerWidthHeight();this.saveOriginPosition(),t.$container.classList.add(e.containerFullPage),this.resizeTo(r.width,r.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){var t=this.getComponent("progressBar");this.posterOriginStyle=this.getComponent("poster").element.getAttribute("style"),this.originScroll={scrollX:scrollX,scrollY:scrollY},this.progressBarOriginLeft=t.progressBarLeft,this.progressBarOriginWidth=t.progressBarWidth,this.progressBarPlayWidthRate=t.getProgressPlayLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadWidthRate=t.getProgressLoadLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadLeftRate=(t.getProgressLoadLeftWidth().offsetLeft-this.progressBarOriginLeft)/this.progressBarOriginWidth}},{key:"setProgressBarPosition",value:function(){var t=this.getComponent("progressBar"),e=t.progressBarWidth,r=t.progressBarLeft,n=e*this.progressBarPlayWidthRate,i=e*this.progressBarLoadWidthRate,a=e*this.progressBarLoadLeftRate;t.setProgressPosition(n),t.setProgressLoadLeftWidth(a+r,i),this.getComponent("progressBar").clearDragDotTop()}},{key:"resizeTo",value:function(t,e){var r=this.options,n=r.player,i=n.controlBarAutoHide?e:e-n.controlBarHeight;n.$screenContainer.style.width=t+"px",n.$screenContainer.style.height=i+"px",r.$container.style.width=t+"px",r.$container.style.height=e+"px"}},{key:"resetPosition",value:function(){var t=this.options;this.setProgressBarPosition(),t.player.resizeScreen(),this.getComponent("bigPlayButton").resetPosition(),this.getComponent("poster").resetPosition(),this.getComponent("waitingBar").resetPosition(),this.getComponent("controlBarContainer").resetPosition()}},{key:"exitFullPage",value:function(){this.data.status="exitfullpage";var t=this.options.cssName;this.saveOriginPosition(),this.$container.classList.remove(t.containerFullPage),this.resetScreen()}},{key:"resetScreen",value:function(){this.$container.setAttribute("style",this.containerOriginStyle),this.$screenContainer.setAttribute("style",this.screenContainerOrginStyle),this.$controlBarContainer.style.width=this.controlContainerOrginWidth,this.getComponent("poster").element.setAttribute("style",this.posterOriginStyle),scrollTo(this.originScroll.scrollX,this.originScroll.scrollY),this.resetPosition()}}]),r}(ur);function Sn(){var t=cr()(['\n  <gp-button class="goldplay__control--fullscreen" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return Sn=function(){return t},t}function Rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ln='\n<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreen" style="display:${\'fullscreenHide\'}" width="20" height="20" viewBox="0 0 24 24">\n<path d="M15 5.057V2h6.5a.5.5 0 0 1 .5.5V9h-2.943V5.057H15zm-6 0H5.057V9H2V2.5a.5.5 0 0 1 .5-.5H9v3.057zM15 22v-2.943h4.057V15H22v6.5a.5.5 0 0 1-.5.5H15zm-6 0H2.5a.5.5 0 0 1-.5-.5V15h3.057v4.057H9V22z" fill="#f1f1f1"></path>\n</svg>\n',Dn=function(t){c()(r,t);var e=Rn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Sn(),"title","status","icon|html")),g()(u()(t),"data",{fullscreenHide:"inline-block",fullscreenExitHide:"none",status:"",icon:Ln,title:"fullscreen"}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){"fullscreen"===this.data.status?(this.data.fullscreenHide="none",this.data.fullscreenExitHide="inline-block",this.data.title="exit fullscreen",this.data.icon='\n<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreenExit" style="display:${\'fullscreenExitHide\'}"  width="20" height="20" viewBox="0 0 24 24">\n<path d="M22 5.943V9h-6.5a.5.5 0 0 1-.5-.5V2h2.943v3.943H22zm-20 0h3.943V2H9v6.5a.5.5 0 0 1-.5.5H2V5.943zM22 15v2.943h-4.057V22H15v-6.5a.5.5 0 0 1 .5-.5H22zM2 15h6.5a.5.5 0 0 1 .5.5V22H5.943v-4.057H2V15z" fill="#f1f1f1"></path>\n</svg>\n'):(this.data.fullscreenHide="inline-block",this.data.fullscreenExitHide="none",this.data.title="fullscreen",this.data.icon=Ln)}},{key:"initProps",value:function(){this.getComponent("fullPage").initProps.call(this)}},{key:"bindEvent",value:function(){var t=this,e=this.options.$container,r=this.options.cssName,n=document,i=window;this.eventsList.fullscreenchange=this.addEventListener(n,"fullscreenchange",(function(){if(document.fullscreenElement||document.webkitFullscreenElement)t.fullScreen();else{var n=t.getComponent("fullPage");"fullpage"===n.data.status?(e.classList.remove(r.containerFullScreen),t.data.status="exitfullscreen",n.fullPage()):t.exitFullScreen()}})),this.eventsList.windowresize=this.addEventListener(i,"resize",(function(){document.fullscreenElement&&(t.resizeTo(screen.width,screen.height-(window.outerHeight-window.innerHeight)),t.resetPosition())})),Er(this.$controlBarContainer).on("click","."+r.fullScreen,(function(){var e=t.data.status;t.saveOriginPosition(),"fullscreen"===e?K.exitFullscreen():K.Fullscreen()}))}},{key:"fullScreen",value:function(){this.data.status="fullscreen";var t=this.options,e=this.options.cssName,r={width:screen.width,height:screen.height-(outerHeight-innerHeight)};K.isSafari()&&(r.height=r.height+38),t.$container.classList.add(e.containerFullScreen),this.resizeTo(r.width,r.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){this.getComponent("fullPage").saveOriginPosition.call(this)}},{key:"resizeTo",value:function(t,e){this.getComponent("fullPage").resizeTo.call(this,t,e)}},{key:"resetPosition",value:function(){this.getComponent("fullPage").resetPosition.call(this)}},{key:"setProgressBarPosition",value:function(){this.getComponent("fullPage").setProgressBarPosition.call(this)}},{key:"exitFullScreen",value:function(){this.data.status="exitfullscreen";var t=this.options.cssName;this.saveOriginPosition(),this.options.$container.classList.remove(t.containerFullScreen),this.resetScreen(),this.saveOriginPosition()}},{key:"resetScreen",value:function(){this.getComponent("fullPage").resetScreen.call(this)}}]),r}(ur);function Cn(){var t=cr()(['\n  <gp-button class="goldplay__screen--bigplay" title="','" data-status="','">\n  ',"\n  </gp-button>\n  "]);return Cn=function(){return t},t}function An(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}function In(){var t=cr()(['<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\nwidth="','" height="','" viewBox="0 0 438.533 438.533" style="','" xml:space="preserve">\n<g>\n<path d="M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0\n c-39.781,0-76.466,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267\n s9.804,76.463,29.407,110.062c19.607,33.585,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407\n s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.599,29.403-70.287,29.403-110.062\n C438.533,179.489,428.732,142.795,409.133,109.203z M328.904,234.966L173.588,326.33c-2.856,1.711-5.902,2.567-9.136,2.567\n c-3.045,0-6.09-0.764-9.135-2.286c-6.09-3.614-9.136-8.939-9.136-15.985V127.907c0-7.041,3.046-12.371,9.136-15.987\n c6.28-3.427,12.369-3.333,18.271,0.284l155.316,91.36c6.088,3.424,9.134,8.663,9.134,15.703\n C338.038,226.308,334.992,231.537,328.904,234.966z" fill="','">\n</g>\n</svg>\n']);return In=function(){return t},t}var On=Xe.create(In(),"width","height","iconStyle","fillColor"),Un=function(t){c()(r,t);var e=An(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"template",t.createTemplate(Cn(),"title","status","icon|html")),g()(u()(t),"data",{titie:"click to play",iconStyle:"opacity:0.5",display:"hide",status:"",width:100,height:100,fillColor:"#999",icon:On}),g()(u()(t),"options",{}),t.options=n,Object.assign(t.data,n.data),t.init(),t}return o()(r,[{key:"watch",value:function(){if("show"===this.data.display){var t=(this.element.parentNode.offsetHeight-this.data.height)/2;this.data.iconStyle="opacity:0.7;margin-top:".concat(t,"px")}}},{key:"resetPosition",value:function(){if("show"===this.data.display){var t=this.element.parentNode,e=t.offsetWidth,r=t.offsetHeight;!0===this.options.player.controlBarAutoHide&&(r-=this.options.player.controlBarHeight);var n=t.offsetTop,i=t.offsetLeft;this.element.style.width=e+"px",this.element.style.height=r+"px",this.element.style.top=n+"px",this.element.style.left=i+"px"}}},{key:"bindEvent",value:function(){var t=this,e=this.options.$screenContainer,r=this.options.cssName;Er(e).on("click","."+r.bigPlayButton,(function(){t.events.emit(st.PlayerOnPlay,t),t.events.emit(st.ControlBarPlay,t),t.hide()})),Er(e).on("mouseover","."+r.bigPlayButton,(function(){t.data.fillColor=t.options.bigPlayButtonColor||"#fff"})),Er(e).on("mouseout","."+r.bigPlayButton,(function(e){var r=t.element,n={y:r.offsetTop,x:r.offsetLeft};n.width=r.offsetWidth,n.height=r.offsetHeight,e.pageX>n.x&&e.pageX<n.x+n.width&&e.pageY>n.y&&e.pageY<n.y+n.height||(t.data.fillColor="#999")}))}},{key:"show",value:function(){var t=this;"show"!==this.data.display&&(this.data.display="show",this.element.style.opacity="1",setTimeout((function(){t.element.style.display="inline-block"}),1))}},{key:"hide",value:function(){"hide"!==this.data.display&&(this.element.style.opacity="0",this.data.display="hide",this.element.style.display="none")}}]),r}(ur);function Mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Nn=function(t){c()(r,t);var e=Mn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),(t=e.call(this,n)).options=Object.assign(t.options,n),t.componentsController=t.options.componentsController,t.init(),t}return o()(r,[{key:"render",value:function(){var t=this,e=L.createEl("gp-button-block");e.classList.add("goldplay__control--button-block"),r.componentList.forEach((function(r){var n=t.componentsController.getComponent(r);e.appendChild(n.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t){r.componentList.push(t)}}]),r}(ur);g()(Nn,"componentList",["playButton","pauseButton","replayButton"]);var Hn=Nn;function Fn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var jn=function(t){c()(r,t);var e=Fn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),(t=e.call(this,n)).options=Object.assign(t.options,n),t.componentsController=t.options.componentsController,t.init(),t}return o()(r,[{key:"render",value:function(){var t=this,e=L.createEl("gp-control-sidebar");e.classList.add("goldplay__control--sidebar"),r.componentList.forEach((function(r){var n=t.componentsController.getComponent(r);e.appendChild(n.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t,e){(e<0||e>r.componentList.length)&&(e=r.componentList.length),r.componentList.splice(e,0,t)}}]),r}(ur);g()(jn,"componentList",["speedBar","rateBar","volumeBar","fullPage","fullScreen"]);var $n=jn;function Wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Vn=function(t){c()(r,t);var e=Wn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),(t=e.call(this,n)).options=Object.assign(t.options,n),t.componentsController=t.options.componentsController,t.init(),t}return o()(r,[{key:"render",value:function(){var t=this,e=L.createEl("gp-control-nearside");e.classList.add("goldplay__control--button-block"),r.componentList.forEach((function(r){var n=t.componentsController.getComponent(r);e.appendChild(n.element)})),this.element=e}}],[{key:"addCustomControl",value:function(t,e){(e<0||e>r.componentList.length)&&(e=r.componentList.length),r.componentList.splice(e,0,t)}}]),r}(ur);g()(Vn,"componentList",["playControl","timer"]);var zn=Vn,Yn={BaseComponent:ur,controlBarContainer:mr,bigPlayButton:Un,poster:yr,progressBar:Lr,playButton:Ar,pauseButton:Nr,replayButton:jr,volumeBar:Gr,waitingBar:Kr,alertBox:tn,timer:nn,speedBar:ln,subtitle:fn,rateBar:vn,settingBar:kn,fullPage:Bn,fullScreen:Dn,playControl:Hn,sideControlBar:$n,nearControlBar:zn};function Xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Gn=Fe,qn=function(t){return t.substr(0,1).toUpperCase()+t.substr(1)},Qn=function(t){c()(r,t);var e=Xn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"allComponents",{}),g()(u()(t),"controlBarController",null),g()(u()(t),"options",{cssName:Gn}),t.options=Object.assign(t.options,n),t.options.componentsController=u()(t),t.initComponents(),t.$container=t.options.$container,t.$screenContainer=t.options.$screenContainer,t.$canvas=t.options.$canvas,t.$audioContainer=t.options.$audioContainer,t.$audio=t.options.$audio,t.options.$controlBarContainer=t.controlBarContainer.element,t.bindEvent(),t}return o()(r,[{key:"run",value:function(){for(var t in this.controlBarController&&this.controlBarController.run(),Yn)this[t]&&"function"==typeof this[t].registerMethod&&this[t].registerMethod()}},{key:"initComponents",value:function(){for(var t in Yn){var e=Yn[t];this.allComponents[t]||this.createComponent(e,t)}}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.PlayerLoadedMetaData,(function(){t.poster.hide()})),this.events.on(st.AudioPlayerPlayFail,(function(){t.drawBigPlayButton(),t.getComponent("poster").hide(),t.events.emit(st.PlayerOnPause,t),t.events.emit(st.ControlBarPause,t)})),this.bindAlertBoxEvent(),this.bindWaitingBarEvent()}},{key:"bindWaitingBarEvent",value:function(){this.waitingBar.initProps(),this.waitingBar.bindEvent()}},{key:"drawBigPlayButton",value:function(){this.$screenContainer.prepend(this.bigPlayButton.element),this.bigPlayButton.show(),this.bigPlayButton.bindEvent(),this.bigPlayButton.resetPosition()}},{key:"setControlBarController",value:function(t){this.controlBarController=t}},{key:"getControlBarController",value:function(){return this.controlBarController||this.options.player.controlBarContainer}},{key:"bindAlertBoxEvent",value:function(){this.alertBox.initProps(),this.alertBox.bindEvent()}},{key:"drawPoster",value:function(){this.$screenContainer.prepend(this.poster.element),this.poster.data.display="show",this.poster.bindEvent(),this.poster.resetPosition()}},{key:"createComponent",value:function(t,e){var r=qn(e);this["set"+r](new t(this.options)),this[e]=this["get"+r](),this.allComponents[e]||(this.allComponents[e]=this[e])}},{key:"getComponent",value:function(t){return this.allComponents[t]||Yn[t]&&this.createComponent(Yn[t],t),this.allComponents[t]}},{key:"resetAllComponents",value:function(){var t=this,e=Object.getOwnPropertyNames(this),r={};e.forEach((function(e){Yn[e]&&(r[e]=t[e])})),this.allComponents=r}},{key:"getAllComponents",value:function(){return this.allComponents}}]),r}(A);for(var Kn in Qn.addComponet=function(t){var e=qn(t);Qn.prototype["set"+e]=function(e){this[t]=e},Qn.prototype["get"+e]=function(){return this[t]}},Yn)Qn.addComponet(Kn);var Jn=Qn;function Zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var ti=Fe,ei=function(t){c()(r,t);var e=Zn(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,r),t=e.call(this,n),g()(u()(t),"player",null),g()(u()(t),"loadData",null),g()(u()(t),"options",{cssName:ti}),t.options=Object.assign(t.options,n),t.player=t.options.player,t.loadData=t.player.loadData,t.componentsController=t.player.componentsController,t.$screenContainer=t.player.$screenContainer,t.initComponents(),t}return o()(r,[{key:"initComponents",value:function(){var t=this.componentsController;this.options.controlBar?Object.assign(this,t.getAllComponents()):Object.assign(this,{BaseComponent:t.getComponent("BaseComponent"),waitingBar:t.getComponent("waitingBar")}),this.container=this.controlBarContainer}},{key:"run",value:function(){this.drawLayout(),this.bindEvent(),this.player.autoPlay?this.events.emit(st.ControlBarPlay):this.events.emit(st.ControlBarPause)}},{key:"bindEvent",value:function(){this.bindWaitingBarEvent(),this.options.controlBar&&(this.timer.setTotalTime(this.loadData),this.bindSpeedEvent(),this.bindContainerEvent(),this.bindTimerEvent(),this.bindPlayEvent(),this.bindProgressEvent(),this.bindRateEvent(),this.bindVolumeEvent(),this.bindFullPage(),this.bindFullScreen())}},{key:"bindContainerEvent",value:function(){this.container.initProps(),this.container.bindEvent()}},{key:"bindTimerEvent",value:function(){this.timer.initProps(),this.timer.bindEvent()}},{key:"bindSpeedEvent",value:function(){this.speedBar.bindEvent(),this.speedBar.resetBoxPosition()}},{key:"bindRateEvent",value:function(){this.rateBar.bindEvent(),this.rateBar.resetBoxPosition()}},{key:"bindFullPage",value:function(){this.fullPage.initProps(),this.fullPage.bindEvent()}},{key:"bindFullScreen",value:function(){this.fullScreen.initProps(),this.fullScreen.bindEvent()}},{key:"bindWaitingBarEvent",value:function(){var t=this;[st.PlayerWait,st.PlayerSeeking,st.PlayerReset,st.PlayerChangeRate,st.PlayerChangeSrc].forEach((function(e){t.events.on(e,(function(){t.waitingBar.showWaiting()}))})),this.events.on(st.PlayerSeekEnd,(function(){t.waitingBar.hideWaiting()})),this.events.on(st.PlayerPlay,(function(){t.waitingBar.hideWaiting()})),this.events.on(st.PlayerPlaying,(function(){t.waitingBar.hideWaiting()}))}},{key:"bindPlayEvent",value:function(){var t=this;this.events.on(st.ControlBarPlay,(function(){"pause"!==t.pauseButton.data.status&&(t.pauseButton.data.status="pause"),t.replayButton.hide(),t.playButton.hide(),t.pauseButton.show(),t.bigPlayButton.hide()})),this.events.on(st.ControlBarPause,(function(){"pause"!==t.player.status&&(t.pauseButton.data.status="pause"),t.playButton.show(),t.pauseButton.hide()})),this.events.on(st.PlayerEnd,(function(){t.replayButton.show(),t.pauseButton.hide(),t.playButton.hide()})),this.events.on(st.PlayerPlay,(function(){t.events.emit(st.ControlBarPlay,t)})),this.events.on(st.PlayerPause,(function(){t.events.emit(st.ControlBarPause,t)})),this.events.on(st.PlayerOnSeek,(function(e){e<1e3*t.loadData.sourceData.duration&&t.events.emit(st.ControlBarPauseLoading)})),this.events.on(st.ControlBarPauseLoading,(function(){"pauseloading"!==t.pauseButton.data.status&&(t.pauseButton.data.status="pauseloading"),t.replayButton.hide(),t.playButton.hide(),t.pauseButton.show()})),Er(this.options.$container).on("click","."+ti.playButton,(function(){"play"!==t.player.status&&t.events.emit(st.PlayerOnPlay,t)})),Er(this.options.$container).on("click","."+ti.pauseButton,(function(){"pause"!==t.player.status&&t.events.emit(st.PlayerOnPause,t)})),Er(this.options.$container).on("click","."+ti.replayButton,(function(){t.events.emit(st.PlayerOnSeek,t.player.startTime)}))}},{key:"bindProgressEvent",value:function(){this.progressBar.initProps(),this.progressBar.bindEvent()}},{key:"bindVolumeEvent",value:function(){this.volumeBar.initProps(),this.volumeBar.initVolumeSize(),this.volumeBar.bindEvent()}},{key:"drawLayout",value:function(){var t=this.options.$container;if(this.container){var e=this.container.element;t.append(e)}}},{key:"destroy",value:function(){this.removeEventListenerGlobal(),this.container&&this.container.destroy()}},{key:"removeEventListenerGlobal",value:function(){this.progressBar&&this.progressBar.progressDragEvent&&this.progressBar.progressDragEvent.removeEventListenerAll(),this.volumeBar&&this.volumeBar.volumeDragEvent&&this.volumeBar.volumeDragEvent.removeEventListenerAll(),this.fullPage&&this.fullPage.removeEventListenerAll(),this.fullScreen&&this.fullScreen.removeEventListenerAll()}}]),r}(A),ri=r(44),ni=r.n(ri);function ii(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var ai=function(t){c()(r,t);var e=ii(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"isLast",!1),n.type=t.type,n.libPath=t.libPath,n.player=t.player,n.init(),n}return o()(r,[{key:"init",value:function(){"ts"==this.type&&this.initNornalWorker(),this.bindEvent(),this.loadjs()}},{key:"initNornalWorker",value:function(){this.processor=this.initWorker()}},{key:"initWorker",value:function(){var t=this,e=ni()(143);return e.onmessage=function(e){var r=e.data,n=r.type,i=r.no,a=r.data;switch(n){case"dataProcessorReady":t.onDataProcessorReady();break;case"decoded":t.onDecoded(a,i);break;case"demuxedAAC":t.onDemuxedAAC(a,i);break;case"partEnd":t.onPartEnd(a);break;case"resetEnd":t.onResetEnd();break;case"maxPTS":t.onMaxPTS(a);break;case"flushEnd":t.onFlushEnd(a)}},e}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.DemuxStartDemux,this.onStartDemux.bind(this)),this.events.on(st.DemuxLast,(function(){t.isLast=!0})),this.events.on(st.DecodeFlush,(function(){t.flush()}))}},{key:"flush",value:function(){this.processor.postMessage({type:"flush"})}},{key:"loadjs",value:function(){this.processor.postMessage({type:"loadwasm",libPath:this.libPath,codec:this.options.codec})}},{key:"reset",value:function(){this.isLast=!1,this.processor.terminate(),this.initNornalWorker(),this.loadjs()}},{key:"onFlushEnd",value:function(t){this.events.emit(st.DecodeFlushEnd,t)}},{key:"onMaxPTS",value:function(t){this.events.emit(st.PlayerMaxPTS,t.maxAudioPTS,t.maxVideoPTS)}},{key:"onDemuxedAAC",value:function(t,e){this.events.emit(st.DemuxAAC,t,e)}},{key:"onDataProcessorReady",value:function(){this.player.seeking||this.player.reseting?this.events.emit(st.ProcessorResetEnd):this.events.emit(st.DataProcessorReady)}},{key:"onStartDemux",value:function(t){this.player.reseting||(this.logger.info("onStartDemux","postMessage to demux"),t&&t.arrayBuffer&&t.arrayBuffer.byteLength>0?this.processor.postMessage({type:"startDemux",data:t.arrayBuffer,no:t.no,isLast:this.isLast},[t.arrayBuffer.buffer]):this.logger.error("onStartDemux","data is null","data:",t))}},{key:"onDecoded",value:function(t,e){this.player.reseting||this.events.emit(st.DecodeDecoded,t,e)}},{key:"onPartEnd",value:function(t){this.events.emit(st.DecodeApppendEnd,t)}},{key:"onResetEnd",value:function(){this.events.emit(st.ProcessorResetEnd)}},{key:"destroy",value:function(){this.processor&&this.processor.terminate()}}]),r}(M);function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var si=function(t){c()(r,t);var e=oi(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"currentIndex",null),g()(u()(n),"retryTime",0),g()(u()(n),"dataReady",{audioReady:!1,imageReady:!1}),g()(u()(n),"hasInit",!1),g()(u()(n),"loadDataStatus","loading"),g()(u()(n),"duration",0),g()(u()(n),"tsNumber",0),n.loadData=t.loadData,n.imagePlayer=t.imagePlayer,n.audioPlayer=t.audioPlayer,n.player=t.player,n.bindEvent(),n}return o()(r,[{key:"bindEvent",value:function(){var t=this;this.events.on(st.LoadDataRead,(function(e){if(e){var r=e.no;"".concat(t.player.options.sourceURL,"-").concat(r);t.onRead(e)}})),this.events.on(st.DemuxVideo,(function(e,r){t.onVideoDemuxed(e,r)})),this.events.on(st.DemuxAAC,(function(e,r){t.onAACDemuxed(e,r)})),this.events.on(st.DecodeDecoded,(function(e,r){t.onDecoded(e,r)})),this.events.on(st.DecodeApppendEnd,(function(e){t.onAppendEnd(e)})),this.events.on(st.ImagePlayerReady,(function(){t.logger.info("bindevent","Events.ImagePlayerReady"),t.checkDataReady("imageReady")})),this.events.on(st.AudioPlayerDataReady,(function(){t.logger.info("bindevent","Events.AudioPlayerDataReady"),t.player.receiveAACTime=null,t.checkDataReady("audioReady")})),this.events.on(st.AudioPlayerWait,(function(){t.dataReady.audioReady=!1,t.events.emit(st.PlayerWait,"audioPlayer")})),this.events.on(st.ImagePlayerWait,(function(){t.dataReady.imageReady=!1,t.events.emit(st.PlayerWait,"imagePlayer")})),this.events.on(st.ImagePlayerEnd,(function(){t.logger.info("bindevent","........imageplayer end"),t.events.emit(st.PlayerEnd)})),this.events.on(st.PlayerWait,(function(){t.logger.warn("player status wait"),t.player.status="wait","loadend"===t.loadDataStatus&&(t.loadDataStatus="loading",t.loadNext())})),this.events.on(st.PlayerLoadNext,(function(){"loadend"===t.loadDataStatus&&(t.loadDataStatus="loading",t.loadNext())})),this.events.on(st.DecodeFlushEnd,(function(e){t.logger.info("flushend>>>>>>>>>>>>>>>",e),t.imagePlayer.maxPTS=e}))}},{key:"checkDataReady",value:function(t){var e=this.dataReady;e[t]=!0;for(var r=Object.keys(e),n=0,i=0;i<r.length&&e[r[i]];i++)n++;n==r.length&&this.events.emit(st.StreamDataReady)}},{key:"setBaseInfo",value:function(t){this.duration=t.duration,this.tsNumber=t.tsNumber}},{key:"reset",value:function(){this.dataReady={audioReady:!1,imageReady:!1},this.currentIndex=null,this.loadDataStatus="loading"}},{key:"startLoad",value:function(t){this.logger.info("startLoad","index:",t),this.currentIndex=t,this.player.currentIndex=t,this.events.emit(st.LoadDataReadBufferByNo,t)}},{key:"loadNext",value:function(){this.player.reseting||(this.currentIndex>=this.tsNumber?this.logger.info("loadNext","load end","currentIndex",this.currentIndex,"tsNumber:",this.tsNumber):(this.currentIndex+=1,this.player.currentIndex=this.currentIndex,this.logger.info("loadNext","load next ts","tsno:",this.currentIndex),this.events.emit(st.LoadDataReadBufferByNo,this.currentIndex)))}},{key:"onDecoded",value:function(t,e){var r=this;t.forEach((function(t){r.player.reseting||t.pts>=r.player.currentTime&&r.imagePlayer.push(t)}))}},{key:"onAppendEnd",value:function(t){return t?(this.logger.info("onAppendEnd","events.decodeFlush",t),void this.events.emit(st.DecodeFlush)):(this.logger.info("onAppendEnd","start load next ts condition",this.checkBuffer(),this.currentIndex),this.checkBuffer()&&null!==this.currentIndex?(this.logger.info("onAppendEnd","load next ts. currentIndex:",this.currentIndex),void this.loadNext()):(this.loadDataStatus="loadend",void this.logger.info("onAppendEnd","load ts stop")))}},{key:"onAACDemuxed",value:function(t,e){var r=this;this.player.reseting||(t.length||this.audioPlayer.send({}),t.forEach((function(t){(t.PTS>=r.player.currentTime||t.audioEnd)&&(!r.player.receiveAACTime&&r.player.seeking&&(r.player.receiveAACTime=Date.now()),r.audioPlayer.send(t))})))}},{key:"onVideoDemuxed",value:function(t){this.player.reseting||this.events.emit(st.DecodeStartDecode,t)}},{key:"checkBuffer",value:function(){var t=this.player,e=t.currentTime;return!((t.buffer()[1]||0)-e>=t.maxBufferLength)}},{key:"onRead",value:function(t){this.player.reseting?console.error("onRead reseting"):t&&t.arrayBuffer&&t.no===this.currentIndex?(this.retryTime=0,this.logger.warn("onRead","get stream data"),t.no===this.tsNumber&&(this.logger.info("onRead","the last ts"),this.events.emit(st.DemuxLast)),this.events.emit(st.DemuxStartDemux,t)):this.logger.error("onRead","load ts failred","tsno:",this.currentIndex)}},{key:"readFromCache",value:function(t,e){var r=this;t.forEach((function(t){(t.PTS>=r.player.currentTime||t.audioEnd)&&(!r.player.receiveAACTime&&r.player.seeking&&(r.player.receiveAACTime=Date.now()),r.audioPlayer.send(t))})),e.forEach((function(t){r.player.reseting||t.pts>=r.player.currentTime&&r.imagePlayer.push(t)})),this.events.emit(st.DecodeFlush)}}]),r}(M);function ui(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var li=function(t){c()(r,t);var e=ui(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"maxBufferLength",0),g()(u()(n),"duration",0),g()(u()(n),"pool",[]),g()(u()(n),"start",0),g()(u()(n),"end",0),g()(u()(n),"offset",0),g()(u()(n),"fps",25),n.maxBufferLength=t.maxBufferLength,n}return o()(r,[{key:"push",value:function(t){var e=this.pool,r=e.length;0===r&&(this.offset=t.pts,this.start=t.pts,this.fps=t.fps);var n=this.insertSort(e,t);e[n-1]&&(e[n-1].duration=e[n].pts-e[n-1].pts),e[n+1]&&(e[n].duration=e[n+1].pts-e[n].pts),this.end=this.pool[r].pts+this.pool[r].duration,this.duration=this.end-this.start}},{key:"insertSort",value:function(t,e){var r=t.length;if(0===r)return t.push(e),0;for(var n=0;n<r;n++)if(e.pts<t[n].pts){for(var i=r;i>n;)t[i]=t[i-1],i--;return t[n]=e,n}return t.push(e),t.length-1}},{key:"reset",value:function(){this.duration=0,this.pool=[],this.start=0,this.end=0,this.offset=0}},{key:"findByIndex",value:function(t){var e=this.buffer.length;return t<e?(this.currentIndex=t,this.buffer[t]):(this.logger.error("input index ".concat(t,"is not found, current maxIndex is ").concat(e-1)),null)}},{key:"find",value:function(t){var e=this.pool,r=e.length;if(this.isBuffered(t)&&0!==r){var n=this.findIndex(t);if(-1!==n){var i=e[n];return this.checkBuffer(t),i}}}},{key:"findIndex",value:function(t){return this.pool.findIndex((function(e){var r=parseInt(e.pts);return t>=r&&t<r+e.duration}))}},{key:"isBuffered",value:function(t){return t>=this.start&&t<this.end}},{key:"checkBuffer",value:function(t){if(this.duration>this.maxBufferLength){if(t>this.start){var e=this.findIndex(t),r=this.pool.splice(0,e);r.forEach((function(t){null})),r=null,this.start=this.pool[0].pts,this.duration=this.end-this.start}return!1}return this.events.emit(st.PlayerLoadNext),!0}},{key:"buffer",value:function(){return{start:this.start,end:this.end}}}]),r}(M),ci=r(77),hi=r.n(ci),fi=r(62),di=r.n(fi);function pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var yi=function(t){c()(r,t);var e=pi(r);function r(t){var n;return i()(this,r),n=e.call(this),g()(u()(n),"canvas",null),n.setCanvas(t.canvas),n.setRender(),n}return o()(r,[{key:"setCanvas",value:function(t){this.canvas=t}},{key:"setRender",value:function(t){this.render=hi.a.attach(t||this.canvas)}},{key:"clear",value:function(){this.render.clear()}},{key:"drawFrame",value:function(t){var e,r,n,i,a,o=Date.now(),s=t.buf_y,u=t.buf_u,l=t.buf_v,c=t.width,h=t.height,f=c/2,d=h/2;e={bytes:s,stride:t.stride_y},r={bytes:u,stride:t.stride_u},n={bytes:l,stride:t.stride_v},i=di.a.format({width:c,height:h,chromaWidth:f,chromaHeight:d}),a=di.a.frame(i,e,r,n),this.render.drawFrame(a);var p=Date.now();p-o>10&&this.logger.warn("drawFrame","reandertime:",p-o)}}]),r}(M);function gi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var vi=function(t){c()(r,t);var e=gi(r);function r(t){var n;return i()(this,r),n=e.call(this,t),g()(u()(n),"status","pause"),g()(u()(n),"_currentTime",0),g()(u()(n),"maxPTS",null),g()(u()(n),"ready",!1),g()(u()(n),"firstRender",!1),n.imageData=new li({events:t.events,maxBufferLength:t.maxBufferLength}),n.screen=new yi({canvas:t.canvas}),n.playHandler=null,n.player=t.player,n.debug=t.debug||!1,n}return o()(r,[{key:"setScreenRender",value:function(t){this.screen.setCanvas(t),this.screen.setRender(t)}},{key:"clear",value:function(){this.screen.clear()}},{key:"play",value:function(t){"play"!==this.status&&(this.status="play",this.render(t))}},{key:"pause",value:function(){"pause"!==this.status&&(this.status="pause",clearTimeout(this.playHandler),this.playHandler=null)}},{key:"checkBuffer",value:function(){return this.imageData.checkBuffer(this.currentTime)}},{key:"push",value:function(t){if(!this.player.reseting){if(this.imageData.push(t),this.end-this.player.currentTime>N.d.READYBUFFERLENGTH&&!this.ready){this.ready=!0,this.status="ready",this.events.emit(st.ImagePlayerReady),null==this.player.startPts&&(this.player.startPts=this.imageData.start);var e=this.player.currentTime+this.player.startPts;this.render(e,!1)}this.events.emit(st.ImagePlayerBuffeUpdate)}}},{key:"find",value:function(t){return this.imageData.find(t)}},{key:"buffer",value:function(){return this.imageData.buffer()}},{key:"isBuffered",value:function(t){return this.imageData.isBuffered(t)}},{key:"render",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(t<this.imageData.offset)){var r=this.find(t);return r?(this.firstRender||(this.firstRender=!0,this.events.emit(st.PlayerLoadedMetaData,r.width,r.height)),this.screen.drawFrame(r),this.currentTime=r.pts,e&&this.events.emit(st.ImagePlayerRenderEnd,t,r.duration),r):this.maxPTS&&t>=this.maxPTS+this.fragDuration?(this.status="end",void this.events.emit(st.ImagePlayerEnd,this.maxPTS)):(this.logger.warn("Events.ImagePlayerWait",t,this.start,this.end,this.maxPTS),this.logger.warn("render","not yuv data"),this.status="wait",this.ready=!1,this.events.emit(st.ImagePlayerWait,"image","this"),!1)}}},{key:"reset",value:function(){this.status="pause",this.ready=!1,this.imageData.reset(),this.maxPTS=null,this.currentTime=0}},{key:"currentTime",set:function(t){this._currentTime=t},get:function(){return this._currentTime}},{key:"offset",get:function(){return this.imageData.offset}},{key:"fragDuration",get:function(){return Math.ceil(1e3/this.imageData.fps)}},{key:"start",get:function(){return this.imageData.start}},{key:"end",get:function(){return this.imageData.end}},{key:"duration",get:function(){return this.imageData.duration}}]),r}(M);function mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var bi=new WeakMap,ki=new WeakMap,_i=new WeakMap,wi=new WeakMap,xi=new WeakMap,Pi=function(t){c()(r,t);var e=mi(r);function r(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i()(this,r),n=e.call(this),g()(u()(n),"mode",N.c.mode),g()(u()(n),"$container",null),g()(u()(n),"componentsController",null),g()(u()(n),"controlBar",!1),g()(u()(n),"controlBarController",null),g()(u()(n),"controlBarHeight",50),g()(u()(n),"alertError",null),g()(u()(n),"dataController",null),g()(u()(n),"demuxer",null),g()(u()(n),"decoder",null),g()(u()(n),"preload",!0),g()(u()(n),"startTime",0),g()(u()(n),"screenWidth",null),g()(u()(n),"screenHeight",null),g()(u()(n),"options",{}),bi.set(u()(n),{writable:!0,value:N.c.libPath}),g()(u()(n),"readyStatus",{dataProcessor:!1,firstData:!1,audioPlayer:!1}),g()(u()(n),"reseting",!1),ki.set(u()(n),{writable:!0,value:0}),_i.set(u()(n),{writable:!0,value:!1}),wi.set(u()(n),{writable:!0,value:1}),xi.set(u()(n),{writable:!0,value:!1}),g()(u()(n),"maxBufferLength",N.d.MAXBUFFERLENGTH),g()(u()(n),"seekSegmentNo",-1),g()(u()(n),"status","init"),g()(u()(n),"loader",null),g()(u()(n),"currentIndex",null),g()(u()(n),"startIndex",1),g()(u()(n),"loadData",null),g()(u()(n),"paused",!1),g()(u()(n),"autoPlay",!0),g()(u()(n),"duration",0),g()(u()(n),"tsNumber",0),t||n.logger.error("Please pass in a dom object as the display container"),n.el=t,Object.assign(n.options,a),n.options.sourceURL=n.options.sourceURL||n.options.source,n.options.streamList=n.options.streamList||[],n.options.events=T(),n.maxBufferLength=void 0!==a.maxBufferLength?a.maxBufferLength:n.maxBufferLength,n.autoPlay=void 0!==a.autoPlay?a.autoPlay:n.autoPlay,n.controlBar=a.controlBar||n.controlBar,n.controlBarAutoHide=void 0!==a.controlBarAutoHide?a.controlBarAutoHide:n.controlBarAutoHide,k()(u()(n),bi,void 0!==a.libPath?a.libPath:m()(u()(n),bi)),n.preload=void 0===a.preload?n.preload:a.preload,n.startTime=void 0===a.startTime?n.startTime:a.startTime,n.originStartTime=n.startTime,n.playbackRate=void 0===a.playbackRate?n.playbackRate:a.playbackRate,n}return o()(r,[{key:"setAlertError",value:function(){this.options.alertError=this.alertError=O.getInstance({player:this,component:this.componentsController.alertBox,events:this.options.events})}},{key:"setDataController",value:function(){this.dataController=It.getInstance({player:this,events:this.options.events})}},{key:"setLoadData",value:function(){this.dataController.setLoadData({player:this,events:this.options.events}),this.loadData=this.dataController.loadData}},{key:"setComponentsController",value:function(){this.componentsController=Jn.getInstance({$container:this.$container,$screenContainer:this.$screenContainer,$canvas:this.$canvas,$audioContainer:this.$audioContainer,$audio:this.$audio,loadData:this.loadData,bigPlayButtonColor:this.bigPlayButtonColor,player:this,events:this.options.events})}},{key:"setControlBarController",value:function(){var t=Object.assign({},this.options,{$container:this.$container,$screenContainer:this.$screenContainer,controlBar:this.controlBar,controlBarAutoHide:this.controlBarAutoHide,player:this});this.controlBarController=ei.getInstance(t)}},{key:"setLoadController",value:function(){this.loaderController=Tt.getInstance(this.options.type,{player:this,events:this.options.events})}},{key:"setProcessorController",value:function(){this.processController=new ai({type:"ts",codec:this.options.codec,libPath:m()(this,bi),events:this.options.events,player:this})}},{key:"setStreamController",value:function(){this.streamController=new si({events:this.options.events,loadData:this.loadData,imagePlayer:this.imagePlayer,audioPlayer:this.audioPlayer,player:this})}},{key:"setImagerPlayer",value:function(){this.imagePlayer=new vi({events:this.options.events,canvas:this.$canvas,maxBufferLength:this.maxBufferLength,player:this})}},{key:"setAudioPlayer",value:function(){this.audioPlayer=new He({player:this,events:this.options.events,audioNode:this.$audio})}},{key:"setAction",value:function(){this.action=new Nt({player:this,screen:this.screen,imagePlayer:this.imagePlayer,loadData:this.loadData,audioPlayer:this.audioPlayer,events:this.options.events})}},{key:"init",value:function(){this.controlBarHeight=this.options.controlBarHeight||this.controlBarHeight,this.options.httpWorker=ni()(104,{name:"httpWorker"}),this.currentTime=this.startTime,this.addEl(),this.setDataController(),this.setLoadData(),this.setLoadController(),this.setComponentsController(),this.setControlBarController(),this.componentsController.setControlBarController(this.controlBarController),this.setProcessorController(),this.setAlertError(),this.componentsController.drawPoster(),this.setImagerPlayer(),this.setAudioPlayer(),this.setAction(),this.setStreamController(),this.preload&&this.run(),this.bindEvent()}},{key:"bindEvent",value:function(){var t=this;this.events.on(st.PlayerOnPlay,(function(){t.play()})),this.events.on(st.PlayerOnPause,(function(){t.pause()})),this.events.on(st.PlayerOnVolume,(function(e){t.volume=e})),this.events.on(st.DataProcessorReady,(function(){t.logger.info("bindEvent","decoder ready"),t.checkReady("dataProcessor")})),this.events.on(st.AudioPlayerReady,(function(){t.logger.info("bindEvent","audioPlayer ready"),t.seeking||t.checkReady("audioPlayer")})),this.events.on(st.PlayerReady,(function(){t.logger.info("bindEvent","player ready"),t.onReady()})),this.events.on(st.PlayerSpeedTo,(function(e){t.changeSpeed(e)})),this.events.on(st.PlayerChangeRate,(function(e){t.changeRate(e)})),this.events.on(st.PlayerWait,(function(){t.onWait()})),this.events.on(st.PlayerPlay,(function(){t.onPlay()})),this.events.on(st.LoaderPlayListLoaded,(function(e){"function"==typeof t.options.afterLoadPlaylist&&t.options.afterLoadPlaylist(t.laodData.sourceData);var r=e.loadData.sourceData;t.duration=r.duration,t.tsNumber=r.length,t.streamController.setBaseInfo({duration:t.duration,tsNumber:t.tsNumber}),t.dataController.startLoad(t.startTime),t.setStartTime(t.originStartTime)})),this.events.on(st.LoadDataFirstLoaded,(function(e){t.logger.info("bindEvent","first data ready"),t.startIndex=e.no,t.streamController.currentIndex=e.no,t.checkReady("firstData")})),this.events.on(st.StreamDataReady,(function(){t.logger.info("bindEvent","dataReady"),t.onDataReady()})),this.events.on(st.PlayerLoadedMetaData,(function(e,r){t.setCanvas(),t.resizeScreen(e,r)})),this.events.on(st.PlayerEnd,(function(){t.status="end"})),this.events.on(st.ImagePlayerBuffeUpdate,(function(){var e=t.buffer();t.events.emit(st.PlayerbufferUpdate,e)})),this.events.on(st.PlayerOnSeek,(function(e){t.seek(Math.floor(e))})),this.events.on(st.PlayerAlert,(function(e){t.alertError.show(e)})),this.events.on(st.PlayerThrowError,(function(e){U.a.apply(t,e)})),this.events.on(st.PlayerTimeUpdate,(function(e){t.options.onTimeupdate&&t.options.onTimeupdate(e)}))}},{key:"reset",value:function(t){this.action&&this.action.reset(t)}},{key:"switchPlaylist",value:function(t,e){this.loaderController.switchPlaylist(t,e)}},{key:"changeSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.playbackRate=t.value||1}},{key:"setStartTime",value:function(t){this.startTime=t}},{key:"changeRate",value:function(t){this.pause(),this.events.emit(st.ControlBarPauseLoading,this),this.setStartTime((this.currentTime-5e3)/1e3),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.reset(!0),this.switchPlaylist(t.url)}},{key:"changeSrc",value:function(t,e){this.pause(),this.events.emit(st.ControlBarPauseLoading,this),this.events.emit(st.PlayerChangeSrc,this),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.currentTime=this.startTime,this.imagePlayer.clear(),this.reset(!0),this.switchPlaylist(t,e)}},{key:"setCanvas",value:function(){var t=We.createCanvas(this);if(L.isElement(this.$canvas)){if(this.$canvas.width&&this.$canvas.height)return this.imagePlayer.setScreenRender(t),this.$canvas.replaceWith(t),void(this.$canvas=t)}else this.$screen.appendChild(t),this.$canvas=t}},{key:"destroy",value:function(){this.controlBarController&&(this.controlBarController.destroy(),delete this.controlBarController),this.$container&&(this.el.removeChild(this.$container),delete this.$container),this.processController.destroy(),this.loaderController.destroy()}},{key:"run",value:function(){this.loaderController.run()}},{key:"checkReady",value:function(t){var e=this.readyStatus;if(t&&"string"==typeof t){e[t]=!0;for(var r=Object.keys(e),n=0;n<r.length;n++)if(!e[r[n]])return!1;return this.logger.info("checkReady","player ready"),this.events.emit(st.PlayerReady),!0}return this.logger.error("checkReady","check ready","type is no correct, type:",t),!1}},{key:"addEl",value:function(){var t,e,r,n;this.el?(t=We.createContainer(this),this.el.appendChild(t),this.$container=t,e=We.createScreenContainer(this),this.$screen=e,t.appendChild(e),this.$screenContainer=e,this.setCanvas(),n=We.createAudio(this),this.$audio=n,(r=We.createAudioContainer(this)).appendChild(n),this.$audioContainer=r,t.appendChild(r)):this.logger.error("addEl","not found el.","el:",this.options.el)}},{key:"onWait",value:function(){this.logger.info("onWait","wait,wait,wait")}},{key:"onPlay",value:function(){this.logger.info("onPlay","play, play, play")}},{key:"onReady",value:function(){this.changing||this.componentsController.run(),this.changing&&this.logger.info("onReady","change ready","startIndex:",this.startIndex),this.streamController.startLoad(this.startIndex)}},{key:"onDataReady",value:function(){this.changing&&(this.changing=!1,this.play()),"playing"===this.statusBeforeSeek||this.autoPlay&&!this.paused?this.play():this.events.emit(st.ControlBarPause)}},{key:"buffer",value:function(){var t=this.imagePlayer.buffer(),e=this.audioPlayer.buffer(),r=Math.max(t.start,e.start),n=Math.min(t.end,e.end);return r<n?[r,n]:[0,0]}},{key:"play",value:function(){this.logger.info("play",this.status),"playing"!==this.status&&(this.logger.info("start play"),this.status="playing",this.paused=!1,this.action.play(this.currentTime+this.startPts),this.events.emit(st.PlayerPlay,this))}},{key:"on",value:function(t,e){this.events.on("Player."+t,e)}},{key:"off",value:function(t,e){this.events.off("Player."+t,e)}},{key:"once",value:function(t,e){this.events.once("Player."+t,e)}},{key:"pause",value:function(){"pause"!=this.status&&(this.logger.info("pause"),this.status="pause",this.action.pause(),this.paused=!0,this.events.emit(st.PlayerPause,this))}},{key:"seek",value:function(t){t<this.startTime||(t>=1e3*this.duration?this.logger.info("seek","seek to time:",t):(this.statusBeforeSeek=this.status,this.seekTime=Date.now(),this.seeking=!0,this.currentTime=t,this.action.seek(t+this.startPts)))}},{key:"resizeScreen",value:function(t,e){L.adaptSizeElement(t,e,this.$screenContainer,this.$canvas)}},{key:"muted",get:function(){return m()(this,xi)},set:function(t){k()(this,xi,!!t)}},{key:"playbackRate",set:function(t){k()(this,wi,t)},get:function(){return m()(this,wi)}},{key:"seeking",set:function(t){k()(this,_i,t),t?this.events.emit(st.PlayerSeeking):this.events.emit(st.PlayerSeekEnd)},get:function(){return m()(this,_i)}},{key:"currentTime",get:function(){return m()(this,ki)},set:function(t){k()(this,ki,t)}},{key:"volume",get:function(){return this.audioPlayer.volume},set:function(t){this.audioPlayer.volume=t}}]),r}(M);r(110);function Ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p()(t);if(e){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var Ti=function(t){c()(r,t);var e=Ei(r);function r(t,n){var a;return i()(this,r),a=e.call(this,t,n),g()(u()(a),"libPath",null),a.options.processURL=n.processURL,a.libPath=n.libPath,!1!==a.options.needInit&&a.init(),a}return o()(r,null,[{key:"getComponent",value:function(t){return Yn[t]}},{key:"registerComponent",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if("string"!=typeof t||!t)throw new Error('Illegal component name, "'.concat(t,'"; must be a non-empty string.'));var i=Object.prototype.isPrototypeOf.call(ur,e.prototype);if(!i)throw new Error('Illegal component, "'.concat(t,'"; must be a BaseComponent subclass.'));Yn[t]=e,Jn.addComponet(t),"left"===r?zn.addCustomControl(t,n):$n.addCustomControl(t,n)}}]),r}(Pi);e.default=Ti},function(t,e){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=r(95),i=r(96),a=r(97);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return l(this,t,e,r)}function l(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,r),i=(t=s(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(u.isBuffer(e)){var r=0|d(e.length);return 0===(t=s(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(t,0):f(t,e);if("Buffer"===e.type&&a(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function f(t,e){var r=e.length<0?0:0|d(e.length);t=s(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return j(t).length;default:if(n)return F(t).length;e=(""+e).toLowerCase(),n=!0}}function y(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return T(this,e,r);case"ascii":return B(this,e,r);case"latin1":case"binary":return S(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){var a,o=1,s=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,r/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var c=-1;for(a=r;a<s;a++)if(l(t,a)===l(e,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(r+u>s&&(r=s-u),a=r;a>=0;a--){for(var h=!0,f=0;f<u;f++)if(l(t,a+f)!==l(e,f)){h=!1;break}if(h)return a}return-1}function b(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[r+o]=s}return o}function k(t,e,r,n){return $(F(e,t.length-r),t,r,n)}function _(t,e,r,n){return $(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function w(t,e,r,n){return _(t,e,r,n)}function x(t,e,r,n){return $(j(e),t,r,n)}function P(t,e,r,n){return $(function(t,e){for(var r,n,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,a.push(i),a.push(n);return a}(e,t.length-r),t,r,n)}function E(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function T(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var a,o,s,u,l=t[i],c=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=r)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(a=t[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,r){return l(null,t,e,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,r){return function(t,e,r,n){return c(e),e<=0?s(t,e):void 0!==r?"string"==typeof n?s(t,e).fill(r,n):s(t,e).fill(r):s(t,e)}(null,t,e,r)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,a=Math.min(r,n);i<a;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=u.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):y.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,r,n,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),s=Math.min(a,o),l=this.slice(n,i),c=t.slice(e,r),h=0;h<s;++h)if(l[h]!==c[h]){a=l[h],o=c[h];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return k(this,t,e,r);case"ascii":return _(this,t,e,r);case"latin1":case"binary":return w(this,t,e,r);case"base64":return x(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function R(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=e;a<r;++a)i+=H(t[a]);return i}function L(t,e,r){for(var n=t.slice(e,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function D(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,r,n,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function A(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-r,2);i<a;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function I(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-r,4);i<a;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function O(t,e,r,n,i,a){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,n,a){return a||O(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function M(t,e,r,n,a){return a||O(t,0,r,8),i.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;r=new u(i,void 0);for(var a=0;a<i;++a)r[a]=this[a+t]}return r},u.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return n},u.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},u.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var n=e,i=1,a=this[t+--n];n>0&&(i*=256);)a+=this[t+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||C(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[e]=255&t;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r},u.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||C(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r},u.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):A(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):A(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);C(this,t,e,r,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<r&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);C(this,t,e,r,i-1,-i)}var a=r-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):A(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):A(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return M(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return M(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,a=n-r;if(this===t&&r<e&&e<n)for(i=a-1;i>=0;--i)t[i+e]=this[i+r];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),e);return a},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(a=e;a<r;++a)this[a]=t;else{var o=u.isBuffer(t)?t:F(new u(t,n).toString()),s=o.length;for(a=0;a<r-e;++a)this[a+e]=o[a%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function H(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var r;e=e||1/0;for(var n=t.length,i=null,a=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function j(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(70))},function(t,e,r){"use strict";e.byteLength=function(t){var e=l(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,n=l(t),o=n[0],s=n[1],u=new a(function(t,e,r){return 3*(e+r)/4-r}(0,o,s)),c=0,h=s>0?o-4:o;for(r=0;r<h;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;2===s&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,u[c++]=255&e);1===s&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e);return u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,a=[],o=0,s=r-i;o<s;o+=16383)a.push(c(t,o,o+16383>s?s:o+16383));1===i?(e=t[r-1],a.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],a.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return a.join("")};for(var n=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,r){for(var i,a,o=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,i){var a,o,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,d=t[e+h];for(h+=f,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+t[e+h],h+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+t[e+h],h+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),a-=l}return(d?-1:1)*o*Math.pow(2,a-n)},e.write=function(t,e,r,n,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(e*u-1)*Math.pow(2,i),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;t[r+d]=255&o,d+=p,o/=256,l-=8);t[r+d-p]|=128*y}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){(function(e){var r;r="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(this,r(70))},function(t,e,r){!function(){"use strict";var e=r(51),n=r(100);function i(t){var e=t.getContext("2d"),r=null,i=null,a=null;return this.drawFrame=function(o){var s=o.format;t.width===s.displayWidth&&t.height===s.displayHeight||(t.width=s.displayWidth,t.height=s.displayHeight),null!==r&&r.width==s.width&&r.height==s.height||function(t,n){for(var i=(r=e.createImageData(t,n)).data,a=t*n*4,o=0;o<a;o+=4)i[o+3]=255}(s.width,s.height),n.convertYCbCr(o,r.data);var u,l,c,h=s.cropWidth!=s.displayWidth||s.cropHeight!=s.displayHeight;h?(i||(l=s.cropWidth,c=s.cropHeight,(i=document.createElement("canvas")).width=l,i.height=c,a=i.getContext("2d")),u=a):u=e,u.putImageData(r,-s.cropLeft,-s.cropTop,s.cropLeft,s.cropTop,s.cropWidth,s.cropHeight),h&&e.drawImage(i,0,0,s.displayWidth,s.displayHeight)},this.clear=function(){e.clearRect(0,0,t.width,t.height)},this}i.prototype=Object.create(e.prototype),t.exports=i}()},function(t,e,r){!function(){"use strict";var e=r(101);
/**
	 * Basic YCbCr->RGB conversion
	 *
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright 2014-2019
	 * @license MIT-style
	 *
	 * @param {YUVFrame} buffer - input frame buffer
	 * @param {Uint8ClampedArray} output - array to draw RGBA into
	 * Assumes that the output array already has alpha channel set to opaque.
	 */t.exports={convertYCbCr:function(t,r){var n=0|t.format.width,i=0|t.format.height,a=0|e(t.format.width/t.format.chromaWidth),o=0|e(t.format.height/t.format.chromaHeight),s=t.y.bytes,u=t.u.bytes,l=t.v.bytes,c=0|t.y.stride,h=0|t.u.stride,f=0|t.v.stride,d=n<<2,p=0,y=0,g=0,v=0,m=0,b=0,k=0,_=0,w=0,x=0,P=0,E=0,T=0,B=0,S=0,R=0,L=0,D=0;if(1==a&&1==o)for(k=0,_=d,D=0,R=0;R<i;R+=2){for(g=(y=R*c|0)+c|0,v=D*h|0,m=D*f|0,S=0;S<n;S+=2)w=0|u[v++],E=(409*(x=0|l[m++])|0)-57088|0,T=(100*w|0)+(208*x|0)-34816|0,B=(516*w|0)-70912|0,P=298*s[y++]|0,r[k]=P+E>>8,r[k+1]=P-T>>8,r[k+2]=P+B>>8,k+=4,P=298*s[y++]|0,r[k]=P+E>>8,r[k+1]=P-T>>8,r[k+2]=P+B>>8,k+=4,P=298*s[g++]|0,r[_]=P+E>>8,r[_+1]=P-T>>8,r[_+2]=P+B>>8,_+=4,P=298*s[g++]|0,r[_]=P+E>>8,r[_+1]=P-T>>8,r[_+2]=P+B>>8,_+=4;k+=d,_+=d,D++}else for(b=0,R=0;R<i;R++)for(L=0,p=R*c|0,v=(D=R>>o)*h|0,m=D*f|0,S=0;S<n;S++)w=0|u[v+(L=S>>a)],E=(409*(x=0|l[m+L])|0)-57088|0,T=(100*w|0)+(208*x|0)-34816|0,B=(516*w|0)-70912|0,P=298*s[p++]|0,r[b]=P+E>>8,r[b+1]=P-T>>8,r[b+2]=P+B>>8,b+=4}}}()},function(t,e){!function(){"use strict";
/**
   * Convert a ratio into a bit-shift count; for instance a ratio of 2
   * becomes a bit-shift of 1, while a ratio of 1 is a bit-shift of 0.
   *
   * @author Brion Vibber <brion@pobox.com>
   * @copyright 2016
   * @license MIT-style
   *
   * @param {number} ratio - the integer ratio to convert.
   * @returns {number} - number of bits to shift to multiply/divide by the ratio.
   * @throws exception if given a non-power-of-two
   */t.exports=function(t){for(var e=0,r=t>>1;0!=r;)r>>=1,e++;if(t!==1<<e)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+t;return e}}()},function(t,e,r){!function(){"use strict";var e=r(51),n=r(103);function i(t){var e,r,a=this,o=i.contextForCanvas(t);if(null===o)throw new Error("WebGL unavailable");function s(t,e){var r=o.createShader(t);if(o.shaderSource(r,e),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS)){var n=o.getShaderInfoLog(r);throw o.deleteShader(r),new Error("GL shader compilation for "+t+" failed: "+n)}return r}var u,l,c,h,f,d,p,y,g,v,m=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),b={},k={},_={};function w(t){return b[t]||(b[t]=o.createTexture()),b[t]}function x(t,e,r,n){var a=w(t);if(o.activeTexture(o.TEXTURE0),i.stripe){var s=!b[t+"_temp"],u=w(t+"_temp");o.bindTexture(o.TEXTURE_2D,u),s?(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e/4,r,0,o.RGBA,o.UNSIGNED_BYTE,n)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,e/4,r,o.RGBA,o.UNSIGNED_BYTE,n);var l=b[t+"_stripe"],c=!l;c&&(l=w(t+"_stripe")),o.bindTexture(o.TEXTURE_2D,l),c&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,1,0,o.RGBA,o.UNSIGNED_BYTE,function(t){if(_[t])return _[t];for(var e=t,r=new Uint32Array(e),n=0;n<e;n+=4)r[n]=255,r[n+1]=65280,r[n+2]=16711680,r[n+3]=4278190080;return _[t]=new Uint8Array(r.buffer)}(e)))}else o.bindTexture(o.TEXTURE_2D,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.LUMINANCE,e,r,0,o.LUMINANCE,o.UNSIGNED_BYTE,n)}function P(t,e,n){var i=b[t];o.useProgram(r);var a=k[t];a||(o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,n,0,o.RGBA,o.UNSIGNED_BYTE,null),a=k[t]=o.createFramebuffer()),o.bindFramebuffer(o.FRAMEBUFFER,a),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,i,0);var s=b[t+"_temp"];o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,s),o.uniform1i(d,1);var p=b[t+"_stripe"];o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,p),o.uniform1i(f,2),o.bindBuffer(o.ARRAY_BUFFER,u),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,c),o.enableVertexAttribArray(h),o.vertexAttribPointer(h,2,o.FLOAT,!1,0,0),o.viewport(0,0,e,n),o.drawArrays(o.TRIANGLES,0,m.length/2),o.bindFramebuffer(o.FRAMEBUFFER,null)}function E(t,r,n){o.activeTexture(r),o.bindTexture(o.TEXTURE_2D,b[t]),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.uniform1i(o.getUniformLocation(e,t),n)}function T(t,e){var r=s(o.VERTEX_SHADER,t),n=s(o.FRAGMENT_SHADER,e),i=o.createProgram();if(o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),!o.getProgramParameter(i,o.LINK_STATUS)){var a=o.getProgramInfoLog(i);throw o.deleteProgram(i),new Error("GL program linking failed: "+a)}return i}return a.drawFrame=function(s){var b=s.format,k=!e||t.width!==b.displayWidth||t.height!==b.displayHeight;if(k&&(t.width=b.displayWidth,t.height=b.displayHeight,a.clear()),e||function(){if(i.stripe){r=T(n.vertexStripe,n.fragmentStripe),o.getAttribLocation(r,"aPosition"),c=o.createBuffer();var t=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);o.bindBuffer(o.ARRAY_BUFFER,c),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),h=o.getAttribLocation(r,"aTexturePosition"),f=o.getUniformLocation(r,"uStripe"),d=o.getUniformLocation(r,"uTexture")}e=T(n.vertex,n.fragment),u=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,m,o.STATIC_DRAW),l=o.getAttribLocation(e,"aPosition"),p=o.createBuffer(),y=o.getAttribLocation(e,"aLumaPosition"),g=o.createBuffer(),v=o.getAttribLocation(e,"aChromaPosition")}(),k){var _=function(t,e,r){var n=b.cropLeft/r,i=(b.cropLeft+b.cropWidth)/r,a=(b.cropTop+b.cropHeight)/b.height,s=b.cropTop/b.height,u=new Float32Array([n,a,i,a,n,s,n,s,i,a,i,s]);o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,u,o.STATIC_DRAW)};_(p,0,s.y.stride),_(g,0,s.u.stride*b.width/b.chromaWidth)}x("uTextureY",s.y.stride,b.height,s.y.bytes),x("uTextureCb",s.u.stride,b.chromaHeight,s.u.bytes),x("uTextureCr",s.v.stride,b.chromaHeight,s.v.bytes),i.stripe&&(P("uTextureY",s.y.stride,b.height),P("uTextureCb",s.u.stride,b.chromaHeight),P("uTextureCr",s.v.stride,b.chromaHeight)),o.useProgram(e),o.viewport(0,0,t.width,t.height),E("uTextureY",o.TEXTURE0,0),E("uTextureCb",o.TEXTURE1,1),E("uTextureCr",o.TEXTURE2,2),o.bindBuffer(o.ARRAY_BUFFER,u),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p),o.enableVertexAttribArray(y),o.vertexAttribPointer(y,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,g),o.enableVertexAttribArray(v),o.vertexAttribPointer(v,2,o.FLOAT,!1,0,0),o.drawArrays(o.TRIANGLES,0,m.length/2)},a.clear=function(){o.viewport(0,0,t.width,t.height),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)},a.clear(),a}i.stripe=-1!==navigator.userAgent.indexOf("Windows"),i.contextForCanvas=function(t){var e={preferLowPowerToHighPerformance:!0,powerPreference:"low-power",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};return t.getContext("webgl",e)||t.getContext("experimental-webgl",e)},i.isAvailable=function(){var t,e=document.createElement("canvas");e.width=1,e.height=1;try{t=i.contextForCanvas(e)}catch(t){return!1}if(t){var r=t.TEXTURE0,n=t.createTexture(),a=new Uint8Array(16),o=i.stripe?1:4,s=i.stripe?t.RGBA:t.LUMINANCE,u=i.stripe?t.NEAREST:t.LINEAR;return t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,u),t.texImage2D(t.TEXTURE_2D,0,s,o,4,0,s,t.UNSIGNED_BYTE,a),!t.getError()}return!1},i.prototype=Object.create(e.prototype),t.exports=i}()},function(t,e){t.exports={vertex:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aLumaPosition;\nattribute vec2 aChromaPosition;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vLumaPosition = aLumaPosition;\n    vChromaPosition = aChromaPosition;\n}\n",fragment:"// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js\n\nprecision lowp float;\n\nuniform sampler2D uTextureY;\nuniform sampler2D uTextureCb;\nuniform sampler2D uTextureCr;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n   // Y, Cb, and Cr planes are uploaded as LUMINANCE textures.\n   float fY = texture2D(uTextureY, vLumaPosition).x;\n   float fCb = texture2D(uTextureCb, vChromaPosition).x;\n   float fCr = texture2D(uTextureCr, vChromaPosition).x;\n\n   // Premultipy the Y...\n   float fYmul = fY * 1.1643828125;\n\n   // And convert that to RGB!\n   gl_FragColor = vec4(\n     fYmul + 1.59602734375 * fCr - 0.87078515625,\n     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,\n     fYmul + 2.017234375   * fCb - 1.081390625,\n     1\n   );\n}\n",vertexStripe:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aTexturePosition;\nvarying vec2 vTexturePosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vTexturePosition = aTexturePosition;\n}\n",fragmentStripe:"// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures\n\nprecision lowp float;\n\nuniform sampler2D uStripe;\nuniform sampler2D uTexture;\nvarying vec2 vTexturePosition;\nvoid main() {\n   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture\n   // so we can upload them without expanding the bytes on IE 11\n   // which doesn't allow LUMINANCE or ALPHA textures\n   // The stripe textures mark which channel to keep for each pixel.\n   // Each texture extraction will contain the relevant value in one\n   // channel only.\n\n   float fLuminance = dot(\n      texture2D(uStripe, vTexturePosition),\n      texture2D(uTexture, vTexturePosition)\n   );\n\n   gl_FragColor = vec4(fLuminance, fLuminance, fLuminance, 1);\n}\n"}},function(t,e,r){"use strict";r.r(e);var n=r(3),i=r.n(n),a=r(4),o=r.n(a),s=r(0),u=r.n(s),l=r(63),c=r.n(l),h=r(11),f=r.n(h),d=r(18),p=r.n(d),y=r(28),g=r.n(y),v=r(10),m=r(23);function b(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _=v.a.get("HTTP.js",{level:2}),w=function(){var t=g()(p.a.mark((function t(e){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e instanceof Blob)){t.next=5;break}return t.next=3,new Response(e).arrayBuffer();case 3:return r=t.sent,t.abrupt("return",new Uint8Array(r,0));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var x=function(t){if(t)return Object.entries(t).reduce((function(t,e,r){var n=c()(e,2),i=n[0],a=n[1];return t+(0===r?i+"="+encodeURIComponent(a):"&"+i+"="+encodeURIComponent(a))}),"")};function P(t,e){var r=("function"==typeof t.clone?t.clone():void 0)||t,n=function(t,e){var r={body:e,headers:function(t){return t.headers.entries?function(t){var e,r=Object.create(Object.getPrototypeOf(t.headers)),n=b(t.headers.entries());try{for(n.s();!(e=n.n()).done;){var i=c()(e.value,2),a=i[0],o=i[1];r[a]=o}}catch(t){n.e(t)}finally{n.f()}return r}(t):function(t){var e={},r=t.headers.__headers__;for(var n in r)e[n]=r[n].join("");return e}(t)}(t),response:t,status:t.status,statusText:t.statusText};return t.ok?Promise.resolve(r):Promise.reject(r)};return t[e]().then((function(t){return n(r,t)}))}function E(t,e){var r=t.headers.get("content-type"),n=t.clone().body.getReader(),i=0,a=i,o=setInterval((function(){var t=50*(i-a);t<=1||(_.info("HTTP>handleResponse","".concat(a," | ").concat(i),"".concat(t.toFixed(2)," Bytes/s")),self.postMessage({type:"notice",method:"fetch",noticeType:"speed",data:{speed:t,intervalValue:20,lastReceived:a,bytesReceived:i}}),a=i)}),20);return n.read().then((function a(s){return s.done?(clearInterval(o),function(){if("ts"===e||"video"===e)return P(t,"blob");if(r.includes("json"))return P(t,"json");if(r.includes("text"))return P(t,"text");if(r.includes("form"))return P(t,"formData");if(r.includes("video")||r.includes("image")||r.includes("octet-stream"))return P(t,"blob");try{return P(t,"text")}catch(e){return Object(m.a)(e,"[HTTP>handleResponse:unknow content-type]",r,t),Promise.resolve(t)}}()):(i+=s.value.length,n.read().then(a))}))}var T=null,B=(T||(T=new(function(){function t(e){i()(this,t),u()(this,"options",{"content-type":"application/json;charset=UTF-8",cache:"no-cache",mode:"cors"}),Object.assign(this.options,e)}var e;return o()(t,[{key:"setOptions",value:function(t){var e=Object.assign(this.options,t);e.url=function(t){var e=t.url,r=t.params;return r?e+"?"+x(r):e}(e),e.method=e.method||"get",e.headers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.headers,r=void 0===e?{}:e,n=t.method,i=void 0===n?"get":n,a=t.username,o=t.password,s=t.token,u=new Headers(r);if(a||o){if(!a)throw new TypeError("username required for basic authentication");if(!o)throw new TypeError("password required for basic authentication");var l="object"===("undefined"==typeof win?"undefined":f()(win))&&win.btoa?btoa:function(t){return t};u.set("Authorization","Basic "+l(a+":"+o))}return s&&u.set("Authorization","Bearer "+s),"get"===i||u.get("content-type")||u.set("content-type","application/json"),u}(e),e.body=function(t){var e=t.headers.get("content-type");if(e)return e.includes("json")?JSON.stringify(t.body):e.includes("x-www-form-urlencoded")?x(t.body):t.body}(e),delete e.username,delete e.password,delete e.token,this.options=e}},{key:"request",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(t)return this.setOptions(Object.assign({url:t},e)),fetch(this.options.url,this.options).then((function(t){return E(t,r)}));_.error("[HTTP>request]","url is undefined","url:",t,"options:",e)}},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=g()(p.a.mark((function t(e){var r,n,i,a,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,e){t.next=6;break}return _.wran("[HTTP>fetch]","url is undefined","url:",e,"options:",r),t.abrupt("return");case 6:return this.setOptions(Object.assign({url:e},r)),_.info("[HTTP>fetch]","http fetch","url:",e,"options:",r),t.next=10,fetch(e,r);case 10:(a=t.sent).ok?a.text().then((function(t){self.postMessage({type:"invoke",method:"fetch",fileType:i,name:n,data:t})})):self.postMessage({result:"failed"});case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())},{key:"get",value:(e=g()(p.a.mark((function t(e){var r,n,i,a,o,s=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2?s[2]:void 0,i=s.length>3?s[3]:void 0,r.method="get",_.info("[HTTP>get]","http get","url:",e,"options:",r,"name:",n,"fileType:",i),o={type:"invoke",method:"get",fileType:i,name:n,url:e},t.prev=6,t.next=9,this.request.call(this,e,r,i);case 9:a=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),_.error("[HTTP>get]","networks error","url:",e,"options:",r,"name:",n,"fileType:",i,"ex:",t.t0);case 15:if(!a||!a.body){t.next=24;break}if(o.data=a.body,"ts"!==i&&"video"!==i){t.next=21;break}return t.next=20,w(o.data);case 20:o.arrayBuffer=t.sent;case 21:o.arrayBuffer?self.postMessage(o,[o.arrayBuffer.buffer]):self.postMessage(o),t.next=27;break;case 24:o.type="error",o.data=a,self.postMessage(o);case 27:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(t){return e.apply(this,arguments)})}]),t}())({})),T);e.default=function(t){t.onmessage=function(t){var e=t.data,r=e.type,n=e.method;switch(r){case"invoke":B[n].call(B,e.url,e.options,e.name,e.fileType)}}}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}},function(t,e,r){var n=r(108);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,r){var n=r(111);"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(113)(n,i);n.locals&&(t.exports=n.locals)},function(t,e,r){(t.exports=r(112)(!1)).push([t.i,'.goldplay{background:transparent}gp-button{cursor:pointer;font-size:14px}@-webkit-keyframes goldplay-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes goldplay-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.goldplay-btn{border:1px outset;text-align:center;display:inline-block;cursor:pointer}.goldplay-hoverbox{background:rgba(70,70,70,.8);border-radius:3px;visibility:hidden;display:inline-block;position:absolute;font-size:14px}.goldplay-hoverbox ul li{height:24px}.goldplay-hoverbox .gp-selected{color:#f60}.goldplay__container{display:block;z-index:9999;font-family:Arial,Helvetica,sans-serif;background:#000}.goldplay__container-fullpage,.goldplay__container-fullscreen{position:absolute;width:100%;height:100%;line-height:100%;left:0;top:0}.goldplay__container *{-webkit-box-sizing:border-box;box-sizing:border-box}.goldplay__container svg{overflow:auto;-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto;display:inline-block;width:auto;height:auto}.goldplay__container li,.goldplay__container ul{list-style:none}.goldplay__screen--bigplay{z-index:299;opacity:0;-webkit-transition:opacity 1s;transition:opacity 1s}.goldplay__screen--bigplay,.goldplay__screen--poster{color:#fff;text-align:center;font-family:Arial,Helvetica,sans-serif;position:absolute;display:inline-block}.goldplay__screen--poster{vertical-align:middle;z-index:399;opacity:1;-webkit-transition:opacity 2s;transition:opacity 2s}.goldplay__screen--poster-image{margin:auto;text-align:center;vertical-align:middle;-webkit-filter:"";filter:""}.goldplay__screen--poster-speed{display:block}.goldplay__control--container{width:auto;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 5px;background:transparent;opacity:0;-webkit-transition:opacity 1s;transition:opacity 1s;display:block}.goldplay__control--container-float{position:absolute;margin-top:-50px}.goldplay__control--nearside{padding-top:4px;margin-left:10px;display:block}.goldplay__control--sidebar{padding-top:4px;float:right;display:block}.goldplay__control--container.canvas{position:absolute}.goldplay__screen--container{width:100%;display:block}.goldplay__progress-bar{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;background:hsla(0,15%,90%,.4);height:3px;border-radius:5px;line-height:3px;margin:6px 0;display:inline-block}.goldplay__progress-bar:hover{height:5px;line-height:5px;margin:5px 0;border-top:1px solid transparent}.goldplay__progress-bar:hover .goldplay__progressbar--load,.goldplay__progress-bar:hover .goldplay__progressbar--play{height:5px;line-height:5px;margin-top:-1px}.goldplay__progress-bar-hover{height:5px;line-height:5px;margin:5px 0;border-radius:5px}.goldplay__progressbar--load-hover,.goldplay__progressbar--play-hover{height:5px!important;line-height:5px!important}.goldplay__control--button-block{display:inline-block}.goldplay__control--play{display:none;width:20px}.goldplay__control--replay{display:none;margin:-4px 0 0 -4px}.goldplay__control--pause{display:none;width:20px}.goldplay__control--pause-loading{margin:-5px 0 0 -5px}.goldplay__waiting-bar{position:absolute;text-align:center;color:#fff;z-index:98;display:none;opacity:.7}.goldplay__waiting-bar--icon{width:120px;text-align:center;display:block}.goldplay__waiting-bar img{opacity:.3}.goldplay__waiting-bar--speed{display:block}.goldplay__progressbar--play{height:3px;border-radius:5px;background-color:rgba(255,80,0,.8);position:absolute}.goldplay__progressbar--load{height:3px;border-radius:5px;background-color:hsla(0,0%,100%,.8);position:absolute}.goldplay__progressbar--dot{position:absolute}.goldplay__progressbar--dot:before{content:"";display:inline-block;width:12px;height:12px;background:#fff;margin-top:-5px;border-radius:50%;border:1px solid #f1f1f1;background-image:-webkit-radial-gradient(circle arthest-corner at 45px 45px,#b0b9be,#191611);-webkit-box-shadow:0 0 2px 0 rgba(0,0,0,.26);box-shadow:0 0 2px 0 rgba(0,0,0,.26);cursor:-webkit-grab;cursor:grab}.goldplay__progressbar--dot-hover:before,.goldplay__progressbar--dot:hover:before{background:#f60;border:1px solid #f60;-webkit-box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);-webkit-transform:scale(1);transform:scale(1);-webkit-transition:-webkit-transform .15s ease-in-out;transition:-webkit-transform .15s ease-in-out;transition:transform .15s ease-in-out;transition:transform .15s ease-in-out,-webkit-transform .15s ease-in-out}.goldplay__control--timer{font-size:.9em;color:#ccc;margin:3px 5px 0;display:inline-block;-webkit-transform:translateY(-5px);transform:translateY(-5px)}.goldplay__control--timer-total{color:#999}.goldplay__volume-bar--handle{height:100px;width:20px;margin:-122px 0 0;cursor:default}.goldplay__volume-bar--column{background:hsla(0,14%,92%,.5);width:4px;top:15px;left:8px;height:80px;position:absolute}.goldplay__volume-bar--precent{position:absolute;top:2px;width:100%;text-align:center;color:#f1f1f1;font-size:10px;cursor:text}.goldplay__volume-bar--size{background:#f60;left:8px;z-index:2;position:absolute}.goldplay__volume-bar--rod{position:absolute;left:5px;z-index:3}.goldplay__volume-bar--rod:before{content:"";display:table;width:12px;height:12px;background:#fff;margin-top:0;margin-left:-2px;border-radius:50%;border:1px solid #f1f1f1;background-image:radial-gradient(circle arthest-corner at 45px,at 45px,#b0b9be,#191611);background-image:radial-gradient(circle arthest-corner at 45px 45px,#b0b9be,#191611);-webkit-box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);cursor:-webkit-grab;cursor:grab}.goldplay__volume-bar--rod-hover:before,.goldplay__volume-bar--rod:hover:before{background:#f60;border:1px solid #f60;-webkit-box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);-webkit-transform:scale(1);transform:scale(1);-webkit-transition:-webkit-transform .15s ease-in-out;transition:-webkit-transform .15s ease-in-out;transition:transform .15s ease-in-out;transition:transform .15s ease-in-out,-webkit-transform .15s ease-in-out}.goldplay__control--fullpage{margin:0 0 0 5px}.goldplay__control--fullscreen{margin:0 12px 0 10px}.goldplay__alter-box{z-index:999;padding:20px;border-radius:10px;color:#fff;position:absolute;word-break:break-word;overflow:auto;-webkit-box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);box-shadow:0 0 6px 2px hsla(0,10%,100%,.5);background:rgba(0,0,0,.6);min-width:50px;min-height:20px;max-width:400px;max-height:300px;opacity:0;-webkit-transition:opacity .3s;transition:opacity .3s}.goldplay__alter--close{margin:5px;display:block;position:absolute;right:0;top:0;cursor:pointer}.goldplay__alter--warn{float:left;margin:-5px 10px 5px 0}.goldplay__rate-bar,.goldplay__speed-bar{display:inline-block;color:#ccc;vertical-align:middle;margin:-14px 10px 0 0}.goldplay__rate-bar--box,.goldplay__speed-bar--box{cursor:default}.goldplay__speed-bar--box ul{margin:6px 0;padding:0;text-align:right}.goldplay__speed-bar--box ul li{height:2em;line-height:2em;padding:0 15px}.goldplay__rate-bar--box ul li:hover,.goldplay__speed-bar--box ul li:hover{background:rgba(0,0,0,.4)}.goldplay__rate-bar--box ul{margin:6px 0;padding:0;text-align:right}.goldplay__rate-bar--box ul li{height:2em;line-height:2em;padding:0 15px}',""])},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var i=(o=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),a=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[r].concat(a).concat([i]).join("\n")}var o;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r})).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];null!=a&&(n[a]=!0)}for(i=0;i<t.length;i++){var o=t[i];null!=o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),e.push(o))}},e}},function(t,e,r){var n,i,a={},o=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),s=function(t,e){return e?e.querySelector(t):document.querySelector(t)},u=function(t){var e={};return function(t,r){if("function"==typeof t)return t();if(void 0===e[t]){var n=s.call(this,t,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),l=null,c=0,h=[],f=r(114);function d(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=a[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(b(n.parts[o],e))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(b(n.parts[o],e));a[n.id]={id:n.id,refs:1,parts:s}}}}function p(t,e){for(var r=[],n={},i=0;i<t.length;i++){var a=t[i],o=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):r.push(n[o]={id:o,parts:[s]})}return r}function y(t,e){var r=u(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=h[h.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),h.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=u(t.insertAt.before,r);r.insertBefore(e,i)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=h.indexOf(t);e>=0&&h.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return r.nc}();n&&(t.attrs.nonce=n)}return m(e,t.attrs),y(t,e),e}function m(t,e){Object.keys(e).forEach((function(r){t.setAttribute(r,e[r])}))}function b(t,e){var r,n,i,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var o=c++;r=l||(l=v(e)),n=w.bind(null,r,o,!1),i=w.bind(null,r,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),y(t,e),e}(e),n=P.bind(null,r,e),i=function(){g(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(e),n=x.bind(null,r),i=function(){g(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=p(t,e);return d(r,e),function(t){for(var n=[],i=0;i<r.length;i++){var o=r[i];(s=a[o.id]).refs--,n.push(s)}t&&d(p(t,e),e);for(i=0;i<n.length;i++){var s;if(0===(s=n[i]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete a[s.id]}}}};var k,_=(k=[],function(t,e){return k[t]=e,k.filter(Boolean).join("\n")});function w(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=_(e,i);else{var a=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function x(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function P(t,e,r){var n=r.css,i=r.sourceMap,a=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||a)&&(n=f(n)),i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var i,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.r(e);var n,i=r(3),a=r.n(i),o=r(4),s=r.n(o),u=r(9),l=function(){function t(e){a()(this,t),this.decode=e,this.result=[]}return s()(t,[{key:"openDecode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,r=Module.addFunction((function(t,r,n,i,a,o,s,u,l){var c=HEAPU8.subarray(t,t+i*u),h=HEAPU8.subarray(r,r+a*u/2),f=HEAPU8.subarray(n,n+o*u/2),d={stride_y:i,stride_u:a,stride_v:o,width:s,height:u,buf_y:new Uint8Array(c),buf_u:new Uint8Array(h),buf_v:new Uint8Array(f),pts:l};e.result.push(d)}));Module._openDecoder(t,r,1)}},{key:"decodeData",value:function(t,e){var r=t.length,n=Module._malloc(r);Module.HEAPU8.set(t,n),Module._decodeData(n,r,e),Module._free(n)}},{key:"flush",value:function(){for(Module._flushDecoder();this.checkData();)this.decode.getDecodeYUV()}},{key:"closeDecode",value:function(){Module._closeDecoder()}},{key:"getYUV",value:function(){var t=null;return this.result.length>0&&(t=this.result.shift()),t}},{key:"checkData",value:function(){return this.result.length>0}}]),t}(),c=function(){function t(e){a()(this,t),this.decode=e}return s()(t,[{key:"openDecode",value:function(){return _web_decoder_open()}},{key:"closeDecode",value:function(t){_web_decoder_close(t)}},{key:"decodeData",value:function(t,e,r){var n=t.length||0;Module.ccall("web_decoder_decode_frame","number",["number","array","number","number"],[r,t,n,e])}},{key:"flush",value:function(t){var e=this.decode;if(_web_decoder_decode_frame)for(;;){if(_web_decoder_decode_frame(t,null,0,0)<0||!_web_got_frame(t))break;e.getDecodeYUV(t)}}},{key:"getYUV",value:function(t){var e=_web_get_stride_y(t),r=_web_get_stride_u(t),n=_web_get_stride_v(t),i=_web_get_width(t),a=_web_get_height(t),o=_web_get_frame_y(t),s=_web_get_frame_u(t),l=_web_get_frame_v(t),c=parseInt(_web_got_frame_pts(t)*u.a*1e3),h=HEAPU8.subarray(o,o+e*a),f=HEAPU8.subarray(s,s+r*a/2),d=HEAPU8.subarray(l,l+n*a/2);return{stride_y:e,stride_u:r,stride_v:n,width:i,height:a,buf_y:new Uint8Array(h),buf_u:new Uint8Array(f),buf_v:new Uint8Array(d),pts:c}}},{key:"checkData",value:function(t){return _web_got_frame(t)}}]),t}(),h=function(){function t(){a()(this,t),this.p=null,this.ptsList=[],this.ptsOffset=0,this.fps=0,this.lastDuration=0,this.previousPTS=0,this.status=!1,this.yuvArray=[],this.decodeTool=null}return s()(t,[{key:"loadWASM",value:function(t){var e=t.data.libPath;this.codec=t.data.codec,self.Module={locateFile:function(t){return e+t}},self.importScripts(e+"libffmpeg.js"),self.Module.onRuntimeInitialized=function(){Module._web_decoder_open?self.decode.decodeTool=new c(self.decode,this.event):self.decode.decodeTool=new l(self.decode,this.event),self.decode.openDecode(),self.decode.onWasmLoaded()}}},{key:"openDecode",value:function(){try{this.status||(this.p=this.decodeTool.openDecode(this.codec),this.status=!0)}catch(t){console.error(t)}}},{key:"closeDecode",value:function(){this.status&&(this.decodeTool.closeDecode(this.p),this.status=!1)}},{key:"push",value:function(t){var e=this;t.forEach((function(t){var r=t.PTS,n=t.data_byte,i=t.partEnd,a=t.lastTS,o=e.ptsList;e.insertSort(o,parseInt(r*u.a*1e3)),e.decodeTool.decodeData(n,r,e.p),e.decodeTool.checkData(e.p)&&e.getDecodeYUV(e.p,i,a)}))}},{key:"getDecodeYUV",value:function(t,e,r){if(!this.reseting){var n=0;this.fps||(this.fps=this.getFPS());var i=this.decodeTool.getYUV(t),a=this.ptsList.shift();if(i.pts=a,this.previousPTS&&a?(n=parseInt(a-this.previousPTS),this.lastDuration=n):n=this.lastDuration,i.duration=n,i.fps=this.fps,a)this.previousPTS=a,this.yuvArray.push(i),this.yuvArray.length>10&&(self.postMessage({type:"decoded",data:this.yuvArray,no:this.no}),this.yuvArray=[]);e&&(this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray,no:this.no}),this.yuvArray=[]),self.postMessage({type:"partEnd",data:r}))}}},{key:"reset",value:function(){this.reseting=!0,this.ptsList=[],this.ptsOffset=0,this.previousPTS=0,this.fps=0,this.yuvArray=[],this.closeDecode(),this.openDecode(),self.postMessage({type:"resetEnd",data:Date.now()}),this.reseting=!1}},{key:"flush",value:function(){this.decodeTool.flush(this.p),this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]),this.closeDecode(),self.postMessage({type:"flushEnd",data:this.previousPTS})}},{key:"getFPS",value:function(){var t=this.ptsList;return t.length>=2?Math.round(1e3/(t[1]-t[0])):null}},{key:"onWasmLoaded",value:function(){self.postMessage({type:"dataProcessorReady"})}},{key:"insertSort",value:function(t,e){var r=t.length;if(0!==r){for(var n=0;n<r;n++)if(e<t[n]){for(var i=r;i>n;)t[i]=t[i-1],i--;return void(t[n]=e)}t.push(e)}else t.push(e)}}]),t}(),f=r(0),d=r.n(f);!function(t){t.ERROR="ERROR",t.INFO="INFO",t.DATA="DATA",t.DEMUX_DATA="DEMUX_DATA",t.DONE="DONE"}(n||(n={}));var p=Object.create||function(t){var e=function(){};return e.prototype=t,new e},y=Object.keys||function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e);return e},g=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};let v,m=10;class b{constructor(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=p(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}static listenerCount(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):P.call(t,e)}emit(t,...e){var r,n,i,a,o,s,u="error"===t;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(u){if(arguments.length>1&&(r=arguments[1]),r instanceof Error)throw r;var l=new Error('Unhandled "error" event. ('+r+")");throw l.context=r,l}if(!(n=s[t]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(t,e,r){if(e)t.call(r);else for(var n=t.length,i=E(t,n),a=0;a<n;++a)try{i[a].call(r)}catch(t){console.error(t)}}(n,c,this);break;case 2:!function(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,a=E(t,i),o=0;o<i;++o)try{a[o].call(r,n)}catch(t){console.error(t)}}(n,c,this,arguments[1]);break;case 3:!function(t,e,r,n,i){if(e)t.call(r,n,i);else for(var a=t.length,o=E(t,a),s=0;s<a;++s)try{o[s].call(r,n,i)}catch(t){console.error(t)}}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,r,n,i,a){if(e)t.call(r,n,i,a);else for(var o=t.length,s=E(t,o),u=0;u<o;++u)try{s[u].call(r,n,i,a)}catch(t){console.error(t)}}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),o=1;o<i;o++)a[o-1]=arguments[o];!function(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,a=E(t,i),o=0;o<i;++o)try{a[o].apply(r,n)}catch(t){console.error(t)}}(n,c,this,a)}return!0}on(t,e){return function(t,e,r){var n,i,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');(i=t._events)?(i.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),i=t._events),a=i[e]):(i=t._events=p(null),t._eventsCount=0);if(a){if("function"==typeof a?a=i[e]=[a,r]:a.push(r),!a.warned&&(n=void 0===(o=t)._maxListeners?b.defaultMaxListeners:o._maxListeners)&&n>0&&a.length>n){a.warned=!0;class r extends Error{}let n=new r("Possible Dispatcher memory leak detected. "+a.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');n.name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",n.name,n.message)}}else a=i[e]=r,++t._eventsCount;var o;return t}(this,t,e)}once(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,function(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=g.call(w,n);return i.listener=r,n.wrapFn=i,i}(this,t,e)),this}off(t,e){return _.call(this,t,e)}removeAllListeners(t){var e,r,n;if(!(r=this._events))return this;if(!r.off)return 0===arguments.length?(this._events=p(null),this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=p(null):delete r[t]),this;if(0===arguments.length){var i,a=y(r);for(n=0;n<a.length;++n)"off"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("off"),this._events=p(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.off(t,e);else if(e)for(n=e.length-1;n>=0;n--)this.off(t,e[n]);return this}listeners(t){return x(this,t,!0)}rawListeners(t){return x(this,t,!1)}listenerCount(){return b.listenerCount.apply(this,arguments)}}try{var k={};Object.defineProperty&&Object.defineProperty(k,"x",{value:0}),v=0===k.x}catch(t){v=!1}function _(t,e){var r,n,i,a,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=p(null):(delete n[t],n.off&&this.emit("off",t,r.listener||e));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===e||r[a].listener===e){o=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),n.off&&this.emit("off",t,o||e)}return this}function w(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function x(t,e,r){var n=t._events;if(!n)return[];var i=n[e];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):E(i,i.length):[]}function P(t){var e=this._events;if(e){var r=e[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function E(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}v?Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');m=t}}):b.defaultMaxListeners=m;class T extends b{}var B=Object.prototype.toString;function S(t){return!!t&&"object"==typeof t}function R(t){return"number"==typeof t&&!isNaN(t)}function L(t){return S(t)&&"[object arraybuffer]"===B.call(t).toLowerCase()}class D{constructor(){this.list_=[]}get byteLength(){if(!R(this.byteLength_)){let t=0;for(let e,r=0;r<this.list_.length;r++)e=this.list_[r],t+=e.byteLength;this.byteLength_=t}return this.byteLength_}get bytes(){const{bufferList:t}=this;let e=null;return t.length>0&&(e=0===t.length?t[0]:this.toNewBytes()),e}get empty(){return 0===this.list_.length}get bufferList(){return this.list_}clear(){let t=this.list_.length;t>0&&this.list_.splice(0,t),this.byteLength_=null}toNewBytes(){let t=null,e=0;for(;null===t;)try{e++,t=new Uint8Array(this.byteLength)}catch(t){if(e>50)throw t}for(let e=0,r=0;e<this.list_.length;e++){let n=this.list_[e];t.set(n,r),r+=n.byteLength}return t}append(t){t instanceof D?this.list_=this.list_.concat(t.bufferList):this.list_.push(t),this.byteLength_=null}cut(t,e=!0){let r=null;if(t>0&&!this.empty){let n=this.list_,i=0,a=0;for(;n.length>0;){let o=n.shift();if(0!==a){let a=t-i;if(o.byteLength>=a){e&&r.set(o.subarray(0,a),i),o=o.subarray(a),o.byteLength>0&&n.unshift(o);break}e&&r.set(o,i),i+=o.byteLength;break}if(o.byteLength>=t){e&&(r=o.subarray(0,t)),o.byteLength>t&&(o=o.subarray(t),n.unshift(o));break}if(e){try{r=new Uint8Array(t)}catch(e){throw`alloc_memory_error@ cache buffer: ${t} ${e.message}`}r.set(o,0)}i+=o.byteLength,a++}this.byteLength_=null}return r}}class C{constructor(){this.map_={}}push(t,e){Object.prototype.hasOwnProperty.call(this.map_,t)?this.map_[t].push(e):this.map_[t]=[e]}get(t){let e=this.map_[t];return e?e.slice():null}getAll(){let t=[];for(let e in this.map_)t.push.apply(t,this.map_[e]);return t}remove(t,e){let r=this.map_[t];if(r)for(let t=0;t<r.length;++t)r[t]==e&&(r.splice(t,1),--t)}clear(){this.map_={}}forEach(t){for(let e in this.map_)t(e,this.map_[e])}}class A{constructor(t,e,r){this.target=t,this.type=e,this.listener=r,this.target.addEventListener?this.target.addEventListener(e,r,!1):this.target.on&&this.target.on(e,r,!1)}off(){this.target.removeEventListener?this.target.removeEventListener(this.type,this.listener,!1):this.target.off&&this.target.off(this.type,this.listener,!1),this.target=null,this.listener=null}}class I{constructor(){this.bindingMap_=new C}destroy(){this.removeAll(),this.bindingMap_=null}on(t,e,r){if(!this.bindingMap_)return;let n=new A(t,e,r);return this.bindingMap_.push(e,n),this}once(t,e,r){this.on(t,e,function(n){this.off(t,e),r(n)}.bind(this))}off(t,e){if(!this.bindingMap_)return;let r=this.bindingMap_.get(e)||[];for(let n=0;n<r.length;++n){let i=r[n];i.target==t&&(i.off(),this.bindingMap_.remove(e,i))}}removeAll(){if(!this.bindingMap_)return;let t=this.bindingMap_.getAll();for(let e=0;e<t.length;++e)t[e].off();this.bindingMap_.clear()}}let O;O="undefined"==typeof window?self:window;let U=O.console;const M="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof importScripts;let N=new class extends b{constructor(){super(),this._enable=!1}get enable(){return this._enable}set enable(t){this._enable=t,this.MSG_NAME="__log__"}log(...t){M?N.emit(this.MSG_NAME,"log",[...t].join("")):this._enable&&U.log.call(U,">>>",...t)}debug(...t){M?N.emit(this.MSG_NAME,"debug",[...t].join("")):this._enable&&U.debug&&U.debug.call(U,">>>",...t)}assert(...t){if(this._enable&&U.assert){let e=t[0],r=Array.prototype.slice.call(t,1);r.unshift(">>>"),U.assert.call(U,e,...r)}}warn(...t){M?N.emit(this.MSG_NAME,"warn",[...t].join("")):this._enable&&U.warn.call(U,">>>",...t)}error(...t){M?N.emit(this.MSG_NAME,"error",[...t].join("")):this._enable&&U.error.call(U,">>>",...t)}};class H extends b{constructor(){super()}pipe(t){return this.on("reset",(function(){t.reset()})),this.on("data",(function(e){t.push(e)})),this.on("done",(function(e){t.flush(e)})),t}unpipe(){return this.removeAllListeners("reset"),this.removeAllListeners("data"),this.removeAllListeners("done"),this}push(t,e){this.emit("data",t)}flush(t){this.emit("done",t)}reset(){this.emit("reset")}}class F extends H{constructor(t={}){super(),t.debug&&(N.enable=!0),this.ctx_=new T,this.options_=t,this.cache_buffer_=new D}listenEndStream_(){this.eventManager_=new I,this.eventManager_.on(this.endStream,"data",t=>{this.emit(n.DEMUX_DATA,t)}).on(this.endStream,"done",t=>{this.emit(n.DONE,t)}).on(this.ctx_,"error",t=>{this.emit(n.ERROR,t)})}constraintPushData_(t){let e=null;return L(t)||S(r=t)&&"[object uint8array]"===B.call(r).toLowerCase()?(e=L(t)?new Uint8Array(t):t,e):(N.error("Data pushed is not an ArrayBuffer or Uint8Array: "+t),e);var r}reset(){}destroy(){this.unpipe(),this.endStream.unpipe(),this.eventManager_.removeAll()}}var j;!function(t){t[t.WORKER_EXCEPTION=0]="WORKER_EXCEPTION",t[t.WORKER_MSG_EXCEPTION=1]="WORKER_MSG_EXCEPTION",t[t.TS_SYNC_BYTE=2]="TS_SYNC_BYTE",t[t.FLV_HEAD_SIGNATURE=3]="FLV_HEAD_SIGNATURE",t[t.FLV_NOT_EXPECTED_ADJACENT_DATA=4]="FLV_NOT_EXPECTED_ADJACENT_DATA"}(j||(j={}));var $=j;function W(t){let e=0;return ArrayBuffer.isView(t)&&(e=t.byteOffset,t=t.buffer),new DataView(t,e)}class V{constructor(){}readUint8(t,e){return W(t).getUint8(e)}readUint16(t,e,r=!1){return W(t).getUint16(e,r)}readUint32(t,e,r=!1){return W(t).getUint32(e,r)}}class z extends V{constructor(t){super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.transport_stream_id=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=t[5]&&1,this.section_number=t[6],this.last_section_number=t[7],this.network_PID=0;var e,r=0,n=this.section_length-4-5;for(this.pmtTable=[];r<n;r+=4)0==(e=this.readUint16(t,8+r))?(this.network_PID=(31&t[10+r])<<8|t[11+r],N.log("packet->network_PID %0x /n/n",this.network_PID)):this.pmtTable.push({programNum:e,program_map_PID:(31&t[10+r])<<8|t[11+r]});var i=this.section_length+3;this.CRC_32=(255&t[i-4])<<24|(255&t[i-3])<<16|(255&t[i-2])<<8|255&t[i-1]}}class Y extends V{constructor(t){if(super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.program_number=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=t[5]&&1,this.section_number=t[6],this.last_section_number=t[7],this.PCR_PID=(31&t[8])<<8|t[9],this.program_info_length=(15&t[10])<<8|t[11],this.program_info_length<0)return;if(this.program_info_length>2){let e=0;for(;e<this.program_info_length;){e+=t[13+e]}}var e=12+this.program_info_length,r=this.section_length-this.program_info_length-9-4,n=e+r;if(e>=n)return void N.warn(`es_section_pos < es_section_end ${e}, ${n}`);this.pes_table=[];let i=0;for(;i<r;){let r=t[e+i],n=8191&this.readUint16(t,e+i+1),a=4095&this.readUint16(t,e+i+3);if(this.pes_table.push({streamType:r,PID:n}),a>2){let r=0,n=e+i+5;for(;r<a;){r+=t[n+r]}}i+=a+5}var a=this.section_length+3;this.CRC_32=(255&t[a-4])<<24|(255&t[a-3])<<16|(255&t[a-2])<<8|255&t[a-1]}parse(){}}class X extends V{constructor(t){super(),this.table_id=t[0],this.section_syntax_indicator=t[1]>>7,this.section_length=(15&t[1])<<8|t[2],this.transport_stream_id=this.readUint16(t,3),this.version_number=t[5]>>1&31,this.current_next_indicator=1&t[5],this.section_number=t[6],this.last_section_number=t[7],this.original_network_id=this.readUint16(t,8);let e=this.section_length-8-4;this.service_table=[];let r=0;for(;r<e;){let e=0,n={service_id:this.readUint16(t,11),EIT_schedule_flag:2&t[13],EIT_present_following_flag:1&t[13],running_status:t[14]>>5,free_CA_mode:t[14]>>4&1,descriptors_loop_length:(15&t[14])<<8|t[15],provider_name:"",name:""};for(;e<n.descriptors_loop_length;){let r=16+e,i=t[r],a=t[r+1];switch(i){case 72:{let e=[],i=t[r+3],a=0,o=0,s=r+4;for(a=0;a<i;a++)e.push(String.fromCharCode(t[s])),s+=1;n.provider_name=e.join("");let u=[],l=t[s];for(s+=1,o=0;o<l;o++)u.push(String.fromCharCode(t[s])),s+=1;n.name=u.join("")}break;default:N.warn("sdt section unhandled descriptor_tag "+i)}e+=2+a}this.service_table.push(n),r+=5+n.descriptors_loop_length}}}class G{}class q{constructor(t){this.context=t,this.metadata=new G,this.pat_table=[],this.pes_streams=[]}get currentProgramPID(){let t=[];for(let e=0;e<this.pat_table.length;e++)t.push(this.pat_table[e].pid);return t.length>0?t[0]:-1}reset(){this.metadata=new G,this.pat_table.splice(0,this.pat_table.length),this.pes_streams.splice(0,this.pes_streams.length)}parse(t){0===t.PID?this._parsePat(t):1===t.PID||2===t.PID||3<=t.PID&&t.PID<=15||(17===t.PID?this._parseSdt(t):t.PID===this.currentProgramPID&&this._parsePmt(t))}findTrack(t){let e=null,r=this.pes_streams;for(let n=0;n<r.length;n++)if(r[n].id===t){e=r[n];break}return e}_parsePat(t){let e;if(t.payload_unit_start_indicator){let r=t.payload[0];e=t.payload.subarray(r+1)}else e=t.payload;let r=new z(e);for(var n=0;n<r.pmtTable.length;n++)this._add_pid_to_pmt(r.pmtTable[n].programNum,r.pmtTable[n].program_map_PID);return r}_add_pid_to_pmt(t,e){let r=this.pat_table;(function(t){for(let e,n=0;n<r.length;n++)if(e=r[n],e.id===t)return{idx:n,item:e};return null})(t)||r.push({id:t,pid:e})}_parsePmt(t){let e;if(t.payload_unit_start_indicator){let r=t.payload[0];e=t.payload.subarray(r+1)}else e=t.payload;let r=new Y(e);for(var n=0;n<r.pes_table.length;n++)this._add_pes_stream(r.pes_table[n],r);return r}_add_pes_stream(t,e){let r=this.pes_streams;(function(t){for(let e,n=0;n<r.length;n++)if(e=r[n],e.id===t)return{idx:n,item:e};return null})(t.PID)||r.push({id:t.PID,stream_type:t.streamType,pcr_pid:e.PCR_PID,duration:0,sps:[],pps:[],pixelRatio:[1,1],timescale:9e4,width:0,height:0})}_parseSdt(t){let e;if(t.payload_unit_start_indicator){let r=t.payload[0];e=t.payload.subarray(r+1)}else e=t.payload;let r=new X(e);return r.service_table.length>0&&(this.metadata.service_name=r.service_table[0].name,this.metadata.service_provider=r.service_table[0].provider_name),r}}class Q extends H{constructor(t,e){super(),this.context=t,this.PSI=e,this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}push(t){let e=t;for(let t,r=0;r<e.length;r++)switch(t=e[r],t.type){case"video":this._complexVideo(t);break;case"audio":this._complexAudio(t);break;case"caption":this._complexCaption(t)}}flush(){this.emit("done"),this._clearStream()}reset(){this._clearStream()}_clearStream(){this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}_complexVideo(t){let e=this.PSI.findTrack(t.trackId);e&&(e.type="video",e.gops=t,e.firstDTS=t[0][0].dts,e.firstPTS=t[0][0].pts,e.duration=Number.POSITIVE_INFINITY,this.videoTrack=e,this.emit("data",{videoTrack:this.videoTrack}))}_complexAudio(t){let e=this.PSI.findTrack(t.trackId);e&&(e.type="audio",e.frames=t,e.firstPTS=e.firstDTS=t[0].dts,e.duration=Number.POSITIVE_INFINITY,this.audioTrack=e,this.emit("data",{audioTrack:this.audioTrack}))}_complexCaption(){}}const K={mac:!1,iphone:!1,android:!1},J={version:!1,CHROME:!1,SAFARI:!1,FIREFOX:!1,IE11:!1,IE:!1,EDGE:!1,WECHAT:!1};let Z=navigator.userAgent.toLowerCase();var tt=/(edge)\/([\w.]+)/.exec(Z)||/(opr)[/]([\w.]+)/.exec(Z)||/(chrome)[ /]([\w.]+)/.exec(Z)||/(firefox)[ /]([\w.]+)/.exec(Z)||/(iemobile)[/]([\w.]+)/.exec(Z)||/(version)(applewebkit)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(Z)||/(webkit)[ /]([\w.]+).*(version)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(Z)||/(webkit)[ /]([\w.]+)/.exec(Z)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(Z)||/(msie) ([\w.]+)/.exec(Z)||Z.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(Z)||Z.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(Z)||[],et=/(ipad)/.exec(Z)||/(ipod)/.exec(Z)||/(windows phone)/.exec(Z)||/(iphone)/.exec(Z)||/(kindle)/.exec(Z)||/(silk)/.exec(Z)||/(android)/.exec(Z)||/(win)/.exec(Z)||/(mac)/.exec(Z)||/(linux)/.exec(Z)||/(cros)/.exec(Z)||/(playbook)/.exec(Z)||/(bb)/.exec(Z)||/(blackberry)/.exec(Z)||[],rt={version:void 0},nt={browser:tt[5]||tt[3]||tt[1]||"",version:tt[2]||tt[4]||"0",versionNumber:tt[4]||tt[2]||"0",platform:et[0]||""};if(nt.browser){rt[nt.browser]=!0;let t=nt.versionNumber.split(".");rt.version={major:parseInt(nt.versionNumber,10),string:nt.version},t.length>1&&(rt.version.minor=parseInt(t[1],10)),t.length>2&&(rt.version.build=parseInt(t[2],10))}J.version=rt.version,J.CHROME=!!rt.chrome,J.SAFARI=!!rt.safari&&!J.CHROME,J.FIREFOX=!!rt.firefox,J.IE11=/rv:11/.test(Z),J.IE=!!rt.msie||J.IE11,J.EDGE=!!rt.edge,J.WECHAT=/(wechat)|(micromessenger)/.test(Z),K.mac=!!nt.platform.mac,K.iphone=!!nt.platform.iphone,K.android=!!nt.platform.android;var it=J,at=K;const ot=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];const st=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];class ut extends b{constructor(){super()}push(t){let e,r,n,i,a,{pts:o,dts:s,payload:u}=t,l=u,c=0,h=0;for(;c+5<l.length;){if(255!==l[c]||240!=(246&l[c+1])){c++;continue}if(r=2*(1&~l[c+1]),e=(3&l[c+3])<<11|l[c+4]<<3|(224&l[c+5])>>5,i=1024*(1+(3&l[c+6])),a=9e4*i/st[(60&l[c+2])>>>2],n=c+e,l.byteLength<n)return;let t={pts:o+h*a,dts:s+h*a,sampleCount:i,audioObjectType:1+(l[c+2]>>>6&3),channelCount:(1&l[c+2])<<2|(192&l[c+3])>>>6,sampleRate:st[(60&l[c+2])>>>2],samplingFrequencyIndex:(60&l[c+2])>>>2,sampleSize:16,data:l.subarray(c+7+r,n)};if(this.emit("frame",t),l.byteLength===n)return l=void 0,void this.emit("done");h++,l=l.subarray(n)}}}class lt extends H{constructor(t){super(),this.PSI=t,this.trackId=null,this.codec=new ut,this.codec.on("frame",t=>{this.frames.push(t),this.frames.byteLength+=t.data.byteLength,this.frames.trackId=this.trackId}),this._newFrames()}push(t){15===t.stream_type&&(this.trackId=t.pid,this.codec.push({dts:t.pes.DTS,pts:t.pes.PTS,payload:t.pes.data_byte}))}flush(){if(this.frames.length>0){let t=this.frames.length,e=this.frames[0],r=this.frames[t-1],n=r.sampleRate*r.sampleCount/9e4;this.frames.firstDTS=e.dts,this.frames.firstPTS=e.pts,this.frames.duration=1===t?n:n+(r.pts-e.pts),this._updateTrackMeta(e),this.emit("data",this.frames),this.reset(),this.emit("done")}}reset(){this.trackId=null,this._newFrames()}_newFrames(){this.frames=[],this.frames.type="audio",this.frames.byteLength=0,this.frames.duration=0,this.frames.firstDTS=0,this.frames.firstPTS=0}_updateTrackMeta(t){let e=this.PSI.findTrack(this.trackId),r=((t,e,r)=>{let n,i,a=t;if(!(e>ot.length-1))return it.FIREFOX?e>=6?(t=5,i=new Array(4),n=e-3):(t=2,i=new Array(2),n=e):at.android?(t=2,i=new Array(2),n=e):(t=5,i=new Array(4),e>=6?n=e-3:(1===r&&(t=2,i=new Array(2)),n=e)),i[0]=t<<3,i[0]|=(14&e)>>1,i[1]|=(1&e)<<7,i[1]|=r<<3,5===t&&(i[1]|=(14&n)>>1,i[2]=(1&n)<<7,i[2]|=8,i[3]=0),{config:i,sampleRate:ot[e],channelCount:r,codec:"mp4a.40."+t,realCodec:"mp4a.40."+a};N.error("invalid sampling index:"+e)})(t.audioObjectType,t.samplingFrequencyIndex,t.channelCount);e.config=r.config,e.sampleRate=r.sampleRate,e.inputTimeScale=e.inputTimeScale||e.timescale,e.timescale=r.sampleRate,e.channelCount=r.channelCount,e.codec=r.codec,e.realCodec=r.realCodec,e.isAAC=!0}}function ct(t,e=0,r=1){let n=0,i=0,a=0,o="",s=0;for(let a=e;a<e+r;a++)n=Math.floor(a/8),i=7-a%8,s=t[n]>>i&1,o+=s;return a=parseInt(o,2),a}function ht(t,e=0){let r=[],n=8*t.byteLength,i=!1,a=0,o=0,s=0,u="";for(let u=e;u<n;u++)if(a=Math.floor(u/8),o=7-u%8,s=t[a]>>o&1,!i){if(0!==s){i=!0,e=u;break}r.push(0)}let l=r.length+1;for(let r=e;r<e+l;r++)a=Math.floor(r/8),o=7-r%8,s=t[a]>>o&1,u+=s;return{bitLength:r.length+l,value:parseInt(u,2)-1}}var ft={readUEV:ht,readSEV:function(t,e=0){let r=ht(t,e),n=r.value,i=Math.pow(-1,n+1)*Math.ceil(n/2);return{bitLength:r.bitLength,value:i}},readBit:ct,readByte:function(t,e=0){return ct(t,e,8)}};let dt=0;function pt(t,e){let r,n=8,i=8;for(var a=0;a<e;a++)0!=i&&(r=ft.readUEV(t,dt),dt+=r.bitLength,i=(n+r.value+256)%256),n=t[a]}class yt extends V{constructor(t){switch(super(),this.forbidden_zero_bit=t[0]>>7,this.ref_idc=t[0]>>5&3,this.unit_type=31&t[0],this.data=function(t){let e,r=t.byteLength,n=[],i=1,a=new Uint8Array(0);for(;i<r-2;)0===t[i]&&0===t[i+1]&&3===t[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return t;e=r-n.length;try{a=new Uint8Array(e)}catch(t){throw"epsb alloc mem error "+e}let o=0;for(i=0;i<e;o++,i++)o===n[0]&&(o++,n.shift()),a[i]=t[o];return a}(t.subarray(1)),this.rawData=t,this.unit_type){case 1:break;case 2:case 3:case 4:case 5:break;case 7:this.sps=function(t){dt=0;let e,r,n,i,a,o,s,u=t[0],l=t[1],c=t[2],h=t.subarray(3),f=0,d=[1,1],p=1,y=0,g=!0,v=ft.readUEV(h,dt);if(dt+=v.bitLength,100==u||110==u||122==u||244==u||44==u||83==u||86==u||118==u||128==u){let t=ft.readUEV(h,dt);dt+=t.bitLength,3==t.value&&(dt+=1);let e=ft.readUEV(h,dt);dt+=e.bitLength;let r=ft.readUEV(h,dt);if(dt+=r.bitLength,dt+=1,f=ft.readBit(h,dt),dt+=1,f)for(let e=0;e<(3!=t.value?8:12);e++){let t=ft.readBit(h,dt);dt+=1,t&&pt(h,e<6?16:64)}}let m=ft.readUEV(h,dt);dt+=m.bitLength;let b=ft.readUEV(h,dt),k=b.value;if(dt+=b.bitLength,0===k)e=ft.readUEV(h,dt),dt+=e.bitLength;else if(1===k){dt+=1,r=ft.readSEV(h,dt),dt+=r.bitLength,n=ft.readSEV(h,dt),dt+=n.bitLength,i=ft.readUEV(h,dt),dt+=i.bitLength;for(let t,e=0;e<i.value;e++)t=ft.readSEV(h,dt),dt+=t.bitLength}let _=ft.readUEV(h,dt);dt+=_.bitLength,dt+=1;let w=ft.readUEV(h,dt);dt+=w.bitLength;let x=ft.readUEV(h,dt);dt+=x.bitLength;let P=ft.readBit(h,dt);dt+=1,P||(dt+=1),dt+=1;let E=ft.readBit(h,dt);dt+=1;let T=0,B=0,S=0,R=0;if(E){let t=ft.readUEV(h,dt);dt+=t.bitLength,T=t.value;let e=ft.readUEV(h,dt);dt+=e.bitLength,B=e.value;let r=ft.readUEV(h,dt);dt+=r.bitLength,S=r.value;let n=ft.readUEV(h,dt);dt+=n.bitLength,R=n.value}let L=ft.readBit(h,dt);if(dt+=1,L){let t=ft.readBit(h,dt);if(dt+=1,t){const t=ft.readByte(h,dt);switch(dt+=8,t){case 1:d=[1,1];break;case 2:d=[12,11];break;case 3:d=[10,11];break;case 4:d=[16,11];break;case 5:d=[40,33];break;case 6:d=[24,11];break;case 7:d=[20,11];break;case 8:d=[32,11];break;case 9:d=[80,33];break;case 10:d=[18,11];break;case 11:d=[15,11];break;case 12:d=[64,33];break;case 13:d=[160,99];break;case 14:d=[4,3];break;case 15:d=[3,2];break;case 16:d=[2,1];break;case 255:{let t=ft.readByte(h,dt);dt+=8;let e=ft.readByte(h,dt);dt+=8;let r=ft.readByte(h,dt);dt+=8;let n=ft.readByte(h,dt);dt+=8,d=[t<<8|e,r<<8|n];break}}d&&(p=d[0]/d[1]),255===t&&(dt+=16,dt+=16)}let e=ft.readBit(h,dt);dt+=1,e&&(dt+=1);let r=ft.readBit(h,dt);if(dt+=1,r){a=ft.readBit(h,dt,3),dt+=3,dt+=1;let t=ft.readBit(h,dt);dt+=1,t&&(dt+=24)}let n=ft.readBit(h,dt);if(dt+=1,n){let t=ft.readUEV(h,dt);dt+=t.bitLength;let e=ft.readUEV(h,dt);dt+=e.bitLength}let i=ft.readBit(h,dt);dt+=1,i&&(o=ft.readBit(h,dt,32),dt+=32,s=ft.readBit(h,dt,32),dt+=32,g=!!ft.readBit(h,dt),dt+=1,y=s/(2*o))}return{payload:h,profile_idc:u,profile_compatibility:l,level_idc:c,sps_id:v.value,log2_max_frame_num_minus4:b.value,pic_order_cnt_type:k,log2_max_pic_order_cnt_lsb_minus4:e?e.value:0,width:Math.ceil((16*(w.value+1)-2*T-2*B)*p),height:(2-P)*(x.value+1)*16-2*S-2*R,pixelRatio:d,video_format:a,fps:y,fixedFPS:g}}(this.data);break;case 8:this.pps=function(t){let e,r,n=0,i=t,a=[],o=0;n+=ft.readUEV(i,n).bitLength,n+=ft.readUEV(i,n).bitLength,n+=1,n+=1;let s=ft.readUEV(i,n);if(n+=s.bitLength,s.value>0){let t=ft.readUEV(i,n);n+=t.bitLength;let u,l=0;switch(t.value){case 0:for(l=0;l<=t.value;l++)u=ft.readUEV(i,n),n+=u.bitLength;break;case 2:for(l=0;l<=t.value;l++)u=ft.readUEV(i,n),n+=u.bitLength,u=ft.readUEV(i,n),n+=u.bitLength;break;case 3:case 4:case 5:n+=1,e=ft.readUEV(i,n),n+=e.bitLength;break;case 6:{r=ft.readUEV(i,n),n+=r.bitLength;let t=Math.ceil(Math.log2(s.value+1));for(o=0;o<=r.value;o++)a.push(ft.readBit(i,n,t)),n+=t}}}return n+=ft.readUEV(i,n).bitLength,n+=ft.readUEV(i,n).bitLength,n+=1,n+=1,n+=ft.readSEV(i,n).bitLength,n+=ft.readSEV(i,n).bitLength,n+=ft.readSEV(i,n).bitLength,n+=1,n+=1,n+=1,{sliceGroupNum:s.value+1}}(this.data);break;case 6:this.sei=(this.data,{});break;case 9:this.primary_pic_type=this.data[0]>>5}}}class gt extends b{constructor(){super(),this.cachedBytes=null}push(t){let e,r=this,n=0,i=0,a=0,{pts:o,dts:s,payload:u,naluSizeLength:l}=t;if(this.cachedBytes){try{e=new Uint8Array(this.cachedBytes.byteLength+u.byteLength)}catch(t){throw`h264 alloc mem error ${this.cachedBytes.byteLength}/${u.byteLength}`}e.set(this.cachedBytes),e.set(u,this.cachedBytes.byteLength)}else e=u;if(l){let t=0,n=0,i=0;do{n=0;for(let r=0;r<l;r++)n|=e[t+r]<<8*(l-r-1);t+=l,i=t+n,i>e.length&&(i=e.length);let a=e.subarray(t,i),u=new yt(a);u.pts=o,u.dts=s,r.emit("nalu",u),t=i}while(t<e.length)}else{let t=e.byteLength-1,u=0;do{if(0!==e[t])break;u++,t--}while(t>0);u>=3&&(e=e.subarray(0,t+1));do{let t=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],l=e.length-n>=4?t:-1,c=0,h=n===e.length-1;if(l>>8==1?c=3:1===l&&(c=4),3===c||4===c||h){let t=i+a,l=h&&u>=3;if(n>i&&(!h||l)){let a=e.subarray(t,l?n+1:n),u=new yt(a);u.pts=o,u.dts=s,r.emit("nalu",u),i=n}h&&(u<3?(this.cachedBytes=e.subarray(i),this.cachedBytes.pts=o,this.cachedBytes.dts=s,this.cachedBytes.startCodeLength=a):this.cachedBytes=null),n===i&&(a=c),n+=c||1}else n++}while(n<e.length)}if(this.cachedBytes){let t=new yt(this.cachedBytes.subarray(this.cachedBytes.startCodeLength));t.pts=this.cachedBytes.pts,t.dts=this.cachedBytes.dts,this.emit("nalu",t),this.cachedBytes=null}this.emit("done")}reset(){this.cachedBytes=null}}class vt extends H{constructor(t){super(),this.PSI=t,this.trackId=null,this.currentFrame=[],this.codec=new gt,this._newGop(),this._newGops(),this.codec.on("nalu",t=>{if(7===t.unit_type){let e=this.PSI.findTrack(this.trackId),r=(t=>{let e="avc1.",r=[t.profile_idc,t.profile_compatibility,t.level_idc];for(let t=0;t<r.length;t++){let n=r[t].toString(16);n.length<2&&(n="0"+n),e+=n}return{codec:e}})(t.sps);e.codec=r.codec,e.width=t.sps.width,e.height=t.sps.height,e.profileIdc=t.sps.profile_idc,e.profileCompatibility=t.sps.profile_compatibility,e.levelIdc=t.sps.level_idc,e.pixelRatio=t.sps.pixelRatio,e.sps=[t.rawData]}else if(8===t.unit_type){this.PSI.findTrack(this.trackId).pps=[t.rawData]}this._grouping(t)})}push(t){const{stream_type:e,pes:r,pid:n}=t;if(27===e||36===e){this.trackId=n;let t={pts:r.PTS,dts:r.DTS,payload:r.data_byte};this.codec.push(t)}}flush(){this.currentFrame.length>0&&((!this.currentFrame.duration||this.currentFrame.duration<=0)&&(this.currentFrame.duration=this.prevFrame.duration||0),this._pushFrameIntoGop(),this.currentFrame=[]),this.gop.length>0&&this._pushGopIntoGroup()}reset(){this.codec.reset(),this.currentFrame=[],this._newGop(),this._newGops()}_grouping(t){9===t.unit_type?(this.currentFrame.length>0&&(this.currentFrame.duration=t.dts-this.currentFrame.dts,this.gop.length>0&&this.currentFrame.keyframe&&(this.gop.trackId=this.trackId,this._pushGopIntoGroup()),this.currentFrame.keyframe||this.gop.length>0?this._pushFrameIntoGop():N.warn("h264 codec drop frame")),this.prevFrame=this.currentFrame,this.currentFrame=[],this.currentFrame.keyframe=!1,this.currentFrame.byteLength=0,this.currentFrame.naluCount=0,this.currentFrame.pts=t.pts,this.currentFrame.dts=t.dts):(5===t.unit_type&&(this.currentFrame.keyframe=!0),this.currentFrame.byteLength+=t.rawData.byteLength,this.currentFrame.naluCount++,this.currentFrame.push(t)),this.currentFrame.duration=t.dts-this.currentFrame.dts}_newGop(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}_pushFrameIntoGop(){this.gop.push(this.currentFrame),this.gop.duration+=this.currentFrame.duration,this.gop.byteLength+=this.currentFrame.byteLength,this.gop.naluCount+=this.currentFrame.naluCount}_newGops(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this.gops.firstDTS=0}_pushGopIntoGroup(){let t=this.gop[0];this.gops.trackId=this.trackId,this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.firstDTS=t.dts,this.gops.firstPTS=t.pts,this.gops.push(this.gop),this.emit("data",this.gops),this._newGop(),this._newGops(),this.emit("done")}}class mt extends H{constructor(t,e,r={}){super(),this.context=t,this.PSI=e,this.options=r,this.tracks=[],this.adtsStream=new lt(e),this.avcStream=new vt(e),this.streams=[this.adtsStream,this.avcStream],r.decodeCodec&&(this.avcStream.on("data",t=>{let e=r.config.stubTime;if(R(e)){let r=(t.firstPTS+t.duration)/9e4;if(r<e)return void N.warn(`drop avc gop, start/end/stubTime(${t.firstPTS}/${r}/${e})`)}this.tracks.push(t),this.emit("data",this.tracks),this.tracks=[],this.adtsStream.flush()}),this.adtsStream.on("data",t=>{let e=r.config.stubTime;if(R(e)){let r=(t.firstPTS+t.duration)/9e4;if(r<e)return void N.warn(`drop adts, start/end/stubTime(${t.firstPTS}/${r}/${e})`)}this.tracks.push(t),this.emit("data",this.tracks),this.tracks=[]}))}push(t){const{options:e,adtsStream:r,avcStream:n}=this;let{stream_type:i}=t;if(e.decodeCodec)switch(i){case 27:case 36:n.push(t);break;case 15:r.push(t);break;default:N.warn("ts elementary encounter unknown stream type "+i)}else this.emit("data",t)}flush(){let{streams:t,tracks:e}=this;for(let e=0;e<this.streams.length;e++){t[e].flush()}e.length>0&&this.emit("data",e),this.emit("done"),e.splice(0,e.length)}reset(){this.tracks=[];for(let t=0;t<this.streams.length;t++){this.streams[t].reset()}this.emit("reset")}}class bt extends V{constructor(t){super(),this.start_code_prefix=this.readUint16(t,0)<<8|t[2],this.stream_id=t[3],this.packet_length=this.readUint16(t,4),this.data_alignment_indicator=4&t[6],this.copyright=2&t[6],this.PTS_DTS_flags=t[7]>>6,this.ESCR_flag=32&t[7],this.ES_rate_flag=16&t[7],this.trick_mode_flag=8&t[7],this.additional_copy_info_flag=4&t[7],this.CRC_flag=2&t[7],this.extension_flag=1&t[7],this.header_data_length=t[8],this.PTS=0,2==(2&this.PTS_DTS_flags)&&(this.PTS=this.calcTimestamp_(t,9)),this.DTS=this.PTS,1==(1&this.PTS_DTS_flags)&&(this.DTS=this.calcTimestamp_(t,14)),this.data_byte=t.subarray(9+this.header_data_length)}calcTimestamp_(t,e){return 536870912*(14&t[e])+(t[e+1]<<22)+(t[e+2]>>1<<15)+(t[e+3]<<7)+(t[e+4]>>1)}valid(){let t=this.start_code_prefix;return 0===t[0]&&0===t[1]&&1===t[2]}}class kt extends H{constructor(t,e){super(),this.context=t,this.PSI=e,this.PID=null,this.cache_buffer=new D}push(t){const e=this;t.PID>255&&t.PID<8191&&(-1==this.PSI.currentProgramPID?e._pushPacket(t):this.PSI.currentProgramPID!==t.PID&&(1===t.payload_unit_start_indicator&&e._assembleOnePES(),e._pushPacket(t)))}flush(){this._assembleOnePES(),this.emit("done")}reset(){this._clearCached(),this.emit("reset")}_clearCached(){this.PID=null,this.cache_buffer.clear()}_pushPacket(t){let e=this.cache_buffer.empty;e&&0===t.payload_unit_start_indicator||(e&&(this.PID=t.PID),this.cache_buffer.append(t.payload))}_assembleOnePES(){const t=this;if(!this.cache_buffer.empty){let e;try{e=this.cache_buffer.toNewBytes()}catch(t){throw"pes alloc mem err "+this.cache_buffer.byteLength}let r=new bt(e),n=this.PSI.findTrack(this.PID);if(n){let e={pid:n.id,stream_type:n.stream_type,pcr_pid:n.pcr_pid,pes:r};t.emit("data",e)}t._clearCached()}}}class _t extends V{constructor(t){if(super(),this.sync_byte=t[0],this.transport_error_indicator=t[1]>>7,this.payload_unit_start_indicator=t[1]>>6&1,this.transport_priority=t[1]>>>5&1,this.PID=8191&this.readUint16(t,1),this.tsc=t[3]>>6,this.afc=t[3]>>4&3,this.continuity_counter=15&t[3],this.has_payload=1&this.afc,this.has_adaptation=2&this.afc,this.has_payload)if(this.has_adaptation){let e=t[4];this.payload=t.subarray(5+e)}else this.payload=t.subarray(4)}valid(){return 71===this.sync_byte&&1===this.has_payload}}class wt extends F{constructor(t={}){super(t),this.psi_=new q(this.ctx_),this.pesStream_=new kt(this.ctx_,this.psi_),this.elementaryStream_=new mt(this.ctx_,this.psi_,t),this.complexStream_=new Q(this.ctx_,this.psi_),this.pipe(this.pesStream_),this.pesStream_.pipe(this.elementaryStream_),this.elementaryStream_.pipe(this.complexStream_),super.listenEndStream_()}get endStream(){let t=this.elementaryStream_;return this.options_.decodeCodec&&(t=this.complexStream_),t}push(t,e){const{done:r}=e,{options_:n,ctx_:i,cache_buffer_:a,psi_:o}=this;let s=super.constraintPushData_(t),u=a.byteLength,l=null;for(n.config=e,N.log(`hls demux received ${s.byteLength} bytes, cache ${u} bytes. ${r?"chunk done":""}`),a.append(s);a.byteLength>=188;){let t=a.cut(188);if(t){let e=new _t(t);if(!e.valid()){let r=`Encounter invalid ts packet, packet_length(${t.length}), cache_length(${this.cache_buffer_.byteLength}), has_payload(${e.has_payload}), data(${t})`;N.error(r),this.reset(),i.emit("error",$.TS_SYNC_BYTE,r,{startByte:l,endByte:l+t.byteLength});break}o.parse(e),this.emit("data",e),l+=t.byteLength}}a.empty&&r&&this.emit("done")}reset(){this.cache_buffer_.clear(),this.emit("reset")}}var xt,Pt;!function(t){t[t.HEAD=0]="HEAD",t[t.BODY=1]="BODY"}(xt||(xt={})),function(t){t[t.SCRIPT_DATA=18]="SCRIPT_DATA",t[t.VIDEO=9]="VIDEO",t[t.AUDIO=8]="AUDIO"}(Pt||(Pt={}));var Et,Tt,Bt,St;!function(t){t[t.AAC=10]="AAC"}(Et||(Et={})),function(t){t[t.MONO=0]="MONO",t[t.STEREO=1]="STEREO"}(Tt||(Tt={}));!function(t){t[t.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",t[t.AAC_RAW=1]="AAC_RAW"}(Bt||(Bt={}));!function(t){t[t.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",t[t.NALU=1]="NALU",t[t.SEQUENCE_END=2]="SEQUENCE_END"}(St||(St={}));const Rt=new gt,Lt=[];Rt.on("nalu",t=>{Lt.push(t)});var Dt;!function(t){t[t.AVC=7]="AVC"}(Dt||(Dt={}));var Ct=function(){function t(e){a()(this,t),d()(this,"previousPes",null),d()(this,"maxAudioPTS",0),d()(this,"maxVideoPTS",0),e?(this.init(),this.dataArray=[],this.videoArray=[],this.audioArray=[],this.decode=e):console.error("class TsDemux need pass decode parmas")}return s()(t,[{key:"init",value:function(){var t=this;try{this.demuxer=new wt({enableWorker:!1,debug:!1,onlyDemuxElementary:!0}),this.demuxer.on(n.DEMUX_DATA,(function(e){e instanceof Array?(t.dataArray.push(e),t.demuxed(t.dataArray),t.dataArray=[]):t.dataArray.push(e)})),this.demuxer.on(n.DONE,(function(e){var r={};t.demuxed(t.dataArray),t.dataArray=[],t.previousPes.partEnd=!0,t.previousPes.lastTS=t.isLast,t.isLast?(t.maxPTS=Math.min(t.maxAudioPTS,t.maxVideoPTS),r.audioEnd=!0,t.audioQueue(r),self.postMessage({type:"demuxedAAC",data:t.audioArray,no:t.no}),t.audioArray=[],self.postMessage({type:"maxPTS",data:{maxAudioPTS:t.maxAudioPTS,maxVideoPTS:t.maxVideoPTS}})):(self.postMessage({type:"demuxedAAC",data:t.audioArray,no:t.no}),t.audioArray=[]),t.decode.no=t.no,t.decode.push(t.videoArray),t.videoArray=[],t.previousPes=null}))}catch(t){console.error("init demuxer failed.")}}},{key:"push",value:function(t){this.demuxer.push(t,{done:!0})}},{key:"demuxed",value:function(t){var e=this;t.forEach((function(t){e.tsDemuxed(t)}))}},{key:"tsDemuxed",value:function(t){var e=t.stream_type,r=t.pes||{};switch(e){case 27:case 36:this.videoQueue(r);break;case 3:case 15:case 17:r.PTS=Math.round(r.PTS*u.a*1e3),this.maxAudioPTS=Math.max(r.PTS,this.maxAudioPTS),this.audioQueue(r)}}},{key:"audioQueue",value:function(t){this.audioArray.push(t)}},{key:"videoQueue",value:function(t){this.previousPes=t,this.maxVideoPTS=Math.max(this.maxVideoPTS,t.PTS),this.videoArray.push(t)}},{key:"destroy",value:function(){this.demuxer.destroy()}}]),t}();self.decode=new h,self.demuxer=new Ct(self.decode);e.default=function(t){t.onmessage=function(e){var r=e.data,n=r.type,i=r.data,a=r.no,o=r.isLast;switch(n){case"startDemux":t.demuxer.isLast=o,t.demuxer.no=a,t.demuxer.push(i);break;case"loadwasm":t.decode.loadWASM(e);break;case"flush":t.decode.flush()}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){t.exports=r(178)},function(t,e,r){t.exports=r(91).default}])}));